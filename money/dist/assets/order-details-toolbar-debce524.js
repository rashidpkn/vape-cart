import{bu as M,c5 as J,ae as e,bE as Q,bF as w,b2 as te,aq as i,aY as E,bs as N,cM as G,bB as P,a$ as W,b4 as D,aC as p,bt as se,aw as s,aV as oe,c6 as K,b6 as F,az as k,as as o,de as Y,D as T,aQ as ae,b_ as le,bw as _,aB as $,aE as ie,by as ce,aL as q,aN as de,am as xe,aO as he,cO as pe,cP as ue,ca as je,cx as me,cj as ge,bH as X,bI as ye,bJ as be,bK as we,df as fe,dg as Ce,cy as Se,c7 as Te,c8 as Pe,dh as L,c9 as ve,b3 as O,ac as V,aD as De,aP as H,aA as Ie,cd as ke}from"./index-375c29a3.js";import{C as Z}from"./confirm-dialog-10365595.js";import{g as Re,e as Oe}from"./utils-74d4caeb.js";import{u as Fe}from"./use-table-e3cb1f57.js";import"./custom-date-range-picker-a2122e30.js";import{T as Be}from"./TableContainer-06cda7ee.js";function ee({row:n,store:l=[],selected:u,onViewRow:a,onSelectRow:j,onDeleteRow:m}){var B;const{id:h,items:d,status:t,createdAt:x,customer:y,totalQuantity:C,subTotal:g,userId:ne}=n,b=M(),S=M(),v=J();console.log(l),console.log(d[0].userId);const A=e.jsxs(Q,{hover:!0,selected:u,children:[e.jsx(w,{padding:"checkbox",children:e.jsx(te,{checked:u,onClick:j})}),e.jsx(w,{children:e.jsxs(i,{onClick:a,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:["#",h]})}),e.jsxs(w,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(E,{alt:y.name,src:y.avatarUrl,sx:{mr:2}}),e.jsx(N,{primary:y.name,secondary:y.email,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(w,{width:"300px",children:(B=l==null?void 0:l.find(f=>f.uid===d[0].userId))==null?void 0:B.displayName}),e.jsx(w,{children:e.jsx(N,{primary:G(new Date(x),"dd MMM yyyy"),secondary:G(new Date(x),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(w,{align:"center",children:[" ",C," "]}),e.jsxs(w,{children:[" ",P(g)," "]}),e.jsxs(w,{children:[" ",P(g*.2)," "]}),e.jsx(w,{children:e.jsx(W,{variant:"soft",color:t==="completed"&&"success"||t==="pending"&&"warning"||t==="cancelled"&&"error"||"default",children:t})}),e.jsxs(w,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(D,{color:S.value?"inherit":"default",onClick:S.onToggle,sx:{...S.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(D,{color:v.open?"inherit":"default",onClick:v.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),U=e.jsx(Q,{children:e.jsx(w,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(se,{in:S.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(s,{component:oe,sx:{m:1.5},children:d.map(f=>e.jsxs(s,{direction:"row",alignItems:"center",sx:{p:R=>R.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:R=>`solid 2px ${R.palette.background.neutral}`}},children:[e.jsx(E,{src:f.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:f.name,secondary:f.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(i,{children:["x",f.quantity]}),e.jsx(i,{sx:{width:110,textAlign:"right"},children:P(f.salePrice)})]},f.id))})})})});return e.jsxs(e.Fragment,{children:[A,U,e.jsxs(K,{open:v.open,onClose:v.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(F,{onClick:()=>{a(),v.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(F,{onClick:()=>{b.onTrue(),v.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(Z,{open:b.value,onClose:b.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(k,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})}ee.propTypes={onDeleteRow:o.func,onSelectRow:o.func,onViewRow:o.func,row:o.object,selected:o.bool};o.object,o.func,o.func,o.number;o.node,o.string,o.object;[...Y];const Le=[{value:"all",label:"All"},...Y],Ne=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"partners",label:"Partners"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Ee={name:"",status:"all",startDate:null,endDate:null};function Qe(){const[n,l]=T.useState([]),[u,a]=T.useState([]),[j,m]=T.useState(""),h=async()=>{try{const{data:r}=await _.get("/orders");l(r.reverse())}catch(r){console.log(r.message)}},d=async()=>{const r=await Te(Pe(ve,"users")),c=[];r.forEach(z=>{c.push(z.data())}),a(c)};T.useEffect(()=>{h(),d()},[]);const t=Fe({defaultOrderBy:"orderNumber"}),x=ae(),y=le(),C=M(),[g,ne]=T.useState(Ee);g.startDate&&g.endDate&&g.startDate.getTime()>g.endDate.getTime();const b=Ae({inputData:n,comparator:Re(t.order,t.orderBy),filters:g}),S=b.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),v=t.dense?52:72,A=!!g.name||g.status!=="all"||!!g.startDate&&!!g.endDate,U=!b.length&&A||!b.length,B=T.useCallback(r=>{_.delete("orders",{data:{id:r}});const c=n.filter(z=>z.id!==r);l(c),t.onUpdatePageDeleteRow(S.length)},[S.length,t,n]),f=T.useCallback(()=>{_.delete("orders",{data:{id:t.selected}});const r=n.filter(c=>!t.selected.includes(c.id));l(r),t.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:S.length,totalRowsFiltered:b.length})},[b.length,S.length,t,n]),R=T.useCallback(r=>{y.push($.dashboard.order.details(r))},[y]),[I,re]=T.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{maxWidth:x.themeStretch?!1:"lg",children:[e.jsx(ce,{heading:"Orders",links:[{name:"Dashboard",href:$.dashboard.root},{name:"Orders",href:$.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(q,{children:[e.jsx(de,{value:I,onChange:(r,c)=>re(c),sx:{px:2.5,boxShadow:r=>`inset 0 -2px 0 0 ${xe(r.palette.grey[500],.08)}`},children:Le.map(r=>e.jsx(he,{iconPosition:"end",value:r.value,label:r.label,icon:e.jsxs(W,{variant:(r.value==="all"||r.value===g.status)&&"filled"||"soft",color:r.value==="completed"&&"success"||r.value==="pending"&&"warning"||r.value==="cancelled"&&"error"||"default",children:[r.value==="all"&&n.length,r.value==="pending"&&n.filter(c=>c.status==="Order received"||c.status==="pending").length,r.value==="completed"&&n.filter(c=>c.status==="completed").length,r.value==="cancelled"&&n.filter(c=>c.status==="cancelled").length,r.value==="refunded"&&n.filter(c=>c.status==="refunded").length]})},r.value))}),e.jsx(i,{p:1,children:e.jsxs(pe,{children:[e.jsx(ue,{id:"demo-simple-select-label",children:"Partners"}),e.jsxs(je,{label:"Partners",value:j,onChange:r=>m(r.target.value),placeholder:"Partners",sx:{minWidth:"200px"},size:"small",children:[e.jsx(F,{value:"",children:"Select a partner"}),u.map(r=>e.jsx(F,{value:r.uid,children:r.displayName}))]})]})}),e.jsxs(Be,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(me,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:r=>t.onSelectAllRows(r,n.map(c=>c.id)),action:e.jsx(ge,{title:"Delete",children:e.jsx(D,{color:"primary",onClick:C.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(X,{children:e.jsxs(ye,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(be,{order:t.order,orderBy:t.orderBy,headLabel:Ne,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:r=>t.onSelectAllRows(r,n.map(c=>c.id))}),e.jsxs(we,{children:[b.filter(r=>(I==="all"||I==="pending"&&(r.status==="pending"||r.status==="Order received")||I==="completed"&&r.status==="completed"||I==="cancelled"&&r.status==="cancelled"||I==="refunded"&&r.status==="refunded")&&(j?r.items.find(c=>c.userId===j):!0)).map(r=>e.jsx(ee,{store:u,row:r,selected:t.selected.includes(r.id),onSelectRow:()=>t.onSelectRow(r.id),onDeleteRow:()=>B(r.id),onViewRow:()=>R(r.id)},r.id)),e.jsx(fe,{height:v,emptyRows:Oe(t.page,t.rowsPerPage,n.length)}),e.jsx(Ce,{notFound:U})]})]})})]}),e.jsx(Se,{count:b.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,onChangeDense:t.onChangeDense})]})]}),e.jsx(Z,{open:C.value,onClose:C.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{f(),C.onFalse()},children:"Delete"})})]})}function Ae({inputData:n,comparator:l,filters:u,dateError:a}){const{status:j,name:m,startDate:h,endDate:d}=u,t=n.map((x,y)=>[x,y]);return t.sort((x,y)=>{const C=l(x[0],y[0]);return C!==0?C:x[1]-y[1]}),n=t.map(x=>x[0]),m&&(n=n.filter(x=>x.orderNumber.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.name.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.email.toLowerCase().indexOf(m.toLowerCase())!==-1)),j!=="all"&&(n=n.filter(x=>x.status===j)),a||h&&d&&(n=n.filter(x=>L(x.createdAt)>=L(h)&&L(x.createdAt)<=L(d))),n}function Ue({customer:n,delivery:l,payment:u,shippingAddress:a}){const j=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Customer Info",action:e.jsx(D,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(s,{direction:"row",sx:{p:3},children:[e.jsx(E,{alt:n==null?void 0:n.name,src:n==null?void 0:n.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(s,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx(V,{variant:"subtitle2",children:n==null?void 0:n.name}),e.jsx(i,{sx:{color:"text.secondary"},children:n==null?void 0:n.email}),e.jsx(k,{size:"small",color:"error",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),sx:{mt:1},children:"Add to Blacklist"})]})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Delivery",action:e.jsx(D,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(s,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Ship by"}),l==null?void 0:l.shipBy]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Speedy"}),l==null?void 0:l.speedy]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Tracking No."}),e.jsx(De,{underline:"always",color:"inherit",children:l==null?void 0:l.trackingNumber})]})]})]}),h=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Shipping",action:e.jsx(D,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(s,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Suite"}),a==null?void 0:a.fullAddress.split(",")[0]]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Street Address"}),a==null?void 0:a.fullAddress.split(",")[1]]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"City"}),a==null?void 0:a.fullAddress.split(",")[2]]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Country"}),a==null?void 0:a.fullAddress.split(",")[4]]}),e.jsxs(s,{direction:"row",alignItems:"center",children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),a==null?void 0:a.phoneNumber]})]})]}),d=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Payment",action:e.jsx(D,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(s,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(i,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Type"}),"Cash",e.jsx(p,{icon:"la:money-bill-wave",width:24,sx:{ml:.5,color:"#85bb65"}})]})]});return e.jsxs(q,{children:[j,e.jsx(H,{sx:{borderStyle:"dashed"}}),m,e.jsx(H,{sx:{borderStyle:"dashed"}}),h,e.jsx(H,{sx:{borderStyle:"dashed"}}),d]})}Ue.propTypes={customer:o.object,delivery:o.object,payment:o.object,shippingAddress:o.object};function ze({items:n=[],shipping:l,discount:u,taxes:a,subTotal:j,totalAmount:m}){const h=e.jsxs(s,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(s,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(i,{sx:{width:160,typography:"subtitle2"},children:P(j)||"-"})]}),e.jsxs(s,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(i,{sx:{width:160,...l&&{color:"error.main"}},children:l?`- ${P(l)}`:"-"})]}),e.jsxs(s,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Discount"}),e.jsx(i,{sx:{width:160,...u&&{color:"error.main"}},children:u?`- ${P(u)}`:"-"})]}),e.jsxs(s,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Taxes"}),e.jsx(i,{sx:{width:160},children:a?P(a):"-"})]}),e.jsxs(s,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(i,{children:"Total"}),e.jsx(i,{sx:{width:160},children:P(m)||"-"})]})]});return e.jsxs(q,{children:[e.jsx(O,{title:"Details"}),e.jsxs(s,{sx:{px:3},children:[e.jsx(X,{children:n==null?void 0:n.map(d=>e.jsxs(s,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:t=>`dashed 2px ${t.palette.background.neutral}`},children:[e.jsx(E,{src:d.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:d.name,secondary:d.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(i,{sx:{typography:"body2"},children:["x",d.quantity]}),e.jsx(i,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:P(d.salePrice)})]},d.id))}),h]})]})}ze.propTypes={discount:o.number,items:o.array,shipping:o.number,subTotal:o.number,taxes:o.number,totalAmount:o.number};function _e({status:n,backLink:l,createdAt:u,orderNumber:a,statusOptions:j,onChangeStatus:m}){const h=J();return e.jsxs(e.Fragment,{children:[e.jsxs(s,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[e.jsxs(s,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(D,{component:Ie,href:l,children:e.jsx(p,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(s,{spacing:.5,children:[e.jsxs(s,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs(V,{variant:"h4",children:[" Order ",a," "]}),e.jsx(W,{variant:"soft",color:n==="completed"&&"success"||n==="pending"&&"warning"||n==="cancelled"&&"error"||"default",children:n})]}),e.jsx(V,{variant:"body2",sx:{color:"text.disabled"},children:ke(u)})]})]}),e.jsxs(s,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(k,{color:"inherit",variant:"outlined",endIcon:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"}),onClick:h.onOpen,sx:{textTransform:"capitalize"},children:n}),e.jsx(k,{color:"inherit",variant:"outlined",startIcon:e.jsx(p,{icon:"solar:printer-minimalistic-bold"}),children:"Print"}),e.jsx(k,{color:"inherit",variant:"contained",startIcon:e.jsx(p,{icon:"solar:pen-bold"}),children:"Edit"})]})]}),e.jsx(K,{open:h.open,onClose:h.onClose,arrow:"top-right",sx:{width:140},children:j.map(d=>e.jsx(F,{selected:d.value===n,onClick:()=>{h.onClose(),m(d.value)},children:d.label},d.value))})]})}_e.propTypes={backLink:o.string,createdAt:o.instanceOf(Date),onChangeStatus:o.func,orderNumber:o.string,status:o.string,statusOptions:o.array};export{Qe as O,_e as a,ze as b,Ue as c};
