import{bu as V,c5 as J,ae as e,bE as Q,bF as b,b2 as ne,aq as c,aY as E,bs as N,cM as G,bB as k,a$ as $,b4 as v,aC as p,bt as te,aw as o,aV as re,c6 as K,b6 as B,az as D,as as d,D as P,aQ as se,b_ as oe,bw as _,aB as H,aE as ae,by as le,aL as q,aN as ie,am as ce,aO as de,cO as xe,cP as he,cQ as pe,cw as ue,ci as me,bH as Y,bI as je,bJ as ge,bK as ye,dg as be,dh as we,cx as fe,df as Ce,c7 as Se,c8 as Te,di as L,c9 as Pe,b3 as O,ac as W,aD as ve,aP as M,aA as ke,cc as Ie}from"./index-710a0060.js";import{C as X}from"./confirm-dialog-3e7f03d7.js";import{g as De,e as Re}from"./utils-74d4caeb.js";import{u as Oe}from"./use-table-286b8662.js";import{T as Be}from"./TableContainer-7ec34fa9.js";function Z({row:n,store:s=[],selected:g,onViewRow:a,onSelectRow:u,onDeleteRow:m}){var F;const{id:h,items:i,status:r,createdAt:x,customer:j,totalQuantity:f,subTotal:C}=n,y=V(),S=V(),T=J();console.log(s),console.log(i[0].userId);const A=e.jsxs(Q,{hover:!0,selected:g,children:[e.jsx(b,{padding:"checkbox",children:e.jsx(ne,{checked:g,onClick:u})}),e.jsx(b,{children:e.jsxs(c,{onClick:a,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:["#",h]})}),e.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(E,{alt:j.name,src:j.avatarUrl,sx:{mr:2}}),e.jsx(N,{primary:j.name,secondary:j.email,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(b,{width:"300px",children:(F=s==null?void 0:s.find(w=>w.uid===i[0].userId))==null?void 0:F.displayName}),e.jsx(b,{children:e.jsx(N,{primary:G(new Date(x),"dd MMM yyyy"),secondary:G(new Date(x),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(b,{align:"center",children:[" ",f," "]}),e.jsxs(b,{children:[" ",k(C)," "]}),e.jsxs(b,{children:[" ",k(C*.2)," "]}),e.jsx(b,{children:e.jsx($,{variant:"soft",color:r==="completed"&&"success"||r==="pending"&&"warning"||r==="cancelled"&&"error"||"default",children:r})}),e.jsxs(b,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(v,{color:S.value?"inherit":"default",onClick:S.onToggle,sx:{...S.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(v,{color:T.open?"inherit":"default",onClick:T.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),U=e.jsx(Q,{children:e.jsx(b,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(te,{in:S.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(o,{component:re,sx:{m:1.5},children:i.map(w=>e.jsxs(o,{direction:"row",alignItems:"center",sx:{p:R=>R.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:R=>`solid 2px ${R.palette.background.neutral}`}},children:[e.jsx(E,{src:w.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:w.name,secondary:w.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(c,{children:["x",w.quantity]}),e.jsx(c,{sx:{width:110,textAlign:"right"},children:k(w.price)})]},w.id))})})})});return e.jsxs(e.Fragment,{children:[A,U,e.jsxs(K,{open:T.open,onClose:T.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(B,{onClick:()=>{a(),T.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(B,{onClick:()=>{y.onTrue(),T.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(X,{open:y.value,onClose:y.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(D,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})}Z.propTypes={onDeleteRow:d.func,onSelectRow:d.func,onViewRow:d.func,row:d.object,selected:d.bool};const Fe=[{value:"all",label:"All"},...Ce],Le=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"partners",label:"Partners"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Ne={name:"",status:"all",startDate:null,endDate:null};function $e(){const[n,s]=P.useState([]),[g,a]=P.useState([]),[u,m]=P.useState(""),h=async()=>{try{const{data:t}=await _.get("/orders");s(t.reverse())}catch(t){console.log(t.message)}},i=async()=>{const t=await Se(Te(Pe,"users")),l=[];t.forEach(z=>{l.push(z.data())}),a(l)};P.useEffect(()=>{h(),i()},[]);const r=Oe({defaultOrderBy:"orderNumber"}),x=se(),j=oe(),f=V(),C=Ne,y=Ee({inputData:n,comparator:De(r.order,r.orderBy),filters:C}),S=y.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage),T=r.dense?52:72,A=!!C.name||C.status!=="all"||!!C.startDate&&!!C.endDate,U=!y.length&&A||!y.length,F=P.useCallback(t=>{_.delete("orders",{data:{id:t}});const l=n.filter(z=>z.id!==t);s(l),r.onUpdatePageDeleteRow(S.length)},[S.length,r,n]),w=P.useCallback(()=>{_.delete("orders",{data:{id:r.selected}});const t=n.filter(l=>!r.selected.includes(l.id));s(t),r.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:S.length,totalRowsFiltered:y.length})},[y.length,S.length,r,n]),R=P.useCallback(t=>{j.push(H.dashboard.order.details(t))},[j]),[I,ee]=P.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{maxWidth:x.themeStretch?!1:"lg",children:[e.jsx(le,{heading:"Orders",links:[{name:"Dashboard",href:H.dashboard.root},{name:"Orders",href:H.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(q,{children:[e.jsx(ie,{value:I,onChange:(t,l)=>ee(l),sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${ce(t.palette.grey[500],.08)}`},children:Fe.map(t=>e.jsx(de,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsxs($,{variant:(t.value==="all"||t.value===C.status)&&"filled"||"soft",color:t.value==="completed"&&"success"||t.value==="pending"&&"warning"||t.value==="cancelled"&&"error"||"default",children:[t.value==="all"&&n.length,t.value==="pending"&&n.filter(l=>l.status==="Order received"||l.status==="pending").length,t.value==="completed"&&n.filter(l=>l.status==="completed").length,t.value==="cancelled"&&n.filter(l=>l.status==="cancelled").length,t.value==="refunded"&&n.filter(l=>l.status==="refunded").length]})},t.value))}),e.jsx(c,{p:1,children:e.jsxs(xe,{children:[e.jsx(he,{id:"demo-simple-select-label",children:"Partners"}),e.jsxs(pe,{label:"Partners",value:u,onChange:t=>m(t.target.value),placeholder:"Partners",sx:{minWidth:"200px"},size:"small",children:[e.jsx(B,{value:"",children:"Select a partner"}),g.map(t=>e.jsx(B,{value:t.uid,children:t.displayName}))]})]})}),e.jsxs(Be,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(ue,{dense:r.dense,numSelected:r.selected.length,rowCount:n.length,onSelectAllRows:t=>r.onSelectAllRows(t,n.map(l=>l.id)),action:e.jsx(me,{title:"Delete",children:e.jsx(v,{color:"primary",onClick:f.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(Y,{children:e.jsxs(je,{size:r.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ge,{order:r.order,orderBy:r.orderBy,headLabel:Le,rowCount:n.length,numSelected:r.selected.length,onSort:r.onSort,onSelectAllRows:t=>r.onSelectAllRows(t,n.map(l=>l.id))}),e.jsxs(ye,{children:[y.filter(t=>(I==="all"||I==="pending"&&(t.status==="pending"||t.status==="Order received")||I==="completed"&&t.status==="completed"||I==="cancelled"&&t.status==="cancelled"||I==="refunded"&&t.status==="refunded")&&(u?t.items.find(l=>l.userId===u):!0)).map(t=>e.jsx(Z,{store:g,row:t,selected:r.selected.includes(t.id),onSelectRow:()=>r.onSelectRow(t.id),onDeleteRow:()=>F(t.id),onViewRow:()=>R(t.id)},t.id)),e.jsx(be,{height:T,emptyRows:Re(r.page,r.rowsPerPage,n.length)}),e.jsx(we,{notFound:U})]})]})})]}),e.jsx(fe,{count:y.length,page:r.page,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage,onChangeDense:r.onChangeDense})]})]}),e.jsx(X,{open:f.value,onClose:f.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",r.selected.length," "]})," items?"]}),action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{w(),f.onFalse()},children:"Delete"})})]})}function Ee({inputData:n,comparator:s,filters:g,dateError:a}){const{status:u,name:m,startDate:h,endDate:i}=g,r=n.map((x,j)=>[x,j]);return r.sort((x,j)=>{const f=s(x[0],j[0]);return f!==0?f:x[1]-j[1]}),n=r.map(x=>x[0]),m&&(n=n.filter(x=>x.orderNumber.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.name.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.email.toLowerCase().indexOf(m.toLowerCase())!==-1)),u!=="all"&&(n=n.filter(x=>x.status===u)),a||h&&i&&(n=n.filter(x=>L(x.createdAt)>=L(h)&&L(x.createdAt)<=L(i))),n}function Ae({customer:n,delivery:s,payment:g,shippingAddress:a}){const u=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Customer Info",action:e.jsx(v,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(o,{direction:"row",sx:{p:3},children:[e.jsx(E,{alt:n==null?void 0:n.name,src:n==null?void 0:n.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(o,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx(W,{variant:"subtitle2",children:n==null?void 0:n.name}),e.jsx(c,{sx:{color:"text.secondary"},children:n==null?void 0:n.email}),e.jsx(D,{size:"small",color:"error",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),sx:{mt:1},children:"Add to Blacklist"})]})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Delivery",action:e.jsx(v,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(o,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Ship by"}),s==null?void 0:s.shipBy]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Speedy"}),s==null?void 0:s.speedy]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Tracking No."}),e.jsx(ve,{underline:"always",color:"inherit",children:s==null?void 0:s.trackingNumber})]})]})]}),h=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Shipping",action:e.jsx(v,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(o,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Suite"}),a==null?void 0:a.fullAddress.split(",")[0]]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Street Address"}),a==null?void 0:a.fullAddress.split(",")[1]]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"City"}),a==null?void 0:a.fullAddress.split(",")[2]]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Country"}),a==null?void 0:a.fullAddress.split(",")[4]]}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),a==null?void 0:a.phoneNumber]})]})]}),i=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Payment",action:e.jsx(v,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(o,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(c,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Type"}),"Cash",e.jsx(p,{icon:"la:money-bill-wave",width:24,sx:{ml:.5,color:"#85bb65"}})]})]});return e.jsxs(q,{children:[u,e.jsx(M,{sx:{borderStyle:"dashed"}}),m,e.jsx(M,{sx:{borderStyle:"dashed"}}),h,e.jsx(M,{sx:{borderStyle:"dashed"}}),i]})}Ae.propTypes={customer:d.object,delivery:d.object,payment:d.object,shippingAddress:d.object};function Ue({items:n=[],shipping:s,discount:g,taxes:a,subTotal:u,totalAmount:m}){const h=e.jsxs(o,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(o,{direction:"row",children:[e.jsx(c,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(c,{sx:{width:160,typography:"subtitle2"},children:k(u)||"-"})]}),e.jsxs(o,{direction:"row",children:[e.jsx(c,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(c,{sx:{width:160,...s&&{color:"error.main"}},children:s?`- ${k(s)}`:"-"})]}),e.jsxs(o,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(c,{children:"Total"}),e.jsx(c,{sx:{width:160},children:k(m)||"-"})]})]});return e.jsxs(q,{children:[e.jsx(O,{title:"Details"}),e.jsxs(o,{sx:{px:3},children:[e.jsx(Y,{children:n==null?void 0:n.map(i=>e.jsxs(o,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:r=>`dashed 2px ${r.palette.background.neutral}`},children:[e.jsx(E,{src:i.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:i.name,secondary:i.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(c,{sx:{typography:"body2"},children:["x",i.quantity]}),e.jsx(c,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:k(i.price)})]},i.id))}),h]})]})}Ue.propTypes={discount:d.number,items:d.array,shipping:d.number,subTotal:d.number,taxes:d.number,totalAmount:d.number};function ze({status:n,backLink:s,createdAt:g,orderNumber:a,statusOptions:u,onChangeStatus:m}){const h=J();return e.jsxs(e.Fragment,{children:[e.jsxs(o,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[e.jsxs(o,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(v,{component:ke,href:s,children:e.jsx(p,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(o,{spacing:.5,children:[e.jsxs(o,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs(W,{variant:"h4",children:[" Order ",a," "]}),e.jsx($,{variant:"soft",color:n==="completed"&&"success"||n==="pending"&&"warning"||n==="cancelled"&&"error"||"default",children:n})]}),e.jsx(W,{variant:"body2",sx:{color:"text.disabled"},children:Ie(g)})]})]}),e.jsxs(o,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(D,{color:"inherit",variant:"outlined",endIcon:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"}),onClick:h.onOpen,sx:{textTransform:"capitalize"},children:n}),e.jsx(D,{color:"inherit",variant:"outlined",startIcon:e.jsx(p,{icon:"solar:printer-minimalistic-bold"}),children:"Print"}),e.jsx(D,{color:"inherit",variant:"contained",startIcon:e.jsx(p,{icon:"solar:pen-bold"}),children:"Edit"})]})]}),e.jsx(K,{open:h.open,onClose:h.onClose,arrow:"top-right",sx:{width:140},children:u.map(i=>e.jsx(B,{selected:i.value===n,onClick:()=>{h.onClose(),m(i.value)},children:i.label},i.value))})]})}ze.propTypes={backLink:d.string,createdAt:d.instanceOf(Date),onChangeStatus:d.func,orderNumber:d.string,status:d.string,statusOptions:d.array};export{$e as O,ze as a,Ue as b,Ae as c};
