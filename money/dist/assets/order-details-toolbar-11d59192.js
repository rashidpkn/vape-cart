import{aA as H,aU as Q,j as e,b6 as W,b7 as f,bH as ee,aS as o,b8 as L,b_ as F,b$ as G,c1 as I,c2 as V,aJ as v,aK as y,ck as ne,S as a,cl as re,aX as J,aY as O,B as N,P as d,a4 as P,az as se,a_ as _,p as z,br as te,aR as q,bp as ae,aM as oe,bq as le,c3 as ie,c4 as ce,c5 as de,bs as xe,bm as he,aZ as K,b3 as pe,b4 as ue,b5 as je,cm as me,cn as ge,bt as ye,cj as be,b0 as we,b1 as fe,co as B,b2 as Ce,aV as D,g as M,e as Se,cd as $,R as Te,cp as Pe}from"./index-58c1d6b6.js";import{C as X}from"./confirm-dialog-e89759f5.js";import{g as ve,e as ke}from"./utils-74d4caeb.js";import{u as Ie}from"./use-table-06eb58b1.js";import{T as Re}from"./TableContainer-a6313ec7.js";function Y({row:r,store:t=[],selected:u,onViewRow:l,onSelectRow:g,onDeleteRow:j}){const{id:p,items:h,status:s,createdAt:i,customer:x,totalQuantity:w,subTotal:C}=r,S=H(),R=H(),T=Q(),E=e.jsxs(W,{hover:!0,selected:u,children:[e.jsx(f,{padding:"checkbox",children:e.jsx(ee,{checked:u,onClick:g})}),e.jsx(f,{children:e.jsx(o,{onClick:l,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:`#${p.toString().padStart(3,"0")}`})}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(L,{alt:x.name,src:x.avatarUrl,sx:{mr:2}}),e.jsx(F,{primary:x.name,secondary:x.email,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(f,{width:"300px",children:h.map(b=>{var k;return e.jsxs("p",{style:{whiteSpace:"nowrap"},children:[" ",(k=t.find(m=>b.userId===m.uid))==null?void 0:k.displayName,"  "]},b.id)})}),e.jsx(f,{children:e.jsx(F,{primary:G(new Date(i),"dd MMM yyyy"),secondary:G(new Date(i),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(f,{align:"center",children:[" ",w," "]}),e.jsxs(f,{children:[" ",I(C)," "]}),e.jsxs(f,{children:[" ",I(C*.2)," "]}),e.jsx(f,{children:e.jsx(V,{variant:"soft",color:s==="completed"&&"success"||s==="pending"&&"warning"||s==="cancelled"&&"error"||"default",children:s})}),e.jsxs(f,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(v,{color:R.value?"inherit":"default",onClick:R.onToggle,sx:{...R.value&&{bgcolor:"action.hover"}},children:e.jsx(y,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(v,{color:T.open?"inherit":"default",onClick:T.onOpen,children:e.jsx(y,{icon:"eva:more-vertical-fill"})})]})]}),U=e.jsx(W,{children:e.jsx(f,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(ne,{in:R.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(a,{component:re,sx:{m:1.5},children:h.map(b=>{var k;return e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:m=>m.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:m=>`solid 2px ${m.palette.background.neutral}`}},children:[e.jsx(L,{src:b.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(F,{primary:b.name,secondary:b.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsx(o,{sx:{m:5},children:(k=t==null?void 0:t.find(m=>m.uid===b.userId))==null?void 0:k.displayName}),e.jsxs(o,{children:["x",b.quantity]}),e.jsx(o,{sx:{width:110,textAlign:"right"},children:I(b.price)})]},b.id)})})})})});return e.jsxs(e.Fragment,{children:[E,U,e.jsxs(J,{open:T.open,onClose:T.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(O,{onClick:()=>{l(),T.onClose()},children:[e.jsx(y,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(O,{onClick:()=>{S.onTrue(),T.onClose()},sx:{color:"error.main"},children:[e.jsx(y,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(X,{open:S.value,onClose:S.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(N,{variant:"contained",color:"error",onClick:j,children:"Delete"})})]})}Y.propTypes={onDeleteRow:d.func,onSelectRow:d.func,onViewRow:d.func,row:d.object,selected:d.bool};const De=[{value:"all",label:"All"},...be],Oe=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"partners",label:"Partners"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Be={name:"",status:"all",startDate:null,endDate:null};function He(){const[r,t]=P.useState([]),[u,l]=P.useState([]),[g,j]=P.useState(""),p=async()=>{try{const{data:n}=await _.get("/orders");t(n.reverse())}catch(n){console.log(n.message)}},h=async()=>{const n=await we(fe(Ce,"users")),c=[];n.forEach(A=>{c.push(A.data())}),l(c)};P.useEffect(()=>{p(),h()},[]);const s=Ie({defaultOrderBy:"orderNumber"}),i=se(),x=H(),w=Be,C=Fe({inputData:r,comparator:ve(s.order,s.orderBy),filters:w}),S=C.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),R=s.dense?52:72,T=!!w.name||w.status!=="all"||!!w.startDate&&!!w.endDate,E=!C.length&&T||!C.length,U=P.useCallback(n=>{_.delete("orders",{data:{id:n}});const c=r.filter(A=>A.id!==n);t(c),s.onUpdatePageDeleteRow(S.length)},[S.length,s,r]),b=P.useCallback(()=>{_.delete("orders",{data:{id:s.selected}});const n=r.filter(c=>!s.selected.includes(c.id));t(n),s.onUpdatePageDeleteRows({totalRows:r.length,totalRowsInPage:S.length,totalRowsFiltered:C.length})},[C.length,S.length,s,r]),k=P.useCallback(n=>{i.push(z.dashboard.order.details(n))},[i]),[m,Z]=P.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(o,{px:5,children:[e.jsx(te,{heading:"Orders",links:[{name:"Dashboard",href:z.dashboard.root},{name:"Orders",href:z.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(q,{children:[e.jsx(ae,{value:m,onChange:(n,c)=>Z(c),sx:{px:2.5,boxShadow:n=>`inset 0 -2px 0 0 ${oe(n.palette.grey[500],.08)}`},children:De.map(n=>e.jsx(le,{iconPosition:"end",value:n.value,label:n.label,icon:e.jsxs(V,{variant:(n.value==="all"||n.value===w.status)&&"filled"||"soft",color:n.value==="completed"&&"success"||n.value==="pending"&&"warning"||n.value==="cancelled"&&"error"||"default",children:[n.value==="all"&&r.length,n.value==="pending"&&r.filter(c=>c.status==="Order received"||c.status==="pending").length,n.value==="completed"&&r.filter(c=>c.status==="completed").length,n.value==="cancelled"&&r.filter(c=>c.status==="cancelled").length,n.value==="refunded"&&r.filter(c=>c.status==="refunded").length]})},n.value))}),e.jsx(o,{p:1,children:e.jsxs(ie,{children:[e.jsx(ce,{id:"demo-simple-select-label",children:"Partners"}),e.jsxs(de,{label:"Partners",value:g,onChange:n=>j(n.target.value),placeholder:"Partners",sx:{minWidth:"200px"},size:"small",children:[e.jsx(O,{value:"",children:"Select a partner"}),u.map(n=>e.jsx(O,{value:n.uid,children:n.displayName},n.uid))]})]})}),e.jsxs(Re,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(xe,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:n=>s.onSelectAllRows(n,r.map(c=>c.id)),action:e.jsx(he,{title:"Delete",children:e.jsx(v,{color:"primary",onClick:x.onTrue,children:e.jsx(y,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(K,{children:e.jsxs(pe,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ue,{order:s.order,orderBy:s.orderBy,headLabel:Oe,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:n=>s.onSelectAllRows(n,r.map(c=>c.id))}),e.jsxs(je,{children:[C.filter(n=>(m==="all"||m==="pending"&&(n.status==="pending"||n.status==="Order received")||m==="completed"&&n.status==="completed"||m==="cancelled"&&n.status==="cancelled"||m==="refunded"&&n.status==="refunded")&&(g?n.items.find(c=>c.userId===g):!0)).map(n=>e.jsx(Y,{store:u,row:n,selected:s.selected.includes(n.id),onSelectRow:()=>s.onSelectRow(n.id),onDeleteRow:()=>U(n.id),onViewRow:()=>k(n.id)},n.id)),e.jsx(me,{height:R,emptyRows:ke(s.page,s.rowsPerPage,r.length)}),e.jsx(ge,{notFound:E})]})]})})]}),e.jsx(ye,{count:C.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,onChangeDense:s.onChangeDense})]})]}),e.jsx(X,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",s.selected.length," "]})," items?"]}),action:e.jsx(N,{variant:"contained",color:"error",onClick:()=>{b(),x.onFalse()},children:"Delete"})})]})}function Fe({inputData:r,comparator:t,filters:u,dateError:l}){const{status:g,name:j,startDate:p,endDate:h}=u,s=r.map((i,x)=>[i,x]);return s.sort((i,x)=>{const w=t(i[0],x[0]);return w!==0?w:i[1]-x[1]}),r=s.map(i=>i[0]),j&&(r=r.filter(i=>i.orderNumber.toLowerCase().indexOf(j.toLowerCase())!==-1||i.customer.name.toLowerCase().indexOf(j.toLowerCase())!==-1||i.customer.email.toLowerCase().indexOf(j.toLowerCase())!==-1)),g!=="all"&&(r=r.filter(i=>i.status===g)),l||p&&h&&(r=r.filter(i=>B(i.createdAt)>=B(p)&&B(i.createdAt)<=B(h))),r}function Le({customer:r,delivery:t,payment:u,shippingAddress:l}){const g=e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Customer Info",action:e.jsx(v,{children:e.jsx(y,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",sx:{p:3},children:[e.jsx(L,{alt:r==null?void 0:r.name,src:r==null?void 0:r.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(a,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx(M,{variant:"subtitle2",children:r==null?void 0:r.name}),e.jsx(o,{sx:{color:"text.secondary"},children:r==null?void 0:r.email}),e.jsx(N,{size:"small",color:"error",startIcon:e.jsx(y,{icon:"mingcute:add-line"}),sx:{mt:1},children:"Add to Blacklist"})]})]})]}),j=e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Delivery",action:e.jsx(v,{children:e.jsx(y,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Ship by"}),t==null?void 0:t.shipBy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Speedy"}),t==null?void 0:t.speedy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Tracking No."}),e.jsx(Se,{underline:"always",color:"inherit",children:t==null?void 0:t.trackingNumber})]})]})]}),p=e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Shipping",action:e.jsx(v,{children:e.jsx(y,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Suite"}),l==null?void 0:l.fullAddress.split(",")[0]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Street Address"}),l==null?void 0:l.fullAddress.split(",")[1]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"City"}),l==null?void 0:l.fullAddress.split(",")[2]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Country"}),l==null?void 0:l.fullAddress.split(",")[4]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),l==null?void 0:l.phoneNumber]})]})]}),h=e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Payment",action:e.jsx(v,{children:e.jsx(y,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Type"}),"Cash",e.jsx(y,{icon:"la:money-bill-wave",width:24,sx:{ml:.5,color:"#85bb65"}})]})]});return e.jsxs(q,{children:[g,e.jsx($,{sx:{borderStyle:"dashed"}}),j,e.jsx($,{sx:{borderStyle:"dashed"}}),p,e.jsx($,{sx:{borderStyle:"dashed"}}),h]})}Le.propTypes={customer:d.object,delivery:d.object,payment:d.object,shippingAddress:d.object};function Ne({store:r,items:t=[],shipping:u,discount:l,taxes:g,subTotal:j,totalAmount:p}){const h=e.jsxs(a,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(a,{direction:"row",children:[e.jsx(o,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(o,{sx:{width:160,typography:"subtitle2"},children:I(j)||"-"})]}),e.jsxs(a,{direction:"row",children:[e.jsx(o,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(o,{sx:{width:160,...u&&{color:"error.main"}},children:u?`- ${I(u)}`:"-"})]}),e.jsxs(a,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(o,{children:"Total"}),e.jsx(o,{sx:{width:160},children:I(p)||"-"})]})]});return e.jsxs(q,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{p:2},children:[e.jsx(D,{title:"Details",sx:{margin:"0px",p:0}}),e.jsx("p",{style:{width:"40%",margin:"0px"},children:"Partner"})]}),e.jsxs(a,{sx:{px:3},children:[e.jsx(K,{children:t==null?void 0:t.map(s=>{var i;return e.jsxs(a,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:x=>`dashed 2px ${x.palette.background.neutral}`},children:[e.jsx(L,{src:s.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(F,{primary:s.name,secondary:s.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"40%",flexShrink:0},children:[e.jsx("p",{children:(i=r==null?void 0:r.find(x=>x.uid===s.userId))==null?void 0:i.displayName}),e.jsxs(o,{sx:{typography:"body2"},children:["x",s.quantity]}),e.jsx(o,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:I(s.price)})]})]},s.id)})}),h]})]})}Ne.propTypes={discount:d.number,items:d.array,shipping:d.number,subTotal:d.number,taxes:d.number,totalAmount:d.number};function Ee({status:r,backLink:t,createdAt:u,orderNumber:l,statusOptions:g,onChangeStatus:j}){const p=Q();return e.jsxs(e.Fragment,{children:[e.jsxs(a,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(v,{component:Te,href:t,children:e.jsx(y,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(a,{spacing:.5,children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs(M,{variant:"h4",children:[" Order ",l," "]}),e.jsx(V,{variant:"soft",color:r==="completed"&&"success"||r==="pending"&&"warning"||r==="cancelled"&&"error"||"default",children:r})]}),e.jsx(M,{variant:"body2",sx:{color:"text.disabled"},children:Pe(u)})]})]}),e.jsx(a,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:e.jsx(N,{color:"inherit",variant:"outlined",endIcon:e.jsx(y,{icon:"eva:arrow-ios-downward-fill"}),onClick:p.onOpen,sx:{textTransform:"capitalize"},children:r})})]}),e.jsx(J,{open:p.open,onClose:p.onClose,arrow:"top-right",sx:{width:140},children:g.map(h=>e.jsx(O,{selected:h.value===r,onClick:()=>{p.onClose(),j(h.value)},children:h.label},h.value))})]})}Ee.propTypes={backLink:d.string,createdAt:d.string,onChangeStatus:d.func,orderNumber:d.string,status:d.string,statusOptions:d.array};export{He as O,Ee as a,Ne as b,Le as c};
