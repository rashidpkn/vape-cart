import{aA as q,aQ as G,j as e,b3 as M,b4 as f,bI as ee,aO as o,b5 as N,b$ as L,c0 as Q,c2 as k,c3 as W,aJ as v,aK as u,cl as ne,S as a,cm as re,aT as J,aU as B,B as D,P as d,a4 as P,aX as te,az as se,aW as $,p as z,bs as ae,aN as H,bq as oe,b6 as le,br as ie,c4 as ce,c5 as de,c6 as xe,bt as he,bn as pe,aV as K,b0 as ue,b1 as je,b2 as me,cn as ge,co as ye,bu as be,ck as we,aZ as fe,a_ as Ce,cp as F,a$ as Se,aR as O,g as V,e as Te,ce as _,R as Pe,cq as ve}from"./index-519398e3.js";import{C as X}from"./confirm-dialog-d0bc3927.js";import{g as Ie,e as ke}from"./utils-74d4caeb.js";import{u as Re}from"./use-table-9e27d7db.js";import{T as De}from"./TableContainer-7d1c93e5.js";function Z({row:n,store:s=[],selected:j,onViewRow:l,onSelectRow:y,onDeleteRow:m}){const{id:p,items:h,status:t,createdAt:i,customer:x,totalQuantity:b,subTotal:C}=n,S=q(),R=q(),T=G(),E=e.jsxs(M,{hover:!0,selected:j,children:[e.jsx(f,{padding:"checkbox",children:e.jsx(ee,{checked:j,onClick:y})}),e.jsx(f,{children:e.jsx(o,{onClick:l,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:`#${p.toString().padStart(3,"0")}`})}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(N,{alt:x.name,src:x.avatarUrl,sx:{mr:2}}),e.jsx(L,{primary:x.name,secondary:x.email,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(f,{width:"300px",children:h.map(w=>{var I;return e.jsxs("p",{style:{whiteSpace:"nowrap"},children:[" ",(I=s.find(g=>w.userId===g.uid))==null?void 0:I.displayName,"  "]})})}),e.jsx(f,{children:e.jsx(L,{primary:Q(new Date(i),"dd MMM yyyy"),secondary:Q(new Date(i),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(f,{align:"center",children:[" ",b," "]}),e.jsxs(f,{children:[" ",k(C)," "]}),e.jsxs(f,{children:[" ",k(C*.2)," "]}),e.jsx(f,{children:e.jsx(W,{variant:"soft",color:t==="completed"&&"success"||t==="pending"&&"warning"||t==="cancelled"&&"error"||"default",children:t})}),e.jsxs(f,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(v,{color:R.value?"inherit":"default",onClick:R.onToggle,sx:{...R.value&&{bgcolor:"action.hover"}},children:e.jsx(u,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(v,{color:T.open?"inherit":"default",onClick:T.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})]})]}),U=e.jsx(M,{children:e.jsx(f,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(ne,{in:R.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(a,{component:re,sx:{m:1.5},children:h.map(w=>{var I;return e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:g=>g.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:g=>`solid 2px ${g.palette.background.neutral}`}},children:[e.jsx(N,{src:w.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(L,{primary:w.name,secondary:w.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsx(o,{sx:{m:5},children:(I=s==null?void 0:s.find(g=>g.uid===w.userId))==null?void 0:I.displayName}),e.jsxs(o,{children:["x",w.quantity]}),e.jsx(o,{sx:{width:110,textAlign:"right"},children:k(w.price)})]},w.id)})})})})});return e.jsxs(e.Fragment,{children:[E,U,e.jsxs(J,{open:T.open,onClose:T.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(B,{onClick:()=>{l(),T.onClose()},children:[e.jsx(u,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(B,{onClick:()=>{S.onTrue(),T.onClose()},sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(X,{open:S.value,onClose:S.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(D,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})}Z.propTypes={onDeleteRow:d.func,onSelectRow:d.func,onViewRow:d.func,row:d.object,selected:d.bool};const Oe=[{value:"all",label:"All"},...we],Be=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"partners",label:"Partners"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Fe={name:"",status:"all",startDate:null,endDate:null};function Ve(){const[n,s]=P.useState([]),[j,l]=P.useState([]),[y,m]=P.useState(""),p=async()=>{try{const{data:r}=await $.get("/orders");s(r.reverse())}catch(r){console.log(r.message)}},h=async()=>{const r=await fe(Ce(Se,"users")),c=[];r.forEach(A=>{c.push(A.data())}),l(c)};P.useEffect(()=>{p(),h()},[]);const t=Re({defaultOrderBy:"orderNumber"});te();const i=se(),x=q(),b=Fe,C=Le({inputData:n,comparator:Ie(t.order,t.orderBy),filters:b}),S=C.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),R=t.dense?52:72,T=!!b.name||b.status!=="all"||!!b.startDate&&!!b.endDate,E=!C.length&&T||!C.length,U=P.useCallback(r=>{$.delete("orders",{data:{id:r}});const c=n.filter(A=>A.id!==r);s(c),t.onUpdatePageDeleteRow(S.length)},[S.length,t,n]),w=P.useCallback(()=>{$.delete("orders",{data:{id:t.selected}});const r=n.filter(c=>!t.selected.includes(c.id));s(r),t.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:S.length,totalRowsFiltered:C.length})},[C.length,S.length,t,n]),I=P.useCallback(r=>{i.push(z.dashboard.order.details(r))},[i]),[g,Y]=P.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(o,{px:5,children:[e.jsx(ae,{heading:"Orders",links:[{name:"Dashboard",href:z.dashboard.root},{name:"Orders",href:z.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(H,{children:[e.jsx(oe,{value:g,onChange:(r,c)=>Y(c),sx:{px:2.5,boxShadow:r=>`inset 0 -2px 0 0 ${le(r.palette.grey[500],.08)}`},children:Oe.map(r=>e.jsx(ie,{iconPosition:"end",value:r.value,label:r.label,icon:e.jsxs(W,{variant:(r.value==="all"||r.value===b.status)&&"filled"||"soft",color:r.value==="completed"&&"success"||r.value==="pending"&&"warning"||r.value==="cancelled"&&"error"||"default",children:[r.value==="all"&&n.length,r.value==="pending"&&n.filter(c=>c.status==="Order received"||c.status==="pending").length,r.value==="completed"&&n.filter(c=>c.status==="completed").length,r.value==="cancelled"&&n.filter(c=>c.status==="cancelled").length,r.value==="refunded"&&n.filter(c=>c.status==="refunded").length]})},r.value))}),e.jsx(o,{p:1,children:e.jsxs(ce,{children:[e.jsx(de,{id:"demo-simple-select-label",children:"Partners"}),e.jsxs(xe,{label:"Partners",value:y,onChange:r=>m(r.target.value),placeholder:"Partners",sx:{minWidth:"200px"},size:"small",children:[e.jsx(B,{value:"",children:"Select a partner"}),j.map(r=>e.jsx(B,{value:r.uid,children:r.displayName}))]})]})}),e.jsxs(De,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(he,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:r=>t.onSelectAllRows(r,n.map(c=>c.id)),action:e.jsx(pe,{title:"Delete",children:e.jsx(v,{color:"primary",onClick:x.onTrue,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(K,{children:e.jsxs(ue,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(je,{order:t.order,orderBy:t.orderBy,headLabel:Be,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:r=>t.onSelectAllRows(r,n.map(c=>c.id))}),e.jsxs(me,{children:[C.filter(r=>(g==="all"||g==="pending"&&(r.status==="pending"||r.status==="Order received")||g==="completed"&&r.status==="completed"||g==="cancelled"&&r.status==="cancelled"||g==="refunded"&&r.status==="refunded")&&(y?r.items.find(c=>c.userId===y):!0)).map(r=>e.jsx(Z,{store:j,row:r,selected:t.selected.includes(r.id),onSelectRow:()=>t.onSelectRow(r.id),onDeleteRow:()=>U(r.id),onViewRow:()=>I(r.id)},r.id)),e.jsx(ge,{height:R,emptyRows:ke(t.page,t.rowsPerPage,n.length)}),e.jsx(ye,{notFound:E})]})]})})]}),e.jsx(be,{count:C.length,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,onChangeDense:t.onChangeDense})]})]}),e.jsx(X,{open:x.value,onClose:x.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{w(),x.onFalse()},children:"Delete"})})]})}function Le({inputData:n,comparator:s,filters:j,dateError:l}){const{status:y,name:m,startDate:p,endDate:h}=j,t=n.map((i,x)=>[i,x]);return t.sort((i,x)=>{const b=s(i[0],x[0]);return b!==0?b:i[1]-x[1]}),n=t.map(i=>i[0]),m&&(n=n.filter(i=>i.orderNumber.toLowerCase().indexOf(m.toLowerCase())!==-1||i.customer.name.toLowerCase().indexOf(m.toLowerCase())!==-1||i.customer.email.toLowerCase().indexOf(m.toLowerCase())!==-1)),y!=="all"&&(n=n.filter(i=>i.status===y)),l||p&&h&&(n=n.filter(i=>F(i.createdAt)>=F(p)&&F(i.createdAt)<=F(h))),n}function Ne({customer:n,delivery:s,payment:j,shippingAddress:l}){const y=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Customer Info",action:e.jsx(v,{children:e.jsx(u,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",sx:{p:3},children:[e.jsx(N,{alt:n==null?void 0:n.name,src:n==null?void 0:n.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(a,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx(V,{variant:"subtitle2",children:n==null?void 0:n.name}),e.jsx(o,{sx:{color:"text.secondary"},children:n==null?void 0:n.email}),e.jsx(D,{size:"small",color:"error",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),sx:{mt:1},children:"Add to Blacklist"})]})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Delivery",action:e.jsx(v,{children:e.jsx(u,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Ship by"}),s==null?void 0:s.shipBy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Speedy"}),s==null?void 0:s.speedy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Tracking No."}),e.jsx(Te,{underline:"always",color:"inherit",children:s==null?void 0:s.trackingNumber})]})]})]}),p=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Shipping",action:e.jsx(v,{children:e.jsx(u,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Suite"}),l==null?void 0:l.fullAddress.split(",")[0]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Street Address"}),l==null?void 0:l.fullAddress.split(",")[1]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"City"}),l==null?void 0:l.fullAddress.split(",")[2]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Country"}),l==null?void 0:l.fullAddress.split(",")[4]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),l==null?void 0:l.phoneNumber]})]})]}),h=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Payment",action:e.jsx(v,{children:e.jsx(u,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(o,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Type"}),"Cash",e.jsx(u,{icon:"la:money-bill-wave",width:24,sx:{ml:.5,color:"#85bb65"}})]})]});return e.jsxs(H,{children:[y,e.jsx(_,{sx:{borderStyle:"dashed"}}),m,e.jsx(_,{sx:{borderStyle:"dashed"}}),p,e.jsx(_,{sx:{borderStyle:"dashed"}}),h]})}Ne.propTypes={customer:d.object,delivery:d.object,payment:d.object,shippingAddress:d.object};function Ee({store:n,items:s=[],shipping:j,discount:l,taxes:y,subTotal:m,totalAmount:p}){const h=e.jsxs(a,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(a,{direction:"row",children:[e.jsx(o,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(o,{sx:{width:160,typography:"subtitle2"},children:k(m)||"-"})]}),e.jsxs(a,{direction:"row",children:[e.jsx(o,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(o,{sx:{width:160,...j&&{color:"error.main"}},children:j?`- ${k(j)}`:"-"})]}),e.jsxs(a,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(o,{children:"Total"}),e.jsx(o,{sx:{width:160},children:k(p)||"-"})]})]});return e.jsxs(H,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{p:2},children:[e.jsx(O,{title:"Details",sx:{margin:"0px",p:0}}),e.jsx("p",{style:{width:"40%",margin:"0px"},children:"Partner"})]}),e.jsxs(a,{sx:{px:3},children:[e.jsx(K,{children:s==null?void 0:s.map(t=>{var i;return e.jsxs(a,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:x=>`dashed 2px ${x.palette.background.neutral}`},children:[e.jsx(N,{src:t.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(L,{primary:t.name,secondary:t.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"40%",flexShrink:0},children:[e.jsx("p",{children:(i=n==null?void 0:n.find(x=>x.uid===t.userId))==null?void 0:i.displayName}),e.jsxs(o,{sx:{typography:"body2"},children:["x",t.quantity]}),e.jsx(o,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:k(t.price)})]})]},t.id)})}),h]})]})}Ee.propTypes={discount:d.number,items:d.array,shipping:d.number,subTotal:d.number,taxes:d.number,totalAmount:d.number};function Ue({status:n,backLink:s,createdAt:j,orderNumber:l,statusOptions:y,onChangeStatus:m}){const p=G();return e.jsxs(e.Fragment,{children:[e.jsxs(a,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(v,{component:Pe,href:s,children:e.jsx(u,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(a,{spacing:.5,children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs(V,{variant:"h4",children:[" Order ",l," "]}),e.jsx(W,{variant:"soft",color:n==="completed"&&"success"||n==="pending"&&"warning"||n==="cancelled"&&"error"||"default",children:n})]}),e.jsx(V,{variant:"body2",sx:{color:"text.disabled"},children:ve(j)})]})]}),e.jsxs(a,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(D,{color:"inherit",variant:"outlined",endIcon:e.jsx(u,{icon:"eva:arrow-ios-downward-fill"}),onClick:p.onOpen,sx:{textTransform:"capitalize"},children:n}),e.jsx(D,{color:"inherit",variant:"outlined",startIcon:e.jsx(u,{icon:"solar:printer-minimalistic-bold"}),children:"Print"}),e.jsx(D,{color:"inherit",variant:"contained",startIcon:e.jsx(u,{icon:"solar:pen-bold"}),children:"Edit"})]})]}),e.jsx(J,{open:p.open,onClose:p.onClose,arrow:"top-right",sx:{width:140},children:y.map(h=>e.jsx(B,{selected:h.value===n,onClick:()=>{p.onClose(),m(h.value)},children:h.label},h.value))})]})}Ue.propTypes={backLink:d.string,createdAt:d.instanceOf(Date),onChangeStatus:d.func,orderNumber:d.string,status:d.string,statusOptions:d.array};export{Ve as O,Ue as a,Ee as b,Ne as c};
