import{bu as W,c5 as J,ae as e,bE as Q,bF as w,b2 as re,aq as d,aY as E,bs as N,cL as G,bB as D,a$ as q,b4 as P,aC as p,bt as se,aw as a,aV as oe,c6 as K,b6 as F,az as k,as as s,de as Y,D as T,aQ as ae,b_ as le,bw as _,aB as H,aE as ie,by as ce,aL as M,aN as de,am as xe,aO as he,cN as pe,cO as ue,cP as me,cw as je,ci as ge,bH as X,bI as ye,bJ as be,bK as we,df as fe,dg as Ce,cx as Se,c7 as Te,c8 as ve,dh as L,c9 as Pe,b3 as O,ac as $,aD as De,aP as V,aA as Ie,cc as ke}from"./index-fe07d94b.js";import{C as Z}from"./confirm-dialog-3d3f826c.js";import{g as Re,e as Oe}from"./utils-74d4caeb.js";import{u as Fe}from"./use-table-96a327fb.js";import"./custom-date-range-picker-214b81a7.js";import{T as Be}from"./TableContainer-928a542c.js";function ee({row:n,store:o=[],selected:y,onViewRow:l,onSelectRow:u,onDeleteRow:m}){var B;const{id:h,items:c,status:r,createdAt:x,customer:g,totalQuantity:C,subTotal:j,userId:ne}=n,b=W(),S=W(),v=J();console.log(o),console.log(c[0].userId);const A=e.jsxs(Q,{hover:!0,selected:y,children:[e.jsx(w,{padding:"checkbox",children:e.jsx(re,{checked:y,onClick:u})}),e.jsx(w,{children:e.jsxs(d,{onClick:l,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:["#",h]})}),e.jsxs(w,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(E,{alt:g.name,src:g.avatarUrl,sx:{mr:2}}),e.jsx(N,{primary:g.name,secondary:g.email,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(w,{width:"300px",children:(B=o==null?void 0:o.find(f=>f.uid===c[0].userId))==null?void 0:B.displayName}),e.jsx(w,{children:e.jsx(N,{primary:G(new Date(x),"dd MMM yyyy"),secondary:G(new Date(x),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(w,{align:"center",children:[" ",C," "]}),e.jsxs(w,{children:[" ",D(j)," "]}),e.jsxs(w,{children:[" ",D(j*.2)," "]}),e.jsx(w,{children:e.jsx(q,{variant:"soft",color:r==="completed"&&"success"||r==="pending"&&"warning"||r==="cancelled"&&"error"||"default",children:r})}),e.jsxs(w,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(P,{color:S.value?"inherit":"default",onClick:S.onToggle,sx:{...S.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(P,{color:v.open?"inherit":"default",onClick:v.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),U=e.jsx(Q,{children:e.jsx(w,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(se,{in:S.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(a,{component:oe,sx:{m:1.5},children:c.map(f=>e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:R=>R.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:R=>`solid 2px ${R.palette.background.neutral}`}},children:[e.jsx(E,{src:f.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:f.name,secondary:f.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(d,{children:["x",f.quantity]}),e.jsx(d,{sx:{width:110,textAlign:"right"},children:D(f.price)})]},f.id))})})})});return e.jsxs(e.Fragment,{children:[A,U,e.jsxs(K,{open:v.open,onClose:v.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(F,{onClick:()=>{l(),v.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(F,{onClick:()=>{b.onTrue(),v.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(Z,{open:b.value,onClose:b.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(k,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})}ee.propTypes={onDeleteRow:s.func,onSelectRow:s.func,onViewRow:s.func,row:s.object,selected:s.bool};s.object,s.func,s.func,s.number;s.node,s.string,s.object;[...Y];const Le=[{value:"all",label:"All"},...Y],Ne=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"partners",label:"Partners"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Ee={name:"",status:"all",startDate:null,endDate:null};function Qe(){const[n,o]=T.useState([]),[y,l]=T.useState([]),[u,m]=T.useState(""),h=async()=>{try{const{data:t}=await _.get("/orders");o(t.reverse())}catch(t){console.log(t.message)}},c=async()=>{const t=await Te(ve(Pe,"users")),i=[];t.forEach(z=>{i.push(z.data())}),l(i)};T.useEffect(()=>{h(),c()},[]);const r=Fe({defaultOrderBy:"orderNumber"}),x=ae(),g=le(),C=W(),[j,ne]=T.useState(Ee);j.startDate&&j.endDate&&j.startDate.getTime()>j.endDate.getTime();const b=Ae({inputData:n,comparator:Re(r.order,r.orderBy),filters:j}),S=b.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage),v=r.dense?52:72,A=!!j.name||j.status!=="all"||!!j.startDate&&!!j.endDate,U=!b.length&&A||!b.length,B=T.useCallback(t=>{_.delete("orders",{data:{id:t}});const i=n.filter(z=>z.id!==t);o(i),r.onUpdatePageDeleteRow(S.length)},[S.length,r,n]),f=T.useCallback(()=>{_.delete("orders",{data:{id:r.selected}});const t=n.filter(i=>!r.selected.includes(i.id));o(t),r.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:S.length,totalRowsFiltered:b.length})},[b.length,S.length,r,n]),R=T.useCallback(t=>{g.push(H.dashboard.order.details(t))},[g]),[I,te]=T.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{maxWidth:x.themeStretch?!1:"lg",children:[e.jsx(ce,{heading:"Orders",links:[{name:"Dashboard",href:H.dashboard.root},{name:"Orders",href:H.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(M,{children:[e.jsx(de,{value:I,onChange:(t,i)=>te(i),sx:{px:2.5,boxShadow:t=>`inset 0 -2px 0 0 ${xe(t.palette.grey[500],.08)}`},children:Le.map(t=>e.jsx(he,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsxs(q,{variant:(t.value==="all"||t.value===j.status)&&"filled"||"soft",color:t.value==="completed"&&"success"||t.value==="pending"&&"warning"||t.value==="cancelled"&&"error"||"default",children:[t.value==="all"&&n.length,t.value==="pending"&&n.filter(i=>i.status==="Order received"||i.status==="pending").length,t.value==="completed"&&n.filter(i=>i.status==="completed").length,t.value==="cancelled"&&n.filter(i=>i.status==="cancelled").length,t.value==="refunded"&&n.filter(i=>i.status==="refunded").length]})},t.value))}),e.jsx(d,{p:1,children:e.jsxs(pe,{children:[e.jsx(ue,{id:"demo-simple-select-label",children:"Partners"}),e.jsxs(me,{label:"Partners",value:u,onChange:t=>m(t.target.value),placeholder:"Partners",sx:{minWidth:"200px"},size:"small",children:[e.jsx(F,{value:"",children:"Select a partner"}),y.map(t=>e.jsx(F,{value:t.uid,children:t.displayName}))]})]})}),e.jsxs(Be,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(je,{dense:r.dense,numSelected:r.selected.length,rowCount:n.length,onSelectAllRows:t=>r.onSelectAllRows(t,n.map(i=>i.id)),action:e.jsx(ge,{title:"Delete",children:e.jsx(P,{color:"primary",onClick:C.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(X,{children:e.jsxs(ye,{size:r.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(be,{order:r.order,orderBy:r.orderBy,headLabel:Ne,rowCount:n.length,numSelected:r.selected.length,onSort:r.onSort,onSelectAllRows:t=>r.onSelectAllRows(t,n.map(i=>i.id))}),e.jsxs(we,{children:[b.filter(t=>(I==="all"||I==="pending"&&(t.status==="pending"||t.status==="Order received")||I==="completed"&&t.status==="completed"||I==="cancelled"&&t.status==="cancelled"||I==="refunded"&&t.status==="refunded")&&(u?t.items.find(i=>i.userId===u):!0)).map(t=>e.jsx(ee,{store:y,row:t,selected:r.selected.includes(t.id),onSelectRow:()=>r.onSelectRow(t.id),onDeleteRow:()=>B(t.id),onViewRow:()=>R(t.id)},t.id)),e.jsx(fe,{height:v,emptyRows:Oe(r.page,r.rowsPerPage,n.length)}),e.jsx(Ce,{notFound:U})]})]})})]}),e.jsx(Se,{count:b.length,page:r.page,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage,onChangeDense:r.onChangeDense})]})]}),e.jsx(Z,{open:C.value,onClose:C.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",r.selected.length," "]})," items?"]}),action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{f(),C.onFalse()},children:"Delete"})})]})}function Ae({inputData:n,comparator:o,filters:y,dateError:l}){const{status:u,name:m,startDate:h,endDate:c}=y,r=n.map((x,g)=>[x,g]);return r.sort((x,g)=>{const C=o(x[0],g[0]);return C!==0?C:x[1]-g[1]}),n=r.map(x=>x[0]),m&&(n=n.filter(x=>x.orderNumber.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.name.toLowerCase().indexOf(m.toLowerCase())!==-1||x.customer.email.toLowerCase().indexOf(m.toLowerCase())!==-1)),u!=="all"&&(n=n.filter(x=>x.status===u)),l||h&&c&&(n=n.filter(x=>L(x.createdAt)>=L(h)&&L(x.createdAt)<=L(c))),n}function Ue({customer:n,delivery:o,payment:y,shippingAddress:l}){const u=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Customer Info",action:e.jsx(P,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",sx:{p:3},children:[e.jsx(E,{alt:n==null?void 0:n.name,src:n==null?void 0:n.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(a,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx($,{variant:"subtitle2",children:n==null?void 0:n.name}),e.jsx(d,{sx:{color:"text.secondary"},children:n==null?void 0:n.email}),e.jsx(k,{size:"small",color:"error",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),sx:{mt:1},children:"Add to Blacklist"})]})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Delivery",action:e.jsx(P,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Ship by"}),o==null?void 0:o.shipBy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Speedy"}),o==null?void 0:o.speedy]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Tracking No."}),e.jsx(De,{underline:"always",color:"inherit",children:o==null?void 0:o.trackingNumber})]})]})]}),h=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Shipping",action:e.jsx(P,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(a,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Suite"}),l==null?void 0:l.fullAddress.split(",")[0]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Street Address"}),l==null?void 0:l.fullAddress.split(",")[1]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"City"}),l==null?void 0:l.fullAddress.split(",")[2]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Country"}),l==null?void 0:l.fullAddress.split(",")[4]]}),e.jsxs(a,{direction:"row",alignItems:"center",children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),l==null?void 0:l.phoneNumber]})]})]}),c=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Payment",action:e.jsx(P,{children:e.jsx(p,{icon:"solar:pen-bold"})})}),e.jsxs(a,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(d,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Type"}),"Cash",e.jsx(p,{icon:"la:money-bill-wave",width:24,sx:{ml:.5,color:"#85bb65"}})]})]});return e.jsxs(M,{children:[u,e.jsx(V,{sx:{borderStyle:"dashed"}}),m,e.jsx(V,{sx:{borderStyle:"dashed"}}),h,e.jsx(V,{sx:{borderStyle:"dashed"}}),c]})}Ue.propTypes={customer:s.object,delivery:s.object,payment:s.object,shippingAddress:s.object};function ze({items:n=[],shipping:o,discount:y,taxes:l,subTotal:u,totalAmount:m}){const h=e.jsxs(a,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(a,{direction:"row",children:[e.jsx(d,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(d,{sx:{width:160,typography:"subtitle2"},children:D(u)||"-"})]}),e.jsxs(a,{direction:"row",children:[e.jsx(d,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(d,{sx:{width:160,...o&&{color:"error.main"}},children:o?`- ${D(o)}`:"-"})]}),e.jsxs(a,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(d,{children:"Total"}),e.jsx(d,{sx:{width:160},children:D(m)||"-"})]})]});return e.jsxs(M,{children:[e.jsx(O,{title:"Details"}),e.jsxs(a,{sx:{px:3},children:[e.jsx(X,{children:n==null?void 0:n.map(c=>e.jsxs(a,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:r=>`dashed 2px ${r.palette.background.neutral}`},children:[e.jsx(E,{src:c.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(N,{primary:c.name,secondary:c.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(d,{sx:{typography:"body2"},children:["x",c.quantity]}),e.jsx(d,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:D(c.price)})]},c.id))}),h]})]})}ze.propTypes={discount:s.number,items:s.array,shipping:s.number,subTotal:s.number,taxes:s.number,totalAmount:s.number};function _e({status:n,backLink:o,createdAt:y,orderNumber:l,statusOptions:u,onChangeStatus:m}){const h=J();return e.jsxs(e.Fragment,{children:[e.jsxs(a,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(P,{component:Ie,href:o,children:e.jsx(p,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(a,{spacing:.5,children:[e.jsxs(a,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs($,{variant:"h4",children:[" Order ",l," "]}),e.jsx(q,{variant:"soft",color:n==="completed"&&"success"||n==="pending"&&"warning"||n==="cancelled"&&"error"||"default",children:n})]}),e.jsx($,{variant:"body2",sx:{color:"text.disabled"},children:ke(y)})]})]}),e.jsxs(a,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(k,{color:"inherit",variant:"outlined",endIcon:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"}),onClick:h.onOpen,sx:{textTransform:"capitalize"},children:n}),e.jsx(k,{color:"inherit",variant:"outlined",startIcon:e.jsx(p,{icon:"solar:printer-minimalistic-bold"}),children:"Print"}),e.jsx(k,{color:"inherit",variant:"contained",startIcon:e.jsx(p,{icon:"solar:pen-bold"}),children:"Edit"})]})]}),e.jsx(K,{open:h.open,onClose:h.onClose,arrow:"top-right",sx:{width:140},children:u.map(c=>e.jsx(F,{selected:c.value===n,onClick:()=>{h.onClose(),m(c.value)},children:c.label},c.value))})]})}_e.propTypes={backLink:s.string,createdAt:s.instanceOf(Date),onChangeStatus:s.func,orderNumber:s.string,status:s.string,statusOptions:s.array};export{Qe as O,_e as a,ze as b,Ue as c};
