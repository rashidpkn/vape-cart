import{a4 as n,j as e,bv as Ae,bw as Be,bp as we,aW as F,az as Te,bx as Ie,by as De,ay as be,aB as Ee,aC as k,bz as te,bA as ie,aD as Re,aG as qe,p as ze,aY as p,g as h,aN as G,aR as Q,S as D,bB as R,aO as C,aH as O,bC as Le,bD as Ne,bE as ne,bF as de,bG as le,bH as J,bI as xe,B as E,b0 as Ve,bJ as Ge,b3 as je,b4 as c,b2 as Oe,aF as Me,aI as me,aL as Ue,bK as Pe,bL as pe}from"./index-519398e3.js";let ue=!1;const he=n.forwardRef(function(o,A){return ue||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),ue=!0),e.jsx(Ae,Be({ref:A},o))}),Ke=["Simple","Variable"],He=["Disposables","Vape Liquids","Salt Nicotine","Accessories",,"Vape Devices","Pod Systems","Nicotine Pouches","Pods & Coils","Batteries","Tanks","Others"],$e=["New Collection","Limited Edition","Bestseller","Exclusive","Hot Deal","Trending Now","Seasonal Special","Eco-Friendly","On Sale","Clearance","Customer Favorite","Top Rated","Holiday Special","Gift Ideas","Must-Have","Limited Stock","Featured Product","Editor's Pick","Just Arrived","Back in Stock","Special Offer","Staff Picks","Flash Sale","Popular Choice","Best Value"],Ye=["SMOK","Vaporesso","GeekVape","Voopoo","Innokin","Uwell","Aspire","Eleaf","Lost Vape","Joyetech","Wismec","Freemax","Suorin","iJoy","Rincoe","Augvape","Vandy Vape","OBS","Hellvape","Teslacigs","Artery","Dovpo","Vaptio","Kangertech","Digiflavor","Sigelei","Smoant","Pioneer4You","Vapor Storm","Hugo Vapor"],_e=["Bottle Size","Puffs","Flavour","Nicotine Strength","Color","Batteries"],u={bottleSize:[10,15,30,50,60,100,120].map(s=>`${s} ml`),puffs:[500,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6500,7e3,7500,8e3,8500,9e3,9500,1e4].map(s=>`${s} puffs`),flavour:["Strawberry","Blueberry","Raspberry","Watermelon","Apple","Peach","Pineapple","Grape","Mango","Kiwi","Cherry","Banana","Lemon","Lime","Orange","Mixed Berries","Menthol","Peppermint","Spearmint","Ice Menthol","Minty Menthol","Cool Mint","Traditional Tobacco","American Blend","Virginia Tobacco","Turkish Tobacco","Cuban Cigar","Pipe Tobacco","Vanilla Custard","Chocolate Cake","Caramel","Butterscotch","Cheesecake","Tiramisu","Maple Syrup","Cookies and Cream","Pudding","Ice Cream","Bubblegum","Cotton Candy","Gummy Bear","Candy Cane","Marshmallow","Rock Candy","Toffee","Coffee","Cappuccino","Espresso","Latte","Cola","Energy Drink","Mojito","Lemonade","Iced Tea","Smoothie","Creamy Vanilla","Strawberry Cream","Coconut Cream","Hazelnut Cream","Irish Cream","Sugar Cookie","Blueberry Muffin","Donut","Pancake","Waffle","Pie Crust","Sour Apple","Sour Watermelon","Sour Cherry","Sour Lemon","Almond","Hazelnut","Peanut Butter","Pistachio","Walnut","Cinnamon","Clove","Gingerbread","Green Tea","Chamomile","Lavender","Eucalyptus"],nicotineStrength:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50].map(s=>`${s} mg`),color:["Black","Silver","White","Blue","Red","Green","Pink","Purple","Gold","Rainbow/Multicolor","Gunmetal/Gray","Yellow","Orange","Brown","Clear/Transparent"],batteries:["Single","Dual","Built-in","Triple","Quad"]};function Qe({currentProduct:s}){const o=we(),[A,M]=n.useState(!1),[U,X]=n.useState([]);n.useEffect(()=>{F.get("/attributes").then(a=>{X(a.data)})},[]);const f=Te(),g=Ie("up","md"),{enqueueSnackbar:oe}=De(),{user:x}=be(),q=Ee().shape({name:k().required("Name is required"),subDescription:k().required("Short description is required").test("not-four-digits","Your content contain continues 7 digit number, Please remove",a=>!/\d{7,}/.test(a)).test("no-at-symbol",'Your content contains the "@" symbol. Please remove it.',a=>!/@/.test(a)),content:k().test("not-four-digits","Your content contain continues 7 digit number, Please remove",a=>!/\d{7,}/.test(a)).test("no-at-symbol",'Your content contains the "@" symbol. Please remove it.',a=>!/@/.test(a)),images:te().min(1,"Image is required"),type:k(),category:k().required("Category is required"),tags:te(),SKU:k().required("SKU is required"),brand:k().required("brand is required"),attributes:te(),quantity:ie().required("Quantity is required"),regularPrice:ie().moreThan(0,"Price should not be AED 0.00"),salePrice:ie()}),B=n.useMemo(()=>({id:(s==null?void 0:s.id)||"",name:(s==null?void 0:s.name)||"",subDescription:(s==null?void 0:s.subDescription)||"",content:(s==null?void 0:s.content)||"",images:(s==null?void 0:s.images)||[],type:(s==null?void 0:s.type)||"Simple",category:(s==null?void 0:s.category)||"Disposables",tags:(s==null?void 0:s.tags)||[],SKU:(s==null?void 0:s.SKU)||"",brand:(s==null?void 0:s.brand)||"SMOK",attributes:(s==null?void 0:s.attributes)||[],quantity:(s==null?void 0:s.quantity)||null,regularPrice:(s==null?void 0:s.regularPrice)||0,salePrice:(s==null?void 0:s.salePrice)||0}),[s]),[b,w]=n.useState({}),[T,P]=n.useState([]),K=Re({resolver:qe(q),defaultValues:B}),{reset:z,watch:L,setValue:d,handleSubmit:H,formState:{isSubmitting:N,isValid:I}}=K,r=L(),[j,V]=n.useState([]),$=n.useCallback(async()=>{const{data:a}=await F.get("/products",{params:{name:r.name,productGroup:"parent"}});V(a.products)},[r.name]);n.useEffect(()=>{$()},[r.name]),n.useEffect(()=>{s&&z(B)},[s,B,z]);const Z=H(async a=>{console.log(a);try{s?await F.patch("products",{...a,username:x.displayName,userId:x.id,storeName:x.storeName}):await F.post("products",{...a,username:x.displayName,userId:x.id,storeName:x.storeName}),z(),oe(s?"Update success!":"Create success!"),f.push(ze.dashboard.product.root)}catch(t){console.log(t)}}),ee=n.useCallback(a=>{const t=r.images||[],i=a.map(l=>Object.assign(l,{preview:URL.createObjectURL(l)}));d("images",[...t,...i],{shouldValidate:!0})},[d,r.images]),ae=n.useCallback(a=>{var i;const t=r.images&&((i=r.images)==null?void 0:i.filter(l=>l!==a));d("images",t)},[d,r.images]),m=n.useCallback(()=>{d("images",[])},[d]),S=e.jsxs(e.Fragment,{children:[g&&e.jsxs(p,{md:4,children:[e.jsx(h,{variant:"h6",sx:{mb:.5},children:"Details"}),e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Title, short description, image..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(G,{children:[!g&&e.jsx(Q,{title:"Details"}),e.jsxs(D,{spacing:3,sx:{p:3},children:[e.jsx(he,{onChange:(a,t)=>{if(t){const i=j.find(l=>l.name===t);i&&(d("images",i.images),d("name",i.name),d("category",i.category),d("brand",i.brand),d("type",i.type))}else d("images",null)},name:"name",label:"Product Name",options:j.map(a=>a.name),getOptionLabel:a=>a,isOptionEqualToValue:(a,t)=>a===t.value,renderInput:a=>e.jsx(R,{...a,label:"Product Name",value:r.name,onChange:t=>d("name",t.target.value)}),renderOption:(a,t)=>e.jsxs(C,{component:"li",sx:{"& > img":{mr:2,flexShrink:0}},...a,children:[e.jsx("img",{loading:"lazy",width:"20",src:j.find(i=>i.name===t).images[0],alt:""}),t]}),freeSolo:!0}),e.jsx(O,{name:"subDescription",label:"Sub Description",multiline:!0,rows:4}),e.jsxs(D,{spacing:1.5,children:[e.jsx(h,{variant:"subtitle2",children:"Content"}),e.jsx(Le,{simple:!0,name:"content"})]}),e.jsxs(D,{spacing:1.5,children:[e.jsx(h,{variant:"subtitle2",children:"Images"}),e.jsx(Ne,{multiple:!0,name:"images",maxSize:3145728,onDrop:ee,onRemove:ae,onRemoveAll:m,onUpload:async a=>{try{const t=new FormData;r.images.forEach(l=>{t.append("images",l)});const{data:i}=await F.post("upload",t);d("images",i),alert("Image upload complete.")}catch{alert(" Image upload failed, try again.")}}})]})]})]})})]}),[y,Y]=n.useState({name:"",show:!1}),ye=e.jsxs(e.Fragment,{children:[g&&e.jsxs(p,{md:4,children:[e.jsx(h,{variant:"h6",sx:{mb:.5},children:"Key Properties"}),e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Additional functions and attributes..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(G,{children:[!g&&e.jsx(Q,{title:"Properties"}),e.jsx(D,{spacing:3,sx:{p:3},children:e.jsxs(C,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(ne,{native:!0,name:"type",label:"Product Type",InputLabelProps:{shrink:!0},children:Ke.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx(ne,{native:!0,name:"category",label:"Category",InputLabelProps:{shrink:!0},children:He.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx(de,{name:"tags",label:"Tags",placeholder:"+ Tags",multiple:!0,freeSolo:!0,options:$e.map(a=>a),getOptionLabel:a=>a,renderOption:(a,t)=>n.createElement("li",{...a,key:t},t),renderTags:(a,t)=>a.map((i,l)=>n.createElement(le,{...t({index:l}),key:i,label:i,size:"small",color:"info",variant:"soft"}))}),e.jsx(O,{name:"SKU",label:"Product SKU"}),e.jsx(ne,{native:!0,name:"brand",label:"Brand",InputLabelProps:{shrink:!0},children:Ye.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs(C,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(J,{sx:{width:190},label:"Is your brand missing? Click here to add it.",control:e.jsx(xe,{checked:y.show,onChange:a=>Y(t=>({...t,show:a.target.checked}))})}),y.show&&e.jsxs(e.Fragment,{children:[e.jsx(R,{label:"Brand Name",style:{width:300},onChange:a=>Y(t=>({...t,name:a.target.value})),value:y.name}),e.jsx(E,{variant:"contained",color:"success",onClick:()=>{y.name?alert("Your request to create a new brand is being processed. Please wait while we verify the brand."):alert("Please enter brand name")},children:"Add Brand"})]})]})]})})]})})]}),fe=(a,t,i)=>{w(W=>({...W,[i]:t}));const l=i==="Bottle Size"&&u.bottleSize||i==="Puffs"&&u.puffs||i==="Flavour"&&u.flavour||i==="Nicotine Strength"&&u.nicotineStrength||i==="Color"&&u.color||i==="Batteries"&&u.batteries||[],v=t[t.length-1];v&&(l.find(W=>W===v)||(console.log("upload"),F.post("/attributes",{username:x.displayName,attribute:i,value:v}).then(W=>{console.log("updated")})))},Se=e.jsxs(e.Fragment,{children:[g&&e.jsxs(p,{md:4,children:[e.jsx(h,{variant:"h6",sx:{mb:.5},children:"Product Attributes"}),e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Additional functions and attributes..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(G,{children:[!g&&e.jsx(Q,{title:"Attributes"}),e.jsx(D,{spacing:3,sx:{p:3},children:e.jsxs(C,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(C,{sx:{gridColumn:"span 2 "},children:e.jsx(de,{name:"attributes",label:"Attributes",placeholder:"+ Attributes",multiple:!0,options:_e.map(a=>a),getOptionLabel:a=>a,renderOption:(a,t)=>n.createElement("li",{...a,key:t},t),renderTags:(a,t)=>a.map((i,l)=>n.createElement(le,{...t({index:l}),key:i,label:i,size:"small",color:"info",variant:"soft"}))})}),r.attributes.map(a=>e.jsx(C,{sx:{gridColumn:"span 1 "},children:e.jsx(he,{multiple:!0,freeSolo:!0,options:[...a==="Bottle Size"?u.bottleSize:[],...a==="Puffs"?u.puffs:[],...a==="Flavour"?u.flavour:[],...a==="Nicotine Strength"?u.nicotineStrength:[],...a==="Color"?u.color:[],...a==="Batteries"?u.batteries:[],...U.filter(t=>t.attribute===a).map(t=>t.value)],value:b[a],onChange:(t,i)=>{fe(t,i,a),i.length>=2?T.find(l=>l===a)||P(l=>[...l,a]):P(l=>l.filter(v=>v!==a))},renderInput:t=>e.jsx(R,{...t,label:a,placeholder:a}),renderTags:(t,i)=>t.map((l,v)=>n.createElement(le,{...i({index:v}),key:l,label:l,size:"small",color:"info",variant:"soft"}))})},a))]})})]})})]}),Ce=e.jsxs(e.Fragment,{children:[g&&e.jsxs(p,{md:4,children:[e.jsx(h,{variant:"h6",sx:{mb:.5},children:"Pricing"}),e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Price related inputs"})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(G,{children:[!g&&e.jsx(Q,{title:"Pricing"}),e.jsxs(D,{spacing:3,sx:{p:3},children:[e.jsx(O,{name:"quantity",label:"Quantity",placeholder:"0.00",type:"number",InputLabelProps:{shrink:!0}}),e.jsx(O,{name:"regularPrice",label:"Regular Price",placeholder:"0.00",type:"number",InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(C,{component:"span",sx:{color:"text.disabled"},children:"AED"})})}}),e.jsx(O,{name:"salePrice",label:"Sale Price",placeholder:"0.00",type:"number",InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(C,{component:"span",sx:{color:"text.disabled"},children:"AED"})})}})]})]})})]}),Fe=e.jsx(e.Fragment,{children:e.jsx(p,{xs:12,md:8,sx:{display:"flex",alignItems:"center"},children:e.jsx(Ue,{type:"submit",variant:"contained",size:"large",loading:N,children:s?"Save Changes":"Create Product"})})}),ve=e.jsx(e.Fragment,{children:e.jsx(p,{xs:12,md:8,sx:{display:"flex",alignItems:"center"},children:e.jsx(E,{variant:"contained",size:"large",onClick:()=>{o("/dashboard/product")},children:"Save Product"})})}),se=["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],re=[...se,...se.slice(1).flatMap(a=>se.slice(1).map(t=>a+t))];let _=1,ce=0;const ke=e.jsxs(e.Fragment,{children:[g&&e.jsx(p,{md:4,children:e.jsx(h,{variant:"h6",sx:{mb:.5},children:"Variation Table"})}),e.jsx(p,{xs:12,md:12,children:e.jsx(G,{children:e.jsxs(Ve,{children:[e.jsx(Ge,{children:e.jsxs(je,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{width:150,children:"SKU"}),e.jsx(c,{width:250,children:"Attributes"}),e.jsx(c,{width:150,children:"Track Stock"}),e.jsx(c,{children:"Stock"}),e.jsx(c,{children:"Regular Price"}),e.jsx(c,{children:"Sales Price"}),e.jsx(c,{children:"Image"}),e.jsx(c,{width:200,children:"Add Product"})]})}),e.jsxs(Oe,{children:[e.jsx(ge,{counter:_++,counter2:ce++,skuAlpha:re,va:"Parent",values:r,variables:b,disabled:!0,isSubmitting:N,isValid:I,setProductAdded:()=>{}},_),Object.keys(b).reduce((a,t)=>a.flatMap(i=>b[t].map(l=>`${i} - ${l}`)),[""]).map(a=>e.jsx(ge,{counter:_++,counter2:ce++,skuAlpha:re,va:a.slice(3),values:r,variables:b,disabled:!1,isSubmitting:N,isValid:I,setProductAdded:M},_))]})]})})})]});return e.jsx(Me,{methods:K,onSubmit:Z,children:e.jsxs(p,{container:!0,spacing:3,children:[S,ye,r.type==="Variable"&&Se,r.type==="Simple"&&Ce,r.type==="Variable"&&ke,r.type==="Simple"&&Fe,r.type==="Variable"&&A&&ve]})})}function ge({counter:s,values:o,skuAlpha:A,counter2:M,va:U,variables:X,disabled:f,isSubmitting:g,isValid:oe,setProductAdded:x}){const{user:q}=be(),B=A[M]?`${o.SKU}-${A[M]}`:o.SKU;let b=o.name;const w=U==="Parent";w||(b=`${o.name} - ${U}`);const[T,P]=n.useState(!0),[K,z]=n.useState("instock"),[L,d]=n.useState(null),[H,N]=n.useState(null),[I,r]=n.useState(null),[j,V]=n.useState("pending"),[$,Z]=n.useState(null),ee=async m=>{try{const S=new FormData;S.append("images",m.target.files[0]);const{data:y}=await F.post("upload",S);Z([y[0],...o.images])}catch{}},ae=async()=>{const m=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{2B50}\u{2B55}\u{231A}-\u{231B}\u{23E9}-\u{23EC}\u{23F0}\u{23F3}\u{25AA}-\u{25AB}\u{25B6}\u{25C0}\u{25FB}-\u{25FE}\u{2B1B}-\u{2B1C}\u{2934}-\u{2935}\u{2B05}-\u{2B07}\u{2194}-\u{2199}\u{21A9}-\u{21AA}\u{2B06}\u{2B07}\u{2B1B}\u{2B1C}]/u,S=/\d{7,}/,y=/@/;if(m.test(o.subDescription)||m.test(o.content)){alert("Your content contain emojis, Please remove emojis");return}if(S.test(o.subDescription)||S.test(o.content)){alert("Your content contain continues 7 digit number, Please remove");return}if(y.test(o.subDescription)||y.test(o.content)){alert('Your content contains the "@" symbol. Please remove it.');return}if(!w){if(!$)return alert("Child image is required.");if(!I)return alert("Quantity is required.");if(!L)return alert("Regular price is required.")}if(j==="pending"){V("loading");try{await F.post("/products",{username:q.displayName,userId:q.id,storeName:q.storeName,name:b,subDescription:o.subDescription,content:o.content,images:$??o.images,type:o.type,category:o.category,tags:o.tags,parentSku:o.SKU,brand:o.brand,attributes:o.attributes,variables:X,SKU:B,track:T,quantity:I,regularPrice:L,salePrice:H,productGroup:w?"parent":"child"}),V("success"),x(!0)}catch(Y){console.log(`Product Creation failed :${Y}`),V("failed")}}};return e.jsxs(je,{style:{backgroundColor:f&&"rgba(0,0,0,0.1)"},children:[e.jsx(c,{children:s}),e.jsx(c,{children:B}),e.jsx(c,{children:w?b+" - Parent":b}),e.jsx(c,{children:e.jsx(J,{label:"",control:e.jsx(xe,{checked:T,onChange:m=>P(m.target.checked),disabled:f})})}),e.jsxs(c,{children:[T&&e.jsx(R,{disabled:f,size:"small",label:"Quantity",type:"number",onChange:m=>r(+m.target.value||null),value:I}),!T&&e.jsxs(Pe,{"aria-label":"Stock",name:"Stock",value:K,onChange:m=>z(m.target.value),children:[e.jsx(J,{value:"instock",control:e.jsx(pe,{}),label:"Instock"}),e.jsx(J,{value:"outstock",control:e.jsx(pe,{}),label:"Outstock"})]})]}),e.jsx(c,{children:e.jsx(R,{disabled:f,size:"small",label:"Price",type:"number",onChange:m=>d(+m.target.value||null),value:L})}),e.jsx(c,{children:e.jsx(R,{disabled:f,size:"small",label:"Price",type:"number",onChange:m=>N(+m.target.value||null),value:H})}),e.jsx(c,{children:e.jsx("input",{size:"small",label:"Image",type:"file",onChange:ee,disabled:f})}),e.jsxs(c,{children:[j==="pending"&&!0&&e.jsx(E,{color:"success",variant:"contained",size:"small",onClick:ae,type:"submit",children:"Add Product"}),j==="loading"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Loading"}),j==="success"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Product Created"}),j==="failed"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Product creation failed"})]})]})}export{Qe as P};
