import{b_ as K,D as b,af as e,bs as X,ao as k,d4 as Y,aY as R,c_ as B,az as j,aw as T,aq as r,bi as I,bx as z,aR as U,bg as ee,bJ as O,aW as F,by as W,au as S,c5 as se,c6 as oe,c7 as ae,c8 as le,aX as ne,bm as te,aQ as ie,aN as re,bv as de,bj as ce,ay as q,aB as me,ax as he,aI as pe,aK as xe,am as ue,aL as be,aU as je,cZ as ge,bp as fe,bz as we,bA as Ce,bB as ye}from"./index-82d16c62.js";import{C as _}from"./confirm-dialog-1f628faf.js";import{C as Pe}from"./custom-breadcrumbs-4b259898.js";import{u as Re,g as Te,e as Se}from"./use-table-4f1e3953.js";import{T as ve,a as P,c as ke,b as Fe,e as Ae,f as De,d as qe}from"./table-pagination-custom-1f586a21.js";import{c as Ee,a as w,b as Ie,F as Ne,h as Be,R as C,j as Le}from"./form-provider-a0198d79.js";import{L as ze,o as Oe}from"./yup-e2cd789f.js";import{D as We,a as _e}from"./DialogTitle-2fcff7d2.js";import{D as He}from"./DialogContent-2aab4637.js";import{A as Ve}from"./Alert-fda188b5.js";import{C as H}from"./Checkbox-7ab06dbc.js";import{C as L}from"./Chip-af4a5d0d.js";import{T as $e,a as Ge,b as Qe}from"./TableContainer-321e58c6.js";import"./format-number-2839d534.js";import"./Switch-372b9d12.js";import"./transition-bee6630b.js";import"./image-5ef12a9c.js";import"./Autocomplete-997a241b.js";import"./Close-2669a4e4.js";import"./CircularProgress-e7ce1de5.js";function V({currentUser:s,open:i,onClose:d}){const{enqueueSnackbar:t}=K(),n=Ee().shape({name:w().required("Name is required"),email:w().required("Email is required").email("Email must be a valid email address"),phoneNumber:w().required("Phone number is required"),address:w().required("Address is required"),country:w().required("Country is required"),company:w().required("Company is required"),state:w().required("State is required"),city:w().required("City is required"),role:w().required("Role is required")}),h=b.useMemo(()=>({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phoneNumber:(s==null?void 0:s.phoneNumber)||"",address:(s==null?void 0:s.address)||"",country:(s==null?void 0:s.country)||"",state:(s==null?void 0:s.state)||"",city:(s==null?void 0:s.city)||"",zipCode:(s==null?void 0:s.zipCode)||"",status:s==null?void 0:s.status,company:(s==null?void 0:s.company)||"",role:(s==null?void 0:s.role)||""}),[s]),l=Ie({resolver:Oe(n),defaultValues:h}),{reset:a,handleSubmit:u,formState:{isSubmitting:c}}=l,y=u(async p=>{try{await new Promise(g=>setTimeout(g,500)),a(),d(),t("Update success!"),console.info("DATA",p)}catch(g){console.error(g)}});return e.jsx(X,{fullWidth:!0,maxWidth:!1,open:i,onClose:d,PaperProps:{sx:{maxWidth:720}},children:e.jsxs(Ne,{methods:l,onSubmit:y,children:[e.jsx(We,{children:"Quick Update"}),e.jsxs(He,{children:[e.jsx(Ve,{variant:"outlined",severity:"info",sx:{mb:3},children:"Account is waiting for confirmation"}),e.jsxs(k,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(Be,{name:"status",label:"Status",children:Y.map(p=>e.jsx(R,{value:p.value,children:p.label},p.value))}),e.jsx(k,{sx:{display:{xs:"none",sm:"block"}}}),e.jsx(C,{name:"name",label:"Full Name"}),e.jsx(C,{name:"email",label:"Email Address"}),e.jsx(C,{name:"phoneNumber",label:"Phone Number"}),e.jsx(Le,{name:"country",label:"Country",options:B.map(p=>p.label),getOptionLabel:p=>p,renderOption:(p,g)=>{const{code:f,label:m,phone:A}=B.filter(D=>D.label===g)[0];return m?b.createElement("li",{...p,key:m},e.jsx(j,{icon:`circle-flags:${f.toLowerCase()}`,width:28,sx:{mr:1}},m),m," (",f,") +",A):null}}),e.jsx(C,{name:"state",label:"State/Region"}),e.jsx(C,{name:"city",label:"City"}),e.jsx(C,{name:"address",label:"Address"}),e.jsx(C,{name:"zipCode",label:"Zip/Code"}),e.jsx(C,{name:"company",label:"Company"}),e.jsx(C,{name:"role",label:"Role"})]})]}),e.jsxs(_e,{children:[e.jsx(T,{variant:"outlined",onClick:d,children:"Cancel"}),e.jsx(ze,{type:"submit",variant:"contained",loading:c,children:"Update"})]})]})})}V.propTypes={currentUser:r.object,onClose:r.func,open:r.bool};function $({row:s,selected:i,onEditRow:d,onSelectRow:t,onDeleteRow:n}){const{displayName:h,avatarUrl:l,storeName:a,tradeLicense:u,contactPersonInTouch:c,email:y,phoneNumber:p}=s,g=I(),f=I(),m=z();return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{hover:!0,selected:i,children:[e.jsx(P,{padding:"checkbox",children:e.jsx(H,{checked:i,onClick:t})}),e.jsxs(P,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(U,{alt:h,src:l,sx:{mr:2}}),e.jsx(ee,{primary:h,secondary:y,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:p}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:a}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:e.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",children:e.jsx(T,{children:"View Trade Licence"})})}),e.jsx(P,{children:c}),e.jsxs(P,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(O,{title:"Quick Edit",placement:"top",arrow:!0,children:e.jsx(F,{color:f.value?"inherit":"default",onClick:f.onTrue,children:e.jsx(j,{icon:"solar:pen-bold"})})}),e.jsx(F,{color:m.open?"inherit":"default",onClick:m.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})]})]}),e.jsx(V,{currentUser:s,open:f.value,onClose:f.onFalse}),e.jsxs(W,{open:m.open,onClose:m.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(R,{onClick:()=>{g.onTrue(),m.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),e.jsxs(R,{onClick:()=>{d(),m.onClose()},children:[e.jsx(j,{icon:"solar:pen-bold"}),"Edit"]})]}),e.jsx(_,{open:g.value,onClose:g.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(T,{variant:"contained",color:"error",onClick:n,children:"Delete"})})]})}$.propTypes={onDeleteRow:r.func,onEditRow:r.func,onSelectRow:r.func,row:r.object,selected:r.bool};function G({filters:s,onFilters:i,roleOptions:d}){const t=z(),n=b.useCallback(l=>{i("name",l.target.value)},[i]),h=b.useCallback(l=>{i("role",typeof l.target.value=="string"?l.target.value.split(","):l.target.value)},[i]);return e.jsxs(e.Fragment,{children:[e.jsxs(S,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsxs(se,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(oe,{children:"Role"}),e.jsx(ae,{multiple:!0,value:s.role,onChange:h,input:e.jsx(le,{label:"Role"}),renderValue:l=>l.map(a=>a).join(", "),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:d.map(l=>e.jsxs(R,{value:l,children:[e.jsx(H,{disableRipple:!0,size:"small",checked:s.role.includes(l)}),l]},l))})]}),e.jsxs(S,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[e.jsx(ne,{fullWidth:!0,value:s.name,onChange:n,placeholder:"Search...",InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(F,{onClick:t.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})]})]}),e.jsxs(W,{open:t.open,onClose:t.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(R,{onClick:()=>{t.onClose()},children:[e.jsx(j,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),e.jsxs(R,{onClick:()=>{t.onClose()},children:[e.jsx(j,{icon:"solar:import-bold"}),"Import"]}),e.jsxs(R,{onClick:()=>{t.onClose()},children:[e.jsx(j,{icon:"solar:export-bold"}),"Export"]})]})]})}G.propTypes={filters:r.object,onFilters:r.func,roleOptions:r.array};function Q({filters:s,onFilters:i,onResetFilters:d,results:t,...n}){const h=()=>{i("status","all")},l=a=>{const u=s.role.filter(c=>c!==a);i("role",u)};return e.jsxs(S,{spacing:1.5,...n,children:[e.jsxs(k,{sx:{typography:"body2"},children:[e.jsx("strong",{children:t}),e.jsx(k,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(S,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[s.status!=="all"&&e.jsx(N,{label:"Status:",children:e.jsx(L,{size:"small",label:s.status,onDelete:h})}),!!s.role.length&&e.jsx(N,{label:"Role:",children:s.role.map(a=>e.jsx(L,{label:a,size:"small",onDelete:()=>l(a)},a))}),e.jsx(T,{color:"error",onClick:d,startIcon:e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}Q.propTypes={filters:r.object,onFilters:r.func,onResetFilters:r.func,results:r.number};function N({label:s,children:i,sx:d,...t}){return e.jsxs(S,{component:ie,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...d},...t,children:[e.jsx(k,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(S,{spacing:1,direction:"row",flexWrap:"wrap",children:i})]})}N.propTypes={children:r.node,label:r.string,sx:r.object};const Me=[{id:"name",label:"Name"},{id:"phoneNumber",label:"Phone Number",width:180},{id:"Address",label:"Address",width:120},{id:"Purchase Times",label:"Purchase Times",width:180},{id:"Purchase Amount",label:"Purchase Amount",width:220},{id:"",width:88}],E={name:"",role:[],status:"All"};function us(){const s=Re(),i=re(),d=de(),t=I(),[n,h]=b.useState([]),l=async()=>{const o=await we(Ce(ye,"users")),x=[];o.forEach(v=>{x.push(v.data())}),console.log(x),h(x)};b.useEffect(()=>{l()},[]);const[a,u]=b.useState(E),c=Ze({inputData:n,comparator:Te(s.order,s.orderBy),filters:a}),y=c.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),p=s.dense?52:72,g=!ce(E,a),f=!c.length&&g||!c.length,m=b.useCallback((o,x)=>{s.onResetPage(),u(v=>({...v,[o]:x}))},[s]),A=b.useCallback(o=>{const x=n.filter(v=>v.id!==o);h(x),s.onUpdatePageDeleteRow(y.length)},[y.length,s,n]),D=b.useCallback(()=>{const o=n.filter(x=>!s.selected.includes(x.id));h(o),s.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:y.length,totalRowsFiltered:c.length})},[c.length,y.length,s,n]),M=b.useCallback(o=>{d.push(q.dashboard.user.edit(o))},[d]),Z=b.useCallback((o,x)=>{m("status",x)},[m]),J=b.useCallback(()=>{u(E)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(me,{maxWidth:i.themeStretch?!1:"lg",children:[e.jsx(Pe,{heading:"Customer",links:[{name:"Dashboard",href:q.dashboard.root},{name:"Customer",href:"/dashboard/customer"}],action:e.jsx(T,{component:he,href:q.dashboard.user.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New User"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(pe,{children:[e.jsx(xe,{value:a.status,onChange:Z,sx:{px:2.5,boxShadow:o=>`inset 0 -2px 0 0 ${ue(o.palette.grey[500],.08)}`},children:["All","VIP","Recurring Customer","Blacklisted"].map(o=>e.jsx(be,{style:{color:`${o==="Blacklisted"&&"#f00"}`},iconPosition:"end",value:o,label:o,icon:e.jsxs(je,{variant:(o==="all"||o===a.status)&&"filled"||"soft",children:[o==="all"&&n.length,o!=="all"&&0]})},o))}),e.jsx(G,{filters:a,onFilters:m,roleOptions:ge}),g&&e.jsx(Q,{filters:a,onFilters:m,onResetFilters:J,results:c.length,sx:{p:2.5,pt:0}}),e.jsxs($e,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(ke,{dense:s.dense,numSelected:s.selected.length,rowCount:n.length,onSelectAllRows:o=>s.onSelectAllRows(o,n.map(x=>x.id)),action:e.jsx(O,{title:"Delete",children:e.jsx(F,{color:"primary",onClick:t.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(fe,{children:e.jsxs(Ge,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Fe,{order:s.order,orderBy:s.orderBy,headLabel:Me,rowCount:n.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:o=>s.onSelectAllRows(o,n.map(x=>x.id))}),e.jsxs(Qe,{children:[[].slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(o=>e.jsx($,{row:o,selected:s.selected.includes(o.id),onSelectRow:()=>s.onSelectRow(o.id),onDeleteRow:()=>A(o.id),onEditRow:()=>M(o.id)},o.id)),e.jsx(Ae,{height:p,emptyRows:Se(s.page,s.rowsPerPage,n.length)}),e.jsx(De,{notFound:f})]})]})})]}),e.jsx(qe,{count:c.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,dense:s.dense,onChangeDense:s.onChangeDense})]})]}),e.jsx(_,{open:t.value,onClose:t.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",s.selected.length," "]})," items?"]}),action:e.jsx(T,{variant:"contained",color:"error",onClick:()=>{D(),t.onFalse()},children:"Delete"})})]})}function Ze({inputData:s,comparator:i,filters:d}){const{name:t,status:n,role:h}=d,l=s.map((a,u)=>[a,u]);return l.sort((a,u)=>{const c=i(a[0],u[0]);return c!==0?c:a[1]-u[1]}),s=l.map(a=>a[0]),t&&(s=s.filter(a=>a.name.toLowerCase().indexOf(t.toLowerCase())!==-1)),n!=="all"&&(s=s.filter(a=>a.status===n)),h.length&&(s=s.filter(a=>h.includes(a.role))),s}export{us as default};
