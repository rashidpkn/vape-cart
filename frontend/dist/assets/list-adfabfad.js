import{ab as q,aU as z,b5 as M,b6 as $,aw as G,F as n,aA as m,b2 as g,j as e,B as J,aF as K,af as D,ag as C,S,ak as Q,b3 as X,ad as Y,b4 as Z,ar as ee,bs as te,b8 as ae,b0 as b,b1 as x,am as j,ah as oe,ai as se,aj as le,bp as ne,bq as re,b9 as ie,al as ce,W as de}from"./index-e61873f4.js";import{C as ue}from"./confirm-dialog-f277fc12.js";import{u as he,e as pe}from"./use-table-f7e7ec02.js";import{I as i,a as me,b as ge,c as be}from"./invoice-details-9f758a3a.js";import{T as xe}from"./TableContainer-b5d08a01.js";import"./DialogTitle-1e40d1c0.js";import"./DialogContent-fbc4aa5e.js";import"./CircularProgress-b9b8bfaa.js";import"./custom-date-range-picker-976ebb83.js";import"./form-provider-be07018e.js";import"./Switch-d09f8cc6.js";import"./transition-bee6630b.js";import"./image-d4e5cc28.js";import"./yup-d78f85a8.js";import"./address-list-dialog-16f54711.js";const je=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"status",label:"Status"},{id:""}],T={name:"",service:[],status:"all",startDate:null,endDate:null};function ve(){const r=q();z();const c=M(),a=he({defaultOrderBy:"createDate"}),d=$(),{user:{id:y}}=G(),[w,I]=n.useState([]),[f,F]=n.useState([]),[o,v]=n.useState([]),A=async()=>{try{const{data:{products:t}}=await m.get("products",{params:{userId:y,perPage:100}});F(t.map(s=>s.id))}catch{alert("Error occurred while fetching products.")}},E=async()=>{try{const{data:t}=await m.get("invoice");I(t)}catch{}};n.useEffect(()=>{E(),A()},[]),n.useEffect(()=>{v(w.filter(t=>t.items.some(s=>f.includes(s.id))).reverse())},[w,f]);const[l,P]=n.useState(T),k=l.startDate&&l.endDate?l.startDate.getTime()>l.endDate.getTime():!1,B=a.dense?56:76,R=!!l.name||!!l.service.length||l.status!=="all"||!!l.startDate&&!!l.endDate,L=!o.length&&R||!o.length,u=t=>o.filter(s=>s.status===t).length,O=[{value:"all",label:"All",color:"default",count:o.length},{value:"paid",label:"Paid",color:"success",count:u("paid")},{value:"pending",label:"Pending",color:"warning",count:u("pending")},{value:"overdue",label:"Overdue",color:"error",count:u("overdue")},{value:"draft",label:"Draft",color:"default",count:u("draft")}],h=n.useCallback((t,s)=>{a.onResetPage(),P(p=>({...p,[t]:s}))},[a]),V=n.useCallback(t=>{m.delete("invoice",{data:{id:t}}).then(p=>{alert("Invoice in deleted")});const s=o.filter(p=>p.id!==t);v(s),a.onUpdatePageDeleteRow(o.length)},[o.length,a,o]),N=n.useCallback(()=>{m.delete("invoice",{data:{id:a.selected}}).then(s=>{alert("Invoice in deleted")});const t=o.filter(s=>!a.selected.includes(s.id));v(t),a.onUpdatePageDeleteRows({totalRows:o.length,totalRowsInPage:o.length,totalRowsFiltered:o.length})},[o.length,o.length,a,o]),H=n.useCallback(t=>{c.push(g.dashboard.invoice.edit(t))},[c]),U=n.useCallback(t=>{c.push(g.dashboard.invoice.details(t))},[c]),_=n.useCallback((t,s)=>{h("status",s)},[h]),W=n.useCallback(()=>{P(T)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(J,{px:5,children:[e.jsx(K,{heading:"Invoice",links:[{name:"Dashboard",href:g.dashboard.root},{name:"Invoice",href:g.dashboard.invoice.root}],sx:{mb:{xs:3,md:5}}}),e.jsx(D,{sx:{mb:{xs:3,md:5}},children:e.jsx(C,{children:e.jsxs(S,{direction:"row",divider:e.jsx(Q,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[e.jsx(i,{title:"Total",total:0,percent:0,price:0,icon:"solar:bill-list-bold-duotone",color:r.palette.info.main}),e.jsx(i,{title:"Paid",total:0,percent:0,price:0,icon:"solar:file-check-bold-duotone",color:r.palette.success.main}),e.jsx(i,{title:"Pending",total:0,percent:0,price:0,icon:"solar:sort-by-time-bold-duotone",color:r.palette.warning.main}),e.jsx(i,{title:"Overdue",total:0,percent:0,price:0,icon:"solar:bell-bing-bold-duotone",color:r.palette.error.main}),e.jsx(i,{title:"Draft",total:0,percent:0,price:0,icon:"solar:file-corrupted-bold-duotone",color:r.palette.text.secondary})]})})}),e.jsxs(D,{children:[e.jsx(X,{value:l.status,onChange:_,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${Y(r.palette.grey[500],.08)}`},children:O.map(t=>e.jsx(Z,{value:t.value,label:t.label,iconPosition:"end",icon:e.jsx(ee,{variant:(t.value==="all"||t.value===l.status)&&"filled"||"soft",color:t.color,children:"0"})},t.value))}),e.jsx(me,{filters:l,onFilters:h,dateError:k,serviceOptions:te.map(t=>t.name)}),R&&e.jsx(ge,{filters:l,onFilters:h,onResetFilters:W,results:o.length,sx:{p:2.5,pt:0}}),e.jsxs(xe,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(ae,{dense:a.dense,numSelected:a.selected.length,rowCount:o.length,onSelectAllRows:t=>a.onSelectAllRows(t,o.map(s=>s.id)),action:e.jsxs(S,{direction:"row",children:[e.jsx(b,{title:"Sent",children:e.jsx(x,{color:"primary",children:e.jsx(j,{icon:"iconamoon:send-fill"})})}),e.jsx(b,{title:"Download",children:e.jsx(x,{color:"primary",children:e.jsx(j,{icon:"eva:download-outline"})})}),e.jsx(b,{title:"Print",children:e.jsx(x,{color:"primary",children:e.jsx(j,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(b,{title:"Delete",children:e.jsx(x,{color:"primary",onClick:d.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(C,{children:e.jsxs(oe,{size:a.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(se,{order:a.order,orderBy:a.orderBy,headLabel:je,rowCount:o.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:t=>a.onSelectAllRows(t,o.map(s=>s.id))}),e.jsxs(le,{children:[o.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(t=>e.jsx(be,{row:t,selected:a.selected.includes(t.id),onSelectRow:()=>a.onSelectRow(t.id),onViewRow:()=>U(t.id),onEditRow:()=>H(t.id),onDeleteRow:()=>V(t.id)},t.id)),e.jsx(ne,{height:B,emptyRows:pe(a.page,a.rowsPerPage,o.length)}),e.jsx(re,{notFound:L})]})]})})]}),e.jsx(ie,{count:o.length,page:a.page,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onRowsPerPageChange:a.onChangeRowsPerPage,dense:a.dense,onChangeDense:a.onChangeDense})]})]}),e.jsx(ue,{open:d.value,onClose:d.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",a.selected.length," "]})," items?"]}),action:e.jsx(ce,{variant:"contained",color:"error",onClick:()=>{N(),d.onFalse()},children:"Delete"})})]})}function Le(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" Dashboard: Invoice List"})}),e.jsx(ve,{})]})}export{Le as default};
