import{F as n,j as e,b9 as xe,aO as ge,b5 as be,ba as je,bb as fe,aw as ce,aA as B,b2 as ye,ax as p,T as x,af as I,S as v,B as S,bc as X,bd as me,be as L,al as E,ah as Se,bf as Ce,ao as de,ap as c,aj as Fe,bg as ie}from"./index-a00557e5.js";import{c as ke,a as C,b as Z,d as ee,u as ve,R as ae,e as ne,f as R,F as Ae,g as Be,h as we,i as Te}from"./form-provider-3b978251.js";import{o as De,L as Ie}from"./yup-1a0e2e5c.js";import{C as G}from"./CardHeader-79c16fa9.js";import{F as K,R as le}from"./image-e43356e5.js";let oe=!1;const Re=n.forwardRef(function(l,d){return oe||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),oe=!0),e.jsx(xe,ge({ref:d},l))}),Ee=["Simple","Variable"],Le=["Disposables","Vape Liquids","Salt Nicotine","Accessories",,"Vape Devices","Pod Systems","Nicotine Pouches","Pods & Coils","Batteries","Tanks","Others"],Ve=["New Collection","Limited Edition","Bestseller","Exclusive","Hot Deal","Trending Now","Seasonal Special","Eco-Friendly","On Sale","Clearance","Customer Favorite","Top Rated","Holiday Special","Gift Ideas","Must-Have","Limited Stock","Featured Product","Editor's Pick","Just Arrived","Back in Stock","Special Offer","Staff Picks","Flash Sale","Popular Choice","Best Value"],Ne=["SMOK","Vaporesso","GeekVape","Voopoo","Innokin","Uwell","Aspire","Eleaf","Lost Vape","Joyetech","Wismec","Freemax","Suorin","iJoy","Rincoe","Augvape","Vandy Vape","OBS","Hellvape","Teslacigs","Artery","Dovpo","Vaptio","Kangertech","Digiflavor","Sigelei","Smoant","Pioneer4You","Vapor Storm","Hugo Vapor"],ze=["Bottle Size","Puffs","Flavour","Nicotine Strength","Color","Batteries"],A={bottleSize:[10,15,30,50,60,100,120].map(s=>`${s} ml`),puffs:[500,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6500,7e3,7500,8e3,8500,9e3,9500,1e4].map(s=>`${s} puffs`),flavour:["Strawberry","Blueberry","Raspberry","Watermelon","Apple","Peach","Pineapple","Grape","Mango","Kiwi","Cherry","Banana","Lemon","Lime","Orange","Mixed Berries","Menthol","Peppermint","Spearmint","Ice Menthol","Minty Menthol","Cool Mint","Traditional Tobacco","American Blend","Virginia Tobacco","Turkish Tobacco","Cuban Cigar","Pipe Tobacco","Vanilla Custard","Chocolate Cake","Caramel","Butterscotch","Cheesecake","Tiramisu","Maple Syrup","Cookies and Cream","Pudding","Ice Cream","Bubblegum","Cotton Candy","Gummy Bear","Candy Cane","Marshmallow","Rock Candy","Toffee","Coffee","Cappuccino","Espresso","Latte","Cola","Energy Drink","Mojito","Lemonade","Iced Tea","Smoothie","Creamy Vanilla","Strawberry Cream","Coconut Cream","Hazelnut Cream","Irish Cream","Sugar Cookie","Blueberry Muffin","Donut","Pancake","Waffle","Pie Crust","Sour Apple","Sour Watermelon","Sour Cherry","Sour Lemon","Almond","Hazelnut","Peanut Butter","Pistachio","Walnut","Cinnamon","Clove","Gingerbread","Green Tea","Chamomile","Lavender","Eucalyptus"],nicotineStrength:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50].map(s=>`${s} mg`),color:["Black","Silver","White","Blue","Red","Green","Pink","Purple","Gold","Rainbow/Multicolor","Gunmetal/Gray","Yellow","Orange","Brown","Clear/Transparent"],batteries:["Single","Dual","Built-in","Triple","Quad"]};function Ke({currentProduct:s}){const l=be(),d=je("up","md"),{enqueueSnackbar:V}=fe(),{user:u}=ce(),$=ke().shape({name:C().required("Name is required"),subDescription:C().required("Short description is required"),content:C(),images:Z().min(1,"Image is required"),type:C(),category:C().required("Category is required"),tags:Z(),SKU:C().required("SKU is required"),brand:C().required("brand is required"),attributes:Z(),quantity:ee(),regularPrice:ee(),salePrice:ee().moreThan(0,"Price should not be AED 0.00")}),h=n.useMemo(()=>({id:(s==null?void 0:s.id)||"",name:(s==null?void 0:s.name)||"",subDescription:(s==null?void 0:s.subDescription)||"",content:(s==null?void 0:s.content)||"",images:(s==null?void 0:s.images)||[],type:(s==null?void 0:s.type)||"Simple",category:(s==null?void 0:s.category)||"Disposables",tags:(s==null?void 0:s.tags)||[],SKU:(s==null?void 0:s.SKU)||"",brand:(s==null?void 0:s.brand)||"SMOK",attributes:(s==null?void 0:s.attributes)||[],quantity:(s==null?void 0:s.quantity)||0,regularPrice:(s==null?void 0:s.regularPrice)||0,salePrice:(s==null?void 0:s.salePrice)||0}),[s]),[b,N]=n.useState({}),[F,f]=n.useState([]),z=ve({resolver:De($),defaultValues:h}),{reset:w,watch:H,setValue:g,handleSubmit:_,formState:{isSubmitting:q}}=z,r=H(),M=n.useCallback(async()=>{await B.get("/products",{params:{name:r.name}})},[r.name]);n.useEffect(()=>{M()},[r.name]),n.useEffect(()=>{s&&w(h)},[s,h,w]);const P=_(async a=>{console.log(a);try{s?await B.patch("products",{...a,username:u.displayName,userId:u.id,storeName:u.storeName}):await B.post("products",{...a,username:u.displayName,userId:u.id,storeName:u.storeName}),w(),V(s?"Update success!":"Create success!"),l.push(ye.dashboard.product.root)}catch(t){console.log(t)}}),y=n.useCallback(a=>{const t=r.images||[],o=a.map(i=>Object.assign(i,{preview:URL.createObjectURL(i)}));g("images",[...t,...o],{shouldValidate:!0})},[g,r.images]),T=n.useCallback(a=>{var o;const t=r.images&&((o=r.images)==null?void 0:o.filter(i=>i!==a));g("images",t)},[g,r.images]),W=n.useCallback(()=>{g("images",[])},[g]),Y=e.jsxs(e.Fragment,{children:[d&&e.jsxs(p,{md:4,children:[e.jsx(x,{variant:"h6",sx:{mb:.5},children:"Details"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Title, short description, image..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(I,{children:[!d&&e.jsx(G,{title:"Details"}),e.jsxs(v,{spacing:3,sx:{p:3},children:[e.jsx(R,{name:"name",label:"Product Name"}),e.jsx(R,{name:"subDescription",label:"Sub Description",multiline:!0,rows:4}),e.jsxs(v,{spacing:1.5,children:[e.jsx(x,{variant:"subtitle2",children:"Content"}),e.jsx(Be,{simple:!0,name:"content"})]}),e.jsxs(v,{spacing:1.5,children:[e.jsx(x,{variant:"subtitle2",children:"Images"}),e.jsx(we,{multiple:!0,name:"images",maxSize:3145728,onDrop:y,onRemove:T,onRemoveAll:W,onUpload:async a=>{try{const t=new FormData;r.images.forEach(i=>{t.append("images",i)});const{data:o}=await B.post("upload",t);g("images",o),alert("Image upload complete.")}catch{alert(" Image upload failed, try again.")}}})]})]})]})})]}),[k,O]=n.useState({name:"",show:!1}),m=e.jsxs(e.Fragment,{children:[d&&e.jsxs(p,{md:4,children:[e.jsx(x,{variant:"h6",sx:{mb:.5},children:"Key Properties"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Additional functions and attributes..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(I,{children:[!d&&e.jsx(G,{title:"Properties"}),e.jsx(v,{spacing:3,sx:{p:3},children:e.jsxs(S,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(ae,{native:!0,name:"type",label:"Product Type",InputLabelProps:{shrink:!0},children:Ee.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx(ae,{native:!0,name:"category",label:"Category",InputLabelProps:{shrink:!0},children:Le.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx(ne,{name:"tags",label:"Tags",placeholder:"+ Tags",multiple:!0,freeSolo:!0,options:Ve.map(a=>a),getOptionLabel:a=>a,renderOption:(a,t)=>n.createElement("li",{...a,key:t},t),renderTags:(a,t)=>a.map((o,i)=>n.createElement(X,{...t({index:i}),key:o,label:o,size:"small",color:"info",variant:"soft"}))}),e.jsx(R,{name:"SKU",label:"Product SKU"}),e.jsx(ae,{native:!0,name:"brand",label:"Brand",InputLabelProps:{shrink:!0},children:Ne.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs(S,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(K,{sx:{width:190},label:"Is your brand missing? Click here to add it.",control:e.jsx(me,{checked:k.show,onChange:a=>O(t=>({...t,show:a.target.checked}))})}),k.show&&e.jsxs(e.Fragment,{children:[e.jsx(L,{label:"Brand Name",style:{width:300},onChange:a=>O(t=>({...t,name:a.target.value})),value:k.name}),e.jsx(E,{variant:"contained",color:"success",onClick:()=>{k.name?alert("Your request to create a new brand is being processed. Please wait while we verify the brand."):alert("Please enter brand name")},children:"Add Brand"})]})]})]})})]})})]}),j=(a,t,o)=>{N(i=>({...i,[o]:t}))},D=e.jsxs(e.Fragment,{children:[d&&e.jsxs(p,{md:4,children:[e.jsx(x,{variant:"h6",sx:{mb:.5},children:"Product Attributes"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Additional functions and attributes..."})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(I,{children:[!d&&e.jsx(G,{title:"Attributes"}),e.jsx(v,{spacing:3,sx:{p:3},children:e.jsxs(S,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsx(S,{sx:{gridColumn:"span 2 "},children:e.jsx(ne,{name:"attributes",label:"Attributes",placeholder:"+ Attributes",multiple:!0,options:ze.map(a=>a),getOptionLabel:a=>a,renderOption:(a,t)=>n.createElement("li",{...a,key:t},t),renderTags:(a,t)=>a.map((o,i)=>n.createElement(X,{...t({index:i}),key:o,label:o,size:"small",color:"info",variant:"soft"}))})}),r.attributes.map(a=>e.jsx(S,{sx:{gridColumn:"span 1 "},children:e.jsx(Re,{multiple:!0,freeSolo:!0,options:a==="Bottle Size"&&A.bottleSize||a==="Puffs"&&A.puffs||a==="Flavour"&&A.flavour||a==="Nicotine Strength"&&A.nicotineStrength||a==="Color"&&A.color||a==="Batteries"&&A.batteries||[],value:b[a],onChange:(t,o)=>{j(t,o,a),console.log(),o.length>=2?F.find(i=>i===a)||f(i=>[...i,a]):f(i=>i.filter(Q=>Q!==a))},renderInput:t=>e.jsx(L,{...t,label:a,placeholder:a}),renderTags:(t,o)=>t.map((i,Q)=>n.createElement(X,{...o({index:Q}),key:i,label:i,size:"small",color:"info",variant:"soft"}))})},a))]})})]})})]}),pe=e.jsxs(e.Fragment,{children:[d&&e.jsxs(p,{md:4,children:[e.jsx(x,{variant:"h6",sx:{mb:.5},children:"Pricing"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Price related inputs"})]}),e.jsx(p,{xs:12,md:12,children:e.jsxs(I,{children:[!d&&e.jsx(G,{title:"Pricing"}),e.jsxs(v,{spacing:3,sx:{p:3},children:[e.jsx(R,{name:"regularPrice",label:"Regular Price",placeholder:"0.00",type:"number",InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(S,{component:"span",sx:{color:"text.disabled"},children:"AED"})})}}),e.jsx(R,{name:"salePrice",label:"Sale Price",placeholder:"0.00",type:"number",InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(S,{component:"span",sx:{color:"text.disabled"},children:"AED"})})}})]})]})})]}),ue=e.jsx(e.Fragment,{children:e.jsx(p,{xs:12,md:8,sx:{display:"flex",alignItems:"center"},children:e.jsx(Ie,{type:"submit",variant:"contained",size:"large",loading:q,children:s?"Save Changes":"Create Product"})})}),J=["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],se=[...J,...J.slice(1).flatMap(a=>J.slice(1).map(t=>a+t))];let U=1,te=0;const he=e.jsxs(e.Fragment,{children:[d&&e.jsx(p,{md:4,children:e.jsx(x,{variant:"h6",sx:{mb:.5},children:"Variation Table"})}),e.jsx(p,{xs:12,md:12,children:e.jsx(I,{children:e.jsxs(Se,{children:[e.jsx(Ce,{children:e.jsxs(de,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{width:150,children:"SKU"}),e.jsx(c,{width:250,children:"Attributes"}),e.jsx(c,{width:150,children:"Track Order"}),e.jsx(c,{children:"Stock"}),e.jsx(c,{children:"Regular Price"}),e.jsx(c,{children:"Sales Price"}),e.jsx(c,{children:"Image"}),e.jsx(c,{width:150,children:"Add Product"})]})}),e.jsxs(Fe,{children:[e.jsx(re,{counter:U++,counter2:te++,skuAlpha:se,va:"Parent",values:r,variables:b,disabled:!1},U),Object.keys(b).reduce((a,t)=>a.flatMap(o=>b[t].map(i=>`${o} - ${i}`)),[""]).map(a=>e.jsx(re,{counter:U++,counter2:te++,skuAlpha:se,va:a.slice(3),values:r,variables:b,disabled:!1},U))]})]})})})]});return e.jsx(Ae,{methods:z,onSubmit:P,children:e.jsxs(p,{container:!0,spacing:3,children:[Y,m,r.type==="Variable"&&D,r.type==="Simple"&&pe,r.type==="Variable"&&he,r.type==="Simple"&&ue]})})}function re({counter:s,values:l,skuAlpha:d,counter2:V,va:u,variables:$,disabled:h}){const{user:b}=ce(),N=d[V]?`${l.SKU}-${d[V]}`:l.SKU;let F=l.name;u!=="Parent"&&(F=`${l.name} - ${u}`);const[f,z]=n.useState(!0),[w,H]=n.useState("instock"),[g,_]=n.useState(null),[q,r]=n.useState(null),[M,P]=n.useState(null),[y,T]=n.useState("pending"),[W,Y]=n.useState(null),k=async m=>{try{const j=new FormData;j.append("images",m.target.files[0]);const{data:D}=await B.post("upload",j);Y([D[0],...l.images])}catch{}},O=async()=>{if(h)return;const m=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{2B50}\u{2B55}\u{231A}-\u{231B}\u{23E9}-\u{23EC}\u{23F0}\u{23F3}\u{25AA}-\u{25AB}\u{25B6}\u{25C0}\u{25FB}-\u{25FE}\u{2B1B}-\u{2B1C}\u{2934}-\u{2935}\u{2B05}-\u{2B07}\u{2194}-\u{2199}\u{21A9}-\u{21AA}\u{2B06}\u{2B07}\u{2B1B}\u{2B1C}]/u,j=/\d{4,}/;if(m.test(l.subDescription)||m.test(l.content)){alert("Your content contain emojis, Please remove emojis");return}if(j.test(l.subDescription)||j.test(l.content)){alert("Your content contain continues 4 digit number, Please remove");return}if(y==="pending"){T("loading");try{await B.post("/products",{username:b.displayName,userId:b.id,storeName:b.storeName,name:F,subDescription:l.subDescription,content:l.content,images:W??l.images,type:l.type,category:l.category,tags:l.tags,parentSku:l.SKU,brand:l.brand,attributes:l.attributes,variables:$,SKU:N,track:f,quantity:M,regularPrice:g,salePrice:q,productGroup:u==="Parent"?"parent":"child"}),T("success")}catch(D){console.log(`Product Creation failed :${D}`),T("failed")}}};return e.jsxs(de,{style:{backgroundColor:h&&"rgba(0,0,0,0.1)"},children:[e.jsx(c,{children:s}),e.jsx(c,{children:N}),e.jsx(c,{children:u==="Parent"?F+" - Parent":F}),e.jsx(c,{children:e.jsx(K,{label:"",control:e.jsx(me,{checked:f,onChange:m=>z(m.target.checked),disabled:h})})}),e.jsxs(c,{children:[f&&e.jsx(L,{disabled:h,size:"small",label:"Quantity",type:"number",onChange:m=>P(+m.target.value||null),value:M}),!f&&e.jsxs(Te,{"aria-label":"Stock",name:"Stock",value:w,onChange:m=>H(m.target.value),children:[e.jsx(K,{value:"instock",control:e.jsx(le,{}),label:"Instock"}),e.jsx(K,{value:"outstock",control:e.jsx(le,{}),label:"Outstock"})]})]}),e.jsx(c,{children:e.jsx(L,{disabled:h,size:"small",label:"Price",type:"number",onChange:m=>_(+m.target.value||null),value:g})}),e.jsx(c,{children:e.jsx(L,{disabled:h,size:"small",label:"Price",type:"number",onChange:m=>r(+m.target.value||null),value:q})}),e.jsx(c,{children:e.jsx("input",{size:"small",label:"Image",type:"file",onChange:k,disabled:h})}),e.jsxs(c,{children:[y==="pending"&&e.jsx(E,{color:"success",variant:"contained",size:"small",onClick:O,children:"Add Product"}),y==="loading"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Loading"}),y==="success"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Product Created"}),y==="failed"&&e.jsx(E,{color:"success",variant:"contained",size:"small",children:"Product creation failed"})]})]})}export{Ke as P};
