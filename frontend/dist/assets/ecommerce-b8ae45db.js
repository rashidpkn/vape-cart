import{aq as q,as as _,ay as H,at as Y,r as p,j as e,C as M,a3 as K,z as U,c as O,au as G,s as V,E as d,S as Q,e as v,p as u,av as X,u as W,a as Z,k as T,v as j,B as $,d as ee,K as b,W as te}from"./index-e5f709eb.js";import{C as re,B as se}from"./chart-d1a961dc.js";import{C as R}from"./CardHeader-7d73bea6.js";import{T as ae}from"./table-pagination-custom-9b2085e0.js";import{T as oe}from"./TableContainer-4c34c10a.js";import{T as ne,d as ie,b as le,c as A}from"./TableRow-35ae7e1d.js";import{A as ce}from"./Alert-4eb02ca0.js";import"./Checkbox-5831a026.js";import"./LastPage-2dcc3fa8.js";function de(o){const t=q(),h={show:!0,label:"Total",color:t.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight,lineHeight:t.typography.subtitle2.lineHeight},m={offsetY:8,color:t.palette.text.primary,fontSize:t.typography.h3.fontSize,fontWeight:t.typography.h3.fontWeight,lineHeight:t.typography.h3.lineHeight},c={colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],chart:{toolbar:{show:!1},zoom:{enabled:!1},foreColor:t.palette.text.disabled,fontFamily:t.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:t.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,fontSize:13,position:"top",horizontalAlign:"right",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:t.palette.text.primary}},plotOptions:{bar:{borderRadius:4,columnWidth:"28%",borderRadiusApplication:"end",borderRadiusWhenStacked:"last"},pie:{donut:{labels:{show:!0,value:m,total:h}}},radialBar:{track:{strokeWidth:"100%",background:_(t.palette.grey[500],.16)},dataLabels:{value:m,total:h}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.palette.divider,connectorColors:t.palette.divider}},polarArea:{rings:{strokeColor:t.palette.divider},spokes:{connectorColors:t.palette.divider}}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return H(c,o)}function I({title:o,subheader:t,chart:h,...m}){const{colors:c,categories:y,series:n,options:i}=h,r=Y(),[a,s]=p.useState(o==="Sales By Month"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][new Date().getMonth()]:"2024"),x=de({colors:c,legend:{position:"top",horizontalAlign:"right"},xaxis:{categories:y},...i}),g=p.useCallback(l=>{r.onClose(),s(l)},[r]);return e.jsxs(e.Fragment,{children:[e.jsxs(M,{...m,children:[e.jsx(R,{title:o,subheader:t,action:e.jsxs(K,{onClick:r.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[a,e.jsx(U,{width:16,icon:r.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),n.map(l=>e.jsx(O,{sx:{mt:3,mx:3},children:l.year===a&&e.jsx(re,{dir:"ltr",type:"area",series:l.data,options:x,height:364})},l.year))]}),e.jsx(G,{open:r.open,onClose:r.onClose,sx:{width:140},children:n.map(l=>e.jsx(V,{selected:l.year===a,onClick:()=>g(l.year),children:l.year},l.year))})]})}I.propTypes={chart:d.object,subheader:d.string,title:d.string};function L({title:o,subheader:t,tableData:h,tableLabels:m,...c}){return e.jsxs(M,{...c,children:[e.jsx(R,{title:o,subheader:t,sx:{mb:3}}),e.jsx(oe,{sx:{overflow:"unset"},children:e.jsx(Q,{children:e.jsxs(ne,{sx:{minWidth:640},children:[e.jsx(ae,{headLabel:m}),e.jsx(ie,{children:h.map(y=>e.jsx(N,{row:y},y.id))})]})})})]})}L.propTypes={subheader:d.string,tableData:d.array,tableLabels:d.array,title:d.string};function N({row:o}){return e.jsxs(le,{children:[e.jsx(A,{children:o.name}),e.jsx(A,{children:o.category}),e.jsx(A,{children:o.storeName}),e.jsx(A,{children:o.SKU}),e.jsx(A,{children:v(o.salePrice)})]})}N.propTypes={row:d.object};function B({title:o,percent:t,total:h,chart:m,sx:c,...y}){const n=q(),{colors:i=[n.palette.primary.light,n.palette.primary.main],options:r}=m;return e.jsx(M,{sx:{display:"flex",alignItems:"center",p:3,...c},...y,children:e.jsxs(O,{sx:{flexGrow:1},children:[e.jsx(u,{variant:"subtitle2",paragraph:!0,children:o}),e.jsx(u,{variant:"h3",gutterBottom:!0,children:X(h)})]})})}B.propTypes={chart:d.object,percent:d.number,sx:d.object,title:d.string,total:d.number};function z({title:o,sentAmount:t,currentBalance:h,orders:m=[],sx:c,...y}){const{user:n}=W(),i=Z(),[r,a]=p.useState(""),[s,x]=p.useState([]),g=p.useCallback(async()=>{const{data:f}=await T.get("/payout",{params:{fName:n.displayName}});x(f)},[]);p.useEffect(()=>{g()},[]);const l=p.useMemo(()=>m.reduce((f,C)=>{const S=C.items.find(J=>J.userId===n.id);return f+((S==null?void 0:S.price)||0)*((S==null?void 0:S.quantity)||0)},0),[m,n.id]),P=p.useMemo(()=>l*.3,[l]),k=p.useMemo(()=>l*.7,[l]),w=p.useMemo(()=>s.reduce((f,C)=>f+C.amount,0),[s]),E=p.useMemo(()=>s.reduce((f,C)=>C.status==="completed"?f+C.amount:f,0),[s]),F=p.useMemo(()=>w-E,[w,E]),D=p.useMemo(()=>k-w,[k,w]);return e.jsxs(M,{sx:{p:3,...c},...y,children:[e.jsx(u,{variant:"subtitle2",gutterBottom:!0,children:"Avalable Balance for requesting"}),!!r&&e.jsx(ce,{severity:"error",children:r}),e.jsxs(j,{spacing:2,children:[e.jsx(u,{variant:"h3",children:v(D)}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"Total Sales"}),e.jsxs(u,{variant:"body2",children:[" ",v(l)]})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"Commission"}),e.jsx(u,{variant:"body2",children:v(P)})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"Net Profit"}),e.jsx(u,{variant:"body2",children:v(k)})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"Pending Request"}),e.jsxs(u,{variant:"body2",children:[" ",v(F)]})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"Completed Request (Earned)"}),e.jsxs(u,{variant:"body2",children:[" ",v(E)]})]}),e.jsx(j,{direction:"row",spacing:1.5,children:e.jsx($,{fullWidth:!0,variant:"contained",color:"warning",onClick:()=>{D>=10?(sessionStorage.setItem("amount",D),i("/payment")):a("You must have a minimum balance of AED 10 to request a payout.")},children:"Request For Payout"})})]})]})}z.propTypes={currentBalance:d.number,sentAmount:d.number,sx:d.object,title:d.string};function pe(){const o=q(),{user:t}=W(),[h,m]=p.useState([]),[c,y]=p.useState([]);return p.useEffect(()=>{(async()=>{try{const[i,r,a]=await Promise.all([T.get("products",{params:{userId:t.id}}),T.get("/orders"),T.get("/invoice")]),{products:s}=i.data,x=r.data,g=a.data,l=x.filter(P=>P.items.some(k=>s.some(w=>w.id===k.id)));y(l),m(s)}catch(i){console.error("An error occurred:",i)}})()},[t.id]),console.log(c),e.jsxs(O,{px:5,children:[e.jsx(ee,{heading:"Analytics",links:[{}],sx:{mb:{xs:3,md:5}}}),e.jsxs(b,{container:!0,spacing:3,sx:{position:"relative"},children:[e.jsx(se,{products:h}),e.jsx(b,{xs:12,md:4,children:e.jsx(B,{title:"Product Sold",percent:0,total:c.length,chart:{series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(b,{xs:12,md:4,children:e.jsx(B,{title:"Total Balance",percent:0,total:c.reduce((n,i)=>{var r,a;return n+((r=i.items.find(s=>s.userId===t.id))==null?void 0:r.price)*((a=i.items.find(s=>s.userId===t.id))==null?void 0:a.quantity)},0),chart:{colors:[o.palette.info.light,o.palette.info.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(b,{xs:12,md:4,children:e.jsx(B,{title:"Sales Profit",percent:0,total:c.reduce((n,i)=>{var r,a;return n+((r=i.items.find(s=>s.userId===t.id))==null?void 0:r.price)*((a=i.items.find(s=>s.userId===t.id))==null?void 0:a.quantity)},0)*.8,chart:{colors:[o.palette.warning.light,o.palette.warning.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(b,{xs:12,md:12,lg:12,children:e.jsx(I,{title:"Sales By Month",chart:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],series:[0,1,2,3,4,5,6,7,8,9,10,11].map(n=>({year:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n],data:[{name:"Total Income",data:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].map(i=>c.reduce((r,a)=>{var s,x;return new Date(a.createdAt).getMonth()===n&&new Date(a.createdAt).getDate()===i?r+((s=a.items.find(g=>g.userId===t.id))==null?void 0:s.price)*((x=a.items.find(g=>g.userId===t.id))==null?void 0:x.quantity):r},0))}]}))}})}),e.jsx(b,{xs:12,md:12,lg:12,children:e.jsx(I,{title:"Yearly Sales",chart:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[{year:"2024",data:[{name:"Total Income",data:[0,1,2,3,4,5,6,7,8,9,10,11].map(n=>c.reduce((i,r)=>{var a,s;return new Date(r.createdAt).getMonth()===n?i+((a=r.items.find(x=>x.userId===t.id))==null?void 0:a.price)*((s=r.items.find(x=>x.userId===t.id))==null?void 0:s.quantity):i},0))}]}]}})}),e.jsx(b,{xs:12,md:6,lg:8,children:e.jsx(L,{title:"Top Selling Products",tableData:h,tableLabels:[{id:"Product name",label:"Product Name"},{id:"category",label:"Category"},{id:"storeName",label:"Store Name"},{id:"sku",label:"SKU"},{id:"salePrice",label:"Sale Price"}]})}),e.jsx(b,{xs:12,md:6,lg:4,children:e.jsx(z,{title:"Current Balance",currentBalance:0,sentAmount:0,orders:c})})]})]})}function ve(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:" Dashboard: Analytics"})}),e.jsx(pe,{})]})}export{ve as default};
