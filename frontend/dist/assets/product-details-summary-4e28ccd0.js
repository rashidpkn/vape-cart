import{b5 as de,aC as ue,F as r,b2 as A,j as e,B as c,aq as D,S as a,aT as pe,bT as xe,bU as he,bV as me,at as je,al as y,T as g,ak as E,az as ye,af as ge,aA as be,am as fe}from"./index-f9db9ede.js";import{u as ve,F as we}from"./form-provider-9e565194.js";import{p as Se}from"./product-details-description-4a449d93.js";import{R as Pe}from"./Rating-18585a5e.js";import{G as R}from"./Grid-fcfadf02.js";function Re({cart:d,product:u,onAddCart:l,onGotoStep:V,disabledActions:F,setProduct:ke,similarProduct:q=[],...B}){var T;const G=de(),L=ue(),{id:b,name:p,sizes:Ce,regularPrice:N,coverUrl:O,colors:Ie=[],quantity:Q,salePrice:x,totalRatings:U,totalReviews:W,inventoryType:h,subDescription:f,images:$,userId:m,type:v,productGroup:w,variables:S}=u,[M,H]=r.useState([]),J=async()=>{if(v==="Variable"&&w==="parent"){const{data:s}=await be.get("/products",{perPage:2e3});H(s.products)}};r.useEffect(()=>{J()},[]);const K=(T=d==null?void 0:d.map(s=>s.id))==null?void 0:T.includes(b),P={id:b,name:p,coverUrl:O,quantity:1,price:x,images:$},k=ve({defaultValues:P}),{reset:X,watch:Y,handleSubmit:Z}=k,n=Y();r.useEffect(()=>{u&&X(P)},[u]);const _=Z(async s=>{try{K||l({...s,colors:[n.colors],subTotal:s.price*s.quantity,userId:m}),V(0),G.push(A.product.checkout)}catch(i){console.error(i)}}),ee=r.useCallback(()=>{try{l({...n,subTotal:n.price,userId:m}),console.log(n)}catch(s){console.error(s)}},[l,n]),se=e.jsxs(c,{sx:{typography:"h5"},children:[x&&e.jsx(c,{component:"span",sx:{color:"text.disabled",textDecoration:"line-through",mr:.5},children:D(N)}),D(x)]}),te=e.jsxs(a,{direction:"row",children:[e.jsx(g,{variant:"subtitle2",sx:{flexGrow:1},children:"Quantity"}),e.jsx(a,{spacing:1,children:e.jsxs(g,{variant:"caption",component:"div",sx:{textAlign:"right"},children:["Available: ",Q]})})]}),re=e.jsxs(a,{direction:"row",spacing:2,children:[e.jsx(y,{fullWidth:!0,size:"large",color:"warning",variant:"contained",startIcon:e.jsx(fe,{icon:"solar:cart-plus-bold",width:24}),onClick:ee,sx:{whiteSpace:"nowrap"},children:"Add to Cart"}),e.jsx(y,{fullWidth:!0,size:"large",type:"submit",variant:"contained",disabled:F,children:"Buy Now"})]}),ae=!!f&&Se(f),ie=e.jsxs(a,{direction:"row",alignItems:"center",sx:{color:"text.disabled",typography:"body2"},children:[e.jsx(Pe,{size:"small",value:U,precision:.1,readOnly:!0,sx:{mr:1}}),`(${pe(W)} reviews)`]}),ne=e.jsx(c,{component:"span",sx:{typography:"overline",color:h==="out of stock"&&"error.main"||h==="low stock"&&"warning.main"||"success.main"},children:h}),[j,oe]=r.useState({}),[C,I]=r.useState("");r.useEffect(()=>{I("")},[j]);const ce=v==="Variable"&&w==="parent"&&e.jsxs(c,{display:"flex",flexDirection:"column",gap:"10px",children:[Object.keys(S).map((s,i)=>e.jsxs(xe,{sx:{width:"50%"},size:"small",children:[e.jsx(he,{id:"demo-simple-select-label",children:s}),e.jsx(me,{label:s,onChange:t=>oe(o=>({...o,[s]:t.target.value})),children:S[s].map((t,o)=>e.jsx(je,{value:t,children:t},o))},i)]})),e.jsx(y,{sx:{width:"50%"},variant:"contained",color:"success",onClick:()=>{let s=p;Object.keys(j).map(t=>s=s+" - "+j[t]);const i=M.find(t=>t.name.toLowerCase().includes(s.toLowerCase()));if(i){const{id:t,name:o,salePrice:z,images:le}=i;l({id:t,name:o,price:z,images:le,subTotal:z,userId:m,quantity:1}),L(A.product.checkout)}else I("Out of stock")},children:"Buy"}),!!C&&e.jsx("p",{style:{color:"#F00A"},children:C})]});return e.jsx(we,{methods:k,onSubmit:_,children:e.jsxs(a,{spacing:3,sx:{pt:3},...B,children:[e.jsxs(a,{spacing:2,alignItems:"flex-start",children:[ne,e.jsx(g,{variant:"h5",children:p}),ie,se,ae]}),ce,e.jsx(E,{sx:{borderStyle:"dashed"}}),te,e.jsxs(c,{children:[e.jsx("h4",{children:"Products related to this item"}),e.jsx(R,{container:!0,gap:1,justifyContent:"center",mt:2,children:q.map(s=>e.jsx(R,{item:!0,xs:5.5,component:ye,to:`/product/${s.id}`,children:e.jsxs(ge,{children:[e.jsx("img",{src:s.images[0],width:"100%"}),e.jsxs(a,{direction:"row",sx:{fontSize:"16px"},justifyContent:"space-between",alignItems:"center",px:.5,children:[e.jsx("p",{children:s.name}),e.jsxs("p",{children:["AED ",s.salePrice]})]})]})},s.id))})]}),e.jsx(E,{sx:{borderStyle:"dashed"}}),re]})})}export{Re as P};
