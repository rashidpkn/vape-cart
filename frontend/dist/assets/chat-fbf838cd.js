import{b5 as _t,b6 as bn,b7 as yn,b8 as jn,b9 as wn,ba as me,bb as ut,bc as Cn,V as It,Q as te,bd as Dt,be as Rn,r as l,$ as Ot,N as Lt,j as t,i as be,A as B,a2 as Nt,bf as En,bg as Sn,b2 as Tn,b3 as Ie,J as kn,K as An,bh as Mt,ac as X,bi as ht,z as Ge,bj as _n,bk as In,bl as Dn,bm as On,bn as Ln,bo as Ft,bp as Nn,R as Be,bq as Mn,br as Fn,bs as Pn,ad as Vn,aF as ye,ae as Un,q as j,v as Ee,ak as $n,a9 as I,w as y,s as Wn,o as De,bt as zn,n as qn,bu as Pt,bv as Se,x as R,l as G,bw as Vt,bx as ue,aa as Ut,a4 as He,at as $t,p as je,T as Wt,a8 as Gn,c as H,S as Te,by as zt,bz as Bn,bA as Hn,bB as Kn,aJ as Xn,t as Ke,C as qt,aN as Yn,bC as Jn,bD as Qn,al as Zn,ao as es,W as ts}from"./index-bc388b4b.js";import{u as ns}from"./use-search-params-e35e6e77.js";import{D as ss}from"./DialogContent-3d9c6eea.js";import{F as rs}from"./file-thumbnail-57a9fae4.js";import{u as os,L as as}from"./lightbox-7b0ab4a1.js";import{C as is}from"./Card-6273d280.js";function cs(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function ls(e){return parseFloat(e)}var ft=1e3*60,we=60*24,pt=we*30,xt=we*365;function ds(e,n,s){var r,a,o;_t(2,arguments);var i=Cn(),c=(r=(a=s==null?void 0:s.locale)!==null&&a!==void 0?a:i.locale)!==null&&r!==void 0?r:bn;if(!c.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var h=yn(e,n);if(isNaN(h))throw new RangeError("Invalid time value");var d=jn(wn(s),{addSuffix:!!(s!=null&&s.addSuffix),comparison:h}),g,x;h>0?(g=me(n),x=me(e)):(g=me(e),x=me(n));var v=String((o=s==null?void 0:s.roundingMethod)!==null&&o!==void 0?o:"round"),f;if(v==="floor")f=Math.floor;else if(v==="ceil")f=Math.ceil;else if(v==="round")f=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var m=x.getTime()-g.getTime(),p=m/ft,w=ut(x)-ut(g),u=(m-w)/ft,M=s==null?void 0:s.unit,E;if(M?E=String(M):p<1?E="second":p<60?E="minute":p<we?E="hour":u<pt?E="day":u<xt?E="month":E="year",E==="second"){var O=f(m/1e3);return c.formatDistance("xSeconds",O,d)}else if(E==="minute"){var k=f(p);return c.formatDistance("xMinutes",k,d)}else if(E==="hour"){var A=f(p/60);return c.formatDistance("xHours",A,d)}else if(E==="day"){var U=f(u/we);return c.formatDistance("xDays",U,d)}else if(E==="month"){var C=f(u/pt);return C===12&&M!=="month"?c.formatDistance("xYears",1,d):c.formatDistance("xMonths",C,d)}else if(E==="year"){var L=f(u/xt);return c.formatDistance("xYears",L,d)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function us(e,n){return _t(1,arguments),ds(e,Date.now(),n)}const hs=["children","className","component","componentsProps","max","renderSurplus","slotProps","spacing","total","variant"],mt={small:-16,medium:null},fs=e=>{const{classes:n}=e;return Nt({root:["root"],avatar:["avatar"]},En,n)},ps=It("div",{name:"MuiAvatarGroup",slot:"Root",overridesResolver:(e,n)=>te({[`& .${Dt.avatar}`]:n.avatar},n.root)})(({theme:e,ownerState:n})=>{const s=n.spacing&&mt[n.spacing]!==void 0?mt[n.spacing]:-n.spacing;return{[`& .${Rn.root}`]:{border:`2px solid ${(e.vars||e).palette.background.default}`,boxSizing:"content-box",marginLeft:s??-8,"&:last-child":{marginLeft:0}},display:"flex",flexDirection:"row-reverse"}}),xs=l.forwardRef(function(n,s){var r;const a=Ot({props:n,name:"MuiAvatarGroup"}),{children:o,className:i,component:c="div",componentsProps:h={},max:d=5,renderSurplus:g,slotProps:x={},spacing:v="medium",total:f,variant:m="circular"}=a,p=Lt(a,hs);let w=d<2?2:d;const u=te({},a,{max:d,spacing:v,component:c,variant:m}),M=fs(u),E=l.Children.toArray(o).filter(L=>l.isValidElement(L)),O=f||E.length;O===w&&(w+=1),w=Math.min(O+1,w);const k=Math.min(E.length,w-1),A=Math.max(O-w,O-k,0),U=g?g(A):`+${A}`,C=(r=x.additionalAvatar)!=null?r:h.additionalAvatar;return t.jsxs(ps,te({as:c,ownerState:u,className:be(M.root,i),ref:s},p,{children:[A?t.jsx(B,te({variant:m},C,{className:be(M.avatar,C==null?void 0:C.className),children:U})):null,E.slice(0,k).reverse().map(L=>l.cloneElement(L,{className:be(L.props.className,M.avatar),variant:L.props.variant||m}))]}))}),ms=xs;function gt(e){return e.substring(2).toLowerCase()}function gs(e,n){return n.documentElement.clientWidth<e.clientX||n.documentElement.clientHeight<e.clientY}function vs(e){const{children:n,disableReactTree:s=!1,mouseEvent:r="onClick",onClickAway:a,touchEvent:o="onTouchEnd"}=e,i=l.useRef(!1),c=l.useRef(null),h=l.useRef(!1),d=l.useRef(!1);l.useEffect(()=>(setTimeout(()=>{h.current=!0},0),()=>{h.current=!1}),[]);const g=Sn(n.ref,c),x=Tn(m=>{const p=d.current;d.current=!1;const w=Ie(c.current);if(!h.current||!c.current||"clientX"in m&&gs(m,w))return;if(i.current){i.current=!1;return}let u;m.composedPath?u=m.composedPath().indexOf(c.current)>-1:u=!w.documentElement.contains(m.target)||c.current.contains(m.target),!u&&(s||!p)&&a(m)}),v=m=>p=>{d.current=!0;const w=n.props[m];w&&w(p)},f={ref:g};return o!==!1&&(f[o]=v(o)),l.useEffect(()=>{if(o!==!1){const m=gt(o),p=Ie(c.current),w=()=>{i.current=!0};return p.addEventListener(m,x),p.addEventListener("touchmove",w),()=>{p.removeEventListener(m,x),p.removeEventListener("touchmove",w)}}},[x,o]),r!==!1&&(f[r]=v(r)),l.useEffect(()=>{if(r!==!1){const m=gt(r),p=Ie(c.current);return p.addEventListener(m,x),()=>{p.removeEventListener(m,x)}}},[x,r]),t.jsx(l.Fragment,{children:l.cloneElement(n,f)})}function bs(e){return kn("MuiSkeleton",e)}An("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const ys=["animation","className","component","height","style","variant","width"];let Ce=e=>e,vt,bt,yt,jt;const js=e=>{const{classes:n,variant:s,animation:r,hasChildren:a,width:o,height:i}=e;return Nt({root:["root",s,r,a&&"withChildren",a&&!o&&"fitContent",a&&!i&&"heightAuto"]},bs,n)},ws=Mt(vt||(vt=Ce`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),Cs=Mt(bt||(bt=Ce`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),Rs=It("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,n[s.variant],s.animation!==!1&&n[s.animation],s.hasChildren&&n.withChildren,s.hasChildren&&!s.width&&n.fitContent,s.hasChildren&&!s.height&&n.heightAuto]}})(({theme:e,ownerState:n})=>{const s=cs(e.shape.borderRadius)||"px",r=ls(e.shape.borderRadius);return te({display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:X(e.palette.text.primary,e.palette.mode==="light"?.11:.13),height:"1.2em"},n.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${r}${s}/${Math.round(r/.6*10)/10}${s}`,"&:empty:before":{content:'"\\00a0"'}},n.variant==="circular"&&{borderRadius:"50%"},n.variant==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius},n.hasChildren&&{"& > *":{visibility:"hidden"}},n.hasChildren&&!n.width&&{maxWidth:"fit-content"},n.hasChildren&&!n.height&&{height:"auto"})},({ownerState:e})=>e.animation==="pulse"&&ht(yt||(yt=Ce`
      animation: ${0} 2s ease-in-out 0.5s infinite;
    `),ws),({ownerState:e,theme:n})=>e.animation==="wave"&&ht(jt||(jt=Ce`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 2s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),Cs,(n.vars||n).palette.action.hover)),Es=l.forwardRef(function(n,s){const r=Ot({props:n,name:"MuiSkeleton"}),{animation:a="pulse",className:o,component:i="span",height:c,style:h,variant:d="text",width:g}=r,x=Lt(r,ys),v=te({},r,{animation:a,component:i,variant:d,hasChildren:!!x.children}),f=js(v);return t.jsx(Rs,te({as:i,ref:s,className:be(f.root,o),ownerState:v},x,{style:te({width:g,height:c},h)}))}),Oe=Es;var Ss=_n;function Ts(e){return e&&e.length?Ss(e):[]}var ks=Ts;const As=Ge(ks);var _s=In,Is=Dn;function Ds(e,n){return e&&_s(e,n,Is)}var Os=Ds,Ls=On;function Ns(e,n){return function(s,r){if(s==null)return s;if(!Ls(s))return e(s,r);for(var a=s.length,o=n?a:-1,i=Object(s);(n?o--:++o<a)&&r(i[o],o,i)!==!1;);return s}}var Ms=Ns,Fs=Os,Ps=Ms,Vs=Ps(Fs),Us=Vs;function $s(e,n,s,r){for(var a=-1,o=e==null?0:e.length;++a<o;){var i=e[a];n(r,i,s(i),e)}return r}var Ws=$s,zs=Us;function qs(e,n,s,r){return zs(e,function(a,o,i){n(r,a,s(a),i)}),r}var Gs=qs,Bs=Ws,Hs=Gs,Ks=Ln,Xs=Ft;function Ys(e,n){return function(s,r){var a=Xs(s)?Bs:Hs,o=n?n():{};return a(s,e,Ks(r),o)}}var Js=Ys,Qs=Nn,Zs=Js,er=Zs(function(e,n,s){Qs(e,s,n)}),tr=er;const nr=Ge(tr),ee=()=>{},V=ee(),Le=Object,b=e=>e===V,Y=e=>typeof e=="function",ne=(e,n)=>({...e,...n}),sr=e=>Y(e.then),ge=new WeakMap;let rr=0;const he=e=>{const n=typeof e,s=e&&e.constructor,r=s==Date;let a,o;if(Le(e)===e&&!r&&s!=RegExp){if(a=ge.get(e),a)return a;if(a=++rr+"~",ge.set(e,a),s==Array){for(a="@",o=0;o<e.length;o++)a+=he(e[o])+",";ge.set(e,a)}if(s==Le){a="#";const i=Le.keys(e).sort();for(;!b(o=i.pop());)b(e[o])||(a+=o+":"+he(e[o])+",");ge.set(e,a)}}else a=r?e.toJSON():n=="symbol"?e.toString():n=="string"?JSON.stringify(e):""+e;return a},Z=new WeakMap,Ne={},ve={},Xe="undefined",ke=typeof window!=Xe,Ue=typeof document!=Xe,or=()=>ke&&typeof window.requestAnimationFrame!=Xe,Gt=(e,n)=>{const s=Z.get(e);return[()=>!b(n)&&e.get(n)||Ne,r=>{if(!b(n)){const a=e.get(n);n in ve||(ve[n]=a),s[5](n,ne(a,r),a||Ne)}},s[6],()=>!b(n)&&n in ve?ve[n]:!b(n)&&e.get(n)||Ne]};let $e=!0;const ar=()=>$e,[We,ze]=ke&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ee,ee],ir=()=>{const e=Ue&&document.visibilityState;return b(e)||e!=="hidden"},cr=e=>(Ue&&document.addEventListener("visibilitychange",e),We("focus",e),()=>{Ue&&document.removeEventListener("visibilitychange",e),ze("focus",e)}),lr=e=>{const n=()=>{$e=!0,e()},s=()=>{$e=!1};return We("online",n),We("offline",s),()=>{ze("online",n),ze("offline",s)}},dr={isOnline:ar,isVisible:ir},ur={initFocus:cr,initReconnect:lr},wt=!Be.useId,fe=!ke||"Deno"in window,hr=e=>or()?window.requestAnimationFrame(e):setTimeout(e,1),Me=fe?l.useEffect:l.useLayoutEffect,Fe=typeof navigator<"u"&&navigator.connection,Ct=!fe&&Fe&&(["slow-2g","2g"].includes(Fe.effectiveType)||Fe.saveData),Ye=e=>{if(Y(e))try{e=e()}catch{e=""}const n=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?he(e):"",[e,n]};let fr=0;const qe=()=>++fr,Bt=0,Ht=1,Kt=2,pr=3;var de={__proto__:null,ERROR_REVALIDATE_EVENT:pr,FOCUS_EVENT:Bt,MUTATE_EVENT:Kt,RECONNECT_EVENT:Ht};async function Xt(...e){const[n,s,r,a]=e,o=ne({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const c=o.rollbackOnError;let h=o.optimisticData;const d=v=>typeof c=="function"?c(v):c!==!1,g=o.throwOnError;if(Y(s)){const v=s,f=[],m=n.keys();for(const p of m)!/^\$(inf|sub)\$/.test(p)&&v(n.get(p)._k)&&f.push(p);return Promise.all(f.map(x))}return x(s);async function x(v){const[f]=Ye(v);if(!f)return;const[m,p]=Gt(n,f),[w,u,M,E]=Z.get(n),O=()=>{const q=w[f];return(Y(o.revalidate)?o.revalidate(m().data,v):o.revalidate!==!1)&&(delete M[f],delete E[f],q&&q[0])?q[0](Kt).then(()=>m().data):m().data};if(e.length<3)return O();let k=r,A;const U=qe();u[f]=[U,0];const C=!b(h),L=m(),D=L.data,$=L._c,z=b($)?D:$;if(C&&(h=Y(h)?h(z,D):h,p({data:h,_c:z})),Y(k))try{k=k(z)}catch(q){A=q}if(k&&sr(k))if(k=await k.catch(q=>{A=q}),U!==u[f][0]){if(A)throw A;return k}else A&&C&&d(A)&&(i=!0,p({data:z,_c:V}));if(i&&!A)if(Y(i)){const q=i(k,z);p({data:q,error:V,_c:V})}else p({data:k,error:V,_c:V});if(u[f][1]=qe(),Promise.resolve(O()).then(()=>{p({_c:V})}),A){if(g)throw A;return}return k}}const Rt=(e,n)=>{for(const s in e)e[s][0]&&e[s][0](n)},xr=(e,n)=>{if(!Z.has(e)){const s=ne(ur,n),r={},a=Xt.bind(V,e);let o=ee;const i={},c=(g,x)=>{const v=i[g]||[];return i[g]=v,v.push(x),()=>v.splice(v.indexOf(x),1)},h=(g,x,v)=>{e.set(g,x);const f=i[g];if(f)for(const m of f)m(x,v)},d=()=>{if(!Z.has(e)&&(Z.set(e,[r,{},{},{},a,h,c]),!fe)){const g=s.initFocus(setTimeout.bind(V,Rt.bind(V,r,Bt))),x=s.initReconnect(setTimeout.bind(V,Rt.bind(V,r,Ht)));o=()=>{g&&g(),x&&x(),Z.delete(e)}}};return d(),[e,a,d,o]}return[e,Z.get(e)[4]]},mr=(e,n,s,r,a)=>{const o=s.errorRetryCount,i=a.retryCount,c=~~((Math.random()+.5)*(1<<(i<8?i:8)))*s.errorRetryInterval;!b(o)&&i>o||setTimeout(r,c,a)},gr=(e,n)=>he(e)==he(n),[Yt,Re]=xr(new Map),vr=ne({onLoadingSlow:ee,onSuccess:ee,onError:ee,onErrorRetry:mr,onDiscarded:ee,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ct?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ct?5e3:3e3,compare:gr,isPaused:()=>!1,cache:Yt,mutate:Re,fallback:{}},dr),br=(e,n)=>{const s=ne(e,n);if(n){const{use:r,fallback:a}=e,{use:o,fallback:i}=n;r&&o&&(s.use=r.concat(o)),a&&i&&(s.fallback=ne(a,i))}return s},yr=l.createContext({}),jr="$inf$",Jt=ke&&window.__SWR_DEVTOOLS_USE__,wr=Jt?window.__SWR_DEVTOOLS_USE__:[],Cr=()=>{Jt&&(window.__SWR_DEVTOOLS_REACT__=Be)},Rr=e=>Y(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],Er=()=>ne(vr,l.useContext(yr)),Sr=e=>(n,s,r)=>e(n,s&&((...o)=>{const[i]=Ye(n),[,,,c]=Z.get(Yt);if(i.startsWith(jr))return s(...o);const h=c[i];return b(h)?s(...o):(delete c[i],h)}),r),Tr=wr.concat(Sr),kr=e=>function(...s){const r=Er(),[a,o,i]=Rr(s),c=br(r,i);let h=e;const{use:d}=c,g=(d||[]).concat(Tr);for(let x=g.length;x--;)h=g[x](h);return h(a,o||c.fetcher||null,c)},Ar=(e,n,s)=>{const r=n[e]||(n[e]=[]);return r.push(s),()=>{const a=r.indexOf(s);a>=0&&(r[a]=r[r.length-1],r.pop())}};Cr();const Et=Be.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(n=>{e.status="fulfilled",e.value=n},n=>{e.status="rejected",e.reason=n}),e)}),Pe={dedupe:!0},_r=(e,n,s)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:c,revalidateIfStale:h,refreshInterval:d,refreshWhenHidden:g,refreshWhenOffline:x,keepPreviousData:v}=s,[f,m,p,w]=Z.get(r),[u,M]=Ye(e),E=l.useRef(!1),O=l.useRef(!1),k=l.useRef(u),A=l.useRef(n),U=l.useRef(s),C=()=>U.current,L=()=>C().isVisible()&&C().isOnline(),[D,$,z,q]=Gt(r,u),re=l.useRef({}).current,pn=b(i)?s.fallback[u]:i,tt=(S,T)=>{for(const F in re){const _=F;if(_==="data"){if(!a(S[_],T[_])&&(!b(S[_])||!a(xe,T[_])))return!1}else if(T[_]!==S[_])return!1}return!0},nt=l.useMemo(()=>{const S=(()=>!u||!n?!1:b(c)?C().isPaused()||o?!1:b(h)?!0:h:c)(),T=P=>{const J=ne(P);return delete J._k,S?{isValidating:!0,isLoading:!0,...J}:J},F=D(),_=q(),K=T(F),ce=F===_?K:T(_);let N=K;return[()=>{const P=T(D());return tt(P,N)?(N.data=P.data,N.isLoading=P.isLoading,N.isValidating=P.isValidating,N.error=P.error,N):(N=P,P)},()=>ce]},[r,u]),oe=Mn.useSyncExternalStore(l.useCallback(S=>z(u,(T,F)=>{tt(F,T)||S()}),[r,u]),nt[0],nt[1]),st=!E.current,xn=f[u]&&f[u].length>0,ae=oe.data,ie=b(ae)?pn:ae,pe=oe.error,rt=l.useRef(ie),xe=v?b(ae)?rt.current:ae:ie,ot=(()=>xn&&!b(pe)?!1:st&&!b(c)?c:C().isPaused()?!1:o?b(ie)?!1:h:b(ie)||h)(),at=!!(u&&n&&st&&ot),mn=b(oe.isValidating)?at:oe.isValidating,gn=b(oe.isLoading)?at:oe.isLoading,le=l.useCallback(async S=>{const T=A.current;if(!u||!T||O.current||C().isPaused())return!1;let F,_,K=!0;const ce=S||{},N=!p[u]||!ce.dedupe,P=()=>wt?!O.current&&u===k.current&&E.current:u===k.current,J={isValidating:!1,isLoading:!1},ct=()=>{$(J)},lt=()=>{const W=p[u];W&&W[1]===_&&delete p[u]},dt={isValidating:!0};b(D().data)&&(dt.isLoading=!0);try{if(N&&($(dt),s.loadingTimeout&&b(D().data)&&setTimeout(()=>{K&&P()&&C().onLoadingSlow(u,s)},s.loadingTimeout),p[u]=[T(M),qe()]),[F,_]=p[u],F=await F,N&&setTimeout(lt,s.dedupingInterval),!p[u]||p[u][1]!==_)return N&&P()&&C().onDiscarded(u),!1;J.error=V;const W=m[u];if(!b(W)&&(_<=W[0]||_<=W[1]||W[1]===0))return ct(),N&&P()&&C().onDiscarded(u),!1;const Q=D().data;J.data=a(Q,F)?Q:F,N&&P()&&C().onSuccess(F,u,s)}catch(W){lt();const Q=C(),{shouldRetryOnError:Ae}=Q;Q.isPaused()||(J.error=W,N&&P()&&(Q.onError(W,u,Q),(Ae===!0||Y(Ae)&&Ae(W))&&(!C().revalidateOnFocus||!C().revalidateOnReconnect||L())&&Q.onErrorRetry(W,u,Q,vn=>{const _e=f[u];_e&&_e[0]&&_e[0](de.ERROR_REVALIDATE_EVENT,vn)},{retryCount:(ce.retryCount||0)+1,dedupe:!0})))}return K=!1,ct(),!0},[u,r]),it=l.useCallback((...S)=>Xt(r,k.current,...S),[]);if(Me(()=>{A.current=n,U.current=s,b(ae)||(rt.current=ae)}),Me(()=>{if(!u)return;const S=le.bind(V,Pe);let T=0;const _=Ar(u,f,(K,ce={})=>{if(K==de.FOCUS_EVENT){const N=Date.now();C().revalidateOnFocus&&N>T&&L()&&(T=N+C().focusThrottleInterval,S())}else if(K==de.RECONNECT_EVENT)C().revalidateOnReconnect&&L()&&S();else{if(K==de.MUTATE_EVENT)return le();if(K==de.ERROR_REVALIDATE_EVENT)return le(ce)}});return O.current=!1,k.current=u,E.current=!0,$({_k:M}),ot&&(b(ie)||fe?S():hr(S)),()=>{O.current=!0,_()}},[u]),Me(()=>{let S;function T(){const _=Y(d)?d(D().data):d;_&&S!==-1&&(S=setTimeout(F,_))}function F(){!D().error&&(g||C().isVisible())&&(x||C().isOnline())?le(Pe).then(T):T()}return T(),()=>{S&&(clearTimeout(S),S=-1)}},[d,g,x,u]),l.useDebugValue(xe),o&&b(ie)&&u){if(!wt&&fe)throw new Error("Fallback data is required when using suspense in SSR.");A.current=n,U.current=s,O.current=!1;const S=w[u];if(!b(S)){const T=it(S);Et(T)}if(b(pe)){const T=le(Pe);b(xe)||(T.status="fulfilled",T.value=!0),Et(T)}else throw pe}return{mutate:it,get data(){return re.data=!0,xe},get error(){return re.error=!0,pe},get isValidating(){return re.isValidating=!0,mn},get isLoading(){return re.isLoading=!0,gn}}},Je=kr(_r),Qe=Fn.create({baseURL:Pn});Qe.interceptors.response.use(e=>e,e=>Promise.reject(e.response&&e.response.data||"Something went wrong"));const Ze=async e=>{const[n,s]=Array.isArray(e)?e:[e];return(await Qe.get(n,{...s})).data},se={chat:"/api/chat",kanban:"/api/kanban",calendar:"/api/calendar",auth:{me:"/api/auth/me",login:"/api/auth/login",register:"/api/auth/register"},mail:{list:"/api/mail/list",details:"/api/mail/details",labels:"/api/mail/labels"},post:{list:"/api/post/list",details:"/api/post/details",latest:"/api/post/latest",search:"/api/post/search"},product:{list:"/api/product/list",details:"/api/product/details",search:"/api/product/search"}},et={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function Ir(){const e=[se.chat,{params:{endpoint:"contacts"}}],{data:n,isLoading:s,error:r,isValidating:a}=Je(e,Ze,et);return l.useMemo(()=>({contacts:(n==null?void 0:n.contacts)||[],contactsLoading:s,contactsError:r,contactsValidating:a,contactsEmpty:!s&&!(n!=null&&n.contacts.length)}),[n==null?void 0:n.contacts,r,s,a])}function Dr(){const e=[se.chat,{params:{endpoint:"conversations"}}],{data:n,isLoading:s,error:r,isValidating:a}=Je(e,Ze,et);return l.useMemo(()=>{const i=nr(n==null?void 0:n.conversations,"id")||{},c=Object.keys(i)||[];return{conversations:{byId:i,allIds:c},conversationsLoading:s,conversationsError:r,conversationsValidating:a,conversationsEmpty:!s&&!c.length}},[n==null?void 0:n.conversations,r,s,a])}function Or(e){const n=e?[se.chat,{params:{conversationId:e,endpoint:"conversation"}}]:null,{data:s,isLoading:r,error:a,isValidating:o}=Je(n,Ze,et);return l.useMemo(()=>({conversation:s==null?void 0:s.conversation,conversationLoading:r,conversationError:a,conversationValidating:o}),[s==null?void 0:s.conversation,a,r,o])}async function Lr(e,n){const s=[se.chat,{params:{endpoint:"conversations"}}],r=[se.chat,{params:{conversationId:e,endpoint:"conversation"}}];Re(r,a=>{const{conversation:o}=a;return{conversation:{...o,messages:[...o.messages,n]}}},!1),Re(s,a=>{const{conversations:o}=a;return{conversations:o.map(c=>c.id===e?{...c,messages:[...c.messages,n]}:c)}},!1)}async function Nr(e){const n=[se.chat,{params:{endpoint:"conversations"}}],s={conversationData:e},r=await Qe.post(se.chat,s);return Re(n,a=>{const o=[...a.conversations,e];return{...a,conversations:o}},!1),r.data}function Mr({message:e,participants:n,currentUserId:s}){const r=n.find(c=>c.id===e.senderId),a=e.senderId===s?{type:"me"}:{avatarUrl:r==null?void 0:r.avatarUrl,firstName:r==null?void 0:r.name.split(" ")[0]},o=a.type==="me";return{hasImage:e.contentType==="image",me:o,senderDetails:a}}function Qt(){const[e,n]=l.useState(!1),[s,r]=l.useState(!1),a=l.useCallback(()=>{r(h=>!h)},[]),o=l.useCallback(()=>{r(!1)},[]),i=l.useCallback(()=>{n(!0)},[]),c=l.useCallback(()=>{n(!1)},[]);return{openMobile:e,collapseDesktop:s,onOpenMobile:i,onCloseMobile:c,onCloseDesktop:o,onCollapseDesktop:a}}function Fr(e){const n=l.useRef(null),s=l.useCallback(()=>{e&&n.current&&n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]);return l.useEffect(()=>{s()},[e]),{messagesEndRef:n}}function Pr(){const{user:e}=Se(),n=Vn(),[s,r]=l.useState("online"),a=l.useCallback(o=>{r(o.target.value)},[]);return t.jsxs(t.Fragment,{children:[t.jsx(ye,{variant:s,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(B,{src:e==null?void 0:e.photoURL,alt:e==null?void 0:e.displayName,onClick:n.onOpen,sx:{cursor:"pointer",width:48,height:48}})}),t.jsxs(Un,{open:n.open,onClose:n.onClose,arrow:"top-left",sx:{p:0},children:[t.jsxs(j,{direction:"row",alignItems:"center",spacing:2,sx:{py:2,pr:1,pl:2.5},children:[t.jsx(Ee,{primary:e==null?void 0:e.displayName,secondary:e==null?void 0:e.email,secondaryTypographyProps:{component:"span"}}),t.jsx($n,{title:"Log out",children:t.jsx(I,{color:"error",children:t.jsx(y,{icon:"ic:round-power-settings-new"})})})]}),t.jsx(Wn,{sx:{borderStyle:"dashed"}}),t.jsxs(j,{sx:{p:1},children:[t.jsxs(De,{children:[t.jsx(ye,{variant:s,sx:{[`& .${zn.badge}`]:{position:"static",m:.75,width:12,height:12,flexShrink:0}}}),t.jsx(qn,{native:!0,fullWidth:!0,value:s,onChange:a,input:t.jsx(Pt,{sx:{pl:2}}),inputProps:{sx:{textTransform:"capitalize"}},children:["online","alway","busy","offline"].map(o=>t.jsx("option",{value:o,children:o},o))})]}),t.jsxs(De,{children:[t.jsx(y,{icon:"solar:user-id-bold",width:24}),"Profile"]}),t.jsxs(De,{children:[t.jsx(y,{icon:"eva:settings-2-fill",width:24}),"Settings"]})]})]})]})}function Zt({sx:e,...n}){return t.jsxs(j,{spacing:2,direction:"row",alignItems:"center",sx:{px:2.5,py:1.5,...e},...n,children:[t.jsx(Oe,{variant:"circular",sx:{width:48,height:48}}),t.jsxs(j,{spacing:1,flexGrow:1,children:[t.jsx(Oe,{sx:{width:.75,height:10}}),t.jsx(Oe,{sx:{width:.5,height:10}})]})]})}Zt.propTypes={sx:R.object};function en({query:e,results:n,onClickResult:s}){const r=n.length,a=!r&&!!e;return t.jsxs(t.Fragment,{children:[t.jsxs(G,{paragraph:!0,variant:"h6",sx:{px:2.5},children:["Contacts (",r,")"]}),a?t.jsx(Vt,{query:e,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}):t.jsx(t.Fragment,{children:n.map(o=>t.jsxs(ue,{onClick:()=>s(o),sx:{px:2.5,py:1.5,typography:"subtitle2"},children:[t.jsx(B,{alt:o.name,src:o.avatarUrl,sx:{mr:2}}),o.name]},o.id))})]})}en.propTypes={query:R.string,results:R.array,onClickResult:R.func};const St=320,Vr=96;function tn({loading:e,contacts:n,conversations:s,selectedConversationId:r}){const a=Ut(),o=He(),i=$t("up","md"),{collapseDesktop:c,onCloseDesktop:h,onCollapseDesktop:d,openMobile:g,onOpenMobile:x,onCloseMobile:v}=Qt(),[f,m]=l.useState({query:"",results:[]});l.useEffect(()=>{i||h()},[h,i]);const p=l.useCallback(()=>{i?d():v()},[i,v,d]),w=l.useCallback(()=>{i||v(),o.push(je.dashboard.chat)},[i,v,o]),u=l.useCallback(D=>{if(m($=>({...$,query:D})),D){const $=n.filter(z=>z.name.toLowerCase().includes(D));m(z=>({...z,results:$}))}},[n]),M=l.useCallback(()=>{m({query:"",results:[]})},[]),E=l.useCallback(D=>{M(),o.push(`${je.dashboard.chat}?id=${D.id}`)},[M,o]),O=t.jsx(I,{onClick:x,sx:{left:0,top:84,zIndex:9,width:32,height:32,position:"absolute",borderRadius:"0 12px 12px 0",bgcolor:a.palette.primary.main,boxShadow:a.customShadows.primary,color:a.palette.primary.contrastText,"&:hover":{bgcolor:a.palette.primary.darker}},children:t.jsx(y,{width:16,icon:"solar:users-group-rounded-bold"})}),k=t.jsx(t.Fragment,{children:[...Array(12)].map((D,$)=>t.jsx(Zt,{},$))}),A=t.jsx(t.Fragment,{}),U=t.jsx(en,{query:f.query,results:f.results,onClickResult:E}),C=t.jsx(vs,{onClickAway:M,children:t.jsx(Wt,{fullWidth:!0,value:f.query,onChange:D=>u(D.target.value),placeholder:"Search contacts...",InputProps:{startAdornment:t.jsx(Gn,{position:"start",children:t.jsx(y,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{mt:2.5}})}),L=t.jsxs(t.Fragment,{children:[t.jsxs(j,{direction:"row",alignItems:"center",justifyContent:"center",sx:{p:2.5,pb:0},children:[!c&&t.jsxs(t.Fragment,{children:[t.jsx(Pr,{}),t.jsx(H,{sx:{flexGrow:1}})]}),t.jsx(I,{onClick:p,children:t.jsx(y,{icon:c?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),!c&&t.jsx(I,{onClick:w,children:t.jsx(y,{width:24,icon:"solar:user-plus-bold"})})]}),t.jsx(H,{sx:{p:2.5,pt:0},children:!c&&C}),t.jsxs(Te,{sx:{pb:1},children:[f.query&&U,e&&k,!f.query&&!!s.allIds.length&&A]})]});return t.jsxs(t.Fragment,{children:[!i&&O,i?t.jsx(j,{sx:{height:1,flexShrink:0,width:St,borderRight:`solid 1px ${a.palette.divider}`,transition:a.transitions.create(["width"],{duration:a.transitions.duration.shorter}),...c&&{width:Vr}},children:L}):t.jsx(zt,{open:g,onClose:v,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:St}},children:L})]})}tn.propTypes={contacts:R.array,conversations:R.object,loading:R.bool,selectedConversationId:R.string};var Tt=Bn,Ur=Hn,$r=Ft,kt=Tt?Tt.isConcatSpreadable:void 0;function Wr(e){return $r(e)||Ur(e)||!!(kt&&e&&e[kt])}var zr=Wr,qr=Kn,Gr=zr;function nn(e,n,s,r,a){var o=-1,i=e.length;for(s||(s=Gr),a||(a=[]);++o<i;){var c=e[o];n>0&&s(c)?n>1?nn(c,n-1,s,r,a):qr(a,c):r||(a[a.length]=c)}return a}var Br=nn,Hr=Br;function Kr(e){var n=e==null?0:e.length;return n?Hr(e,1):[]}var Xr=Kr;const Yr=Ge(Xr);function sn({participant:e,open:n,onClose:s}){return t.jsxs(Xn,{fullWidth:!0,maxWidth:"xs",open:n,onClose:s,children:[t.jsx(I,{onClick:s,sx:{position:"absolute",right:8,top:8},children:t.jsx(y,{icon:"mingcute:close-line"})}),t.jsxs(ss,{sx:{py:5,px:3,display:"flex"},children:[t.jsx(B,{alt:e.name,src:e.avatarUrl,sx:{width:96,height:96,mr:3}}),t.jsxs(j,{spacing:1,children:[t.jsx(G,{variant:"caption",sx:{color:"primary.main"},children:e.role}),t.jsx(G,{variant:"subtitle1",children:e.name}),t.jsxs(j,{direction:"row",sx:{typography:"caption",color:"text.disabled"},children:[t.jsx(y,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),e.address]}),t.jsxs(j,{spacing:1,direction:"row",sx:{pt:1.5},children:[t.jsx(I,{size:"small",color:"error",sx:{borderRadius:1,bgcolor:r=>X(r.palette.error.main,.08),"&:hover":{bgcolor:r=>X(r.palette.error.main,.16)}},children:t.jsx(y,{width:18,icon:"solar:phone-bold"})}),t.jsx(I,{size:"small",color:"info",sx:{borderRadius:1,bgcolor:r=>X(r.palette.info.main,.08),"&:hover":{bgcolor:r=>X(r.palette.info.main,.16)}},children:t.jsx(y,{width:18,icon:"solar:chat-round-dots-bold"})}),t.jsx(I,{size:"small",color:"primary",sx:{borderRadius:1,bgcolor:r=>X(r.palette.primary.main,.08),"&:hover":{bgcolor:r=>X(r.palette.primary.main,.16)}},children:t.jsx(y,{width:18,icon:"fluent:mail-24-filled"})}),t.jsx(I,{size:"small",color:"secondary",sx:{borderRadius:1,bgcolor:r=>X(r.palette.secondary.main,.08),"&:hover":{bgcolor:r=>X(r.palette.secondary.main,.16)}},children:t.jsx(y,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}sn.propTypes={onClose:R.func,open:R.bool,participant:R.object};function rn({participants:e}){const[n,s]=l.useState(null),r=Ke(!0),a=l.useCallback(d=>{s(d)},[]),o=()=>{s(null)},i=e.length,c=t.jsxs(ue,{onClick:r.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[t.jsxs(H,{component:"span",sx:{flexGrow:1},children:["In room (",i,")"]}),t.jsx(y,{width:16,icon:r.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),h=t.jsx(Te,{sx:{height:56*4},children:e.map(d=>t.jsxs(ue,{onClick:()=>a(d),children:[t.jsx(ye,{variant:d.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(B,{alt:d.name,src:d.avatarUrl})}),t.jsx(Ee,{sx:{ml:2},primary:d.name,secondary:d.role,primaryTypographyProps:{noWrap:!0,typography:"subtitle2"},secondaryTypographyProps:{noWrap:!0,component:"span",typography:"caption"}})]},d.id))});return t.jsxs(t.Fragment,{children:[c,t.jsx("div",{children:t.jsx(qt,{in:r.value,children:h})}),n&&t.jsx(sn,{participant:n,open:!!n,onClose:o})]})}rn.propTypes={participants:R.array};function on({participant:e}){const n=Ke(!0),{name:s,avatarUrl:r,role:a,address:o,phoneNumber:i,email:c}=e,h=t.jsxs(j,{alignItems:"center",sx:{py:5},children:[t.jsx(B,{alt:s,src:r,sx:{width:96,height:96,mb:2}}),t.jsx(G,{variant:"subtitle1",children:s}),t.jsx(G,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:a})]}),d=t.jsxs(ue,{onClick:n.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[t.jsx(H,{component:"span",sx:{flexGrow:1},children:"Information"}),t.jsx(y,{width:16,icon:n.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),g=t.jsxs(j,{spacing:2,sx:{px:2,py:2.5,"& svg":{mr:1,flexShrink:0,color:"text.disabled"}},children:[t.jsxs(j,{direction:"row",children:[t.jsx(y,{icon:"mingcute:location-fill"}),t.jsx(G,{variant:"body2",children:o})]}),t.jsxs(j,{direction:"row",children:[t.jsx(y,{icon:"solar:phone-bold"}),t.jsx(G,{variant:"body2",children:i})]}),t.jsxs(j,{direction:"row",children:[t.jsx(y,{icon:"fluent:mail-24-filled"}),t.jsx(G,{variant:"body2",noWrap:!0,children:c})]})]});return t.jsxs(t.Fragment,{children:[h,d,t.jsx("div",{children:t.jsx(qt,{in:n.value,children:g})})]})}on.propTypes={participant:R.object};function an({attachments:e}){const n=Ke(!0),s=e.length,r=t.jsxs(ue,{disabled:!e.length,onClick:n.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[t.jsxs(H,{component:"span",sx:{flexGrow:1},children:["Attachments (",s,")"]}),t.jsx(y,{width:16,icon:!n.value&&"eva:arrow-ios-forward-fill"||!e.length&&"eva:arrow-ios-forward-fill"||"eva:arrow-ios-downward-fill"})]}),a=t.jsx(Te,{sx:{px:2,py:2.5},children:e.map((o,i)=>t.jsxs(j,{spacing:1.5,direction:"row",alignItems:"center",sx:{mb:2},children:[t.jsx(j,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:t.jsx(rs,{imageView:!0,file:o.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:28,height:28}})}),t.jsx(Ee,{primary:o.name,secondary:Yn(o.createdAt),primaryTypographyProps:{noWrap:!0,typography:"body2"},secondaryTypographyProps:{mt:.25,noWrap:!0,component:"span",typography:"caption",color:"text.disabled"}})]},o.name+i))});return t.jsxs(t.Fragment,{children:[r,t.jsx(H,{sx:{overflow:"hidden",height:n.value?1:0,transition:o=>o.transitions.create(["height"],{duration:o.transitions.duration.shorter})},children:a})]})}an.propTypes={attachments:R.array};const Ve=240;function cn({participants:e,conversation:n}){const s=Ut(),r=$t("up","lg"),{collapseDesktop:a,onCloseDesktop:o,onCollapseDesktop:i,openMobile:c,onOpenMobile:h,onCloseMobile:d}=Qt();l.useEffect(()=>{r||o()},[o,r]);const g=l.useCallback(()=>{r?i():h()},[r]),x=e.length>1,v=As(Yr(n.messages.map(p=>p.attachments))),f=t.jsxs(t.Fragment,{children:[x?t.jsx(rn,{participants:e}):t.jsx(on,{participant:e[0]}),t.jsx(an,{attachments:v})]}),m=t.jsx(I,{onClick:g,sx:{top:12,right:0,zIndex:9,width:32,height:32,borderRight:0,position:"absolute",borderRadius:"12px 0 0 12px",boxShadow:s.customShadows.z8,bgcolor:s.palette.background.paper,border:`solid 1px ${s.palette.divider}`,"&:hover":{bgcolor:s.palette.background.neutral},...r&&{...!a&&{right:Ve}}},children:r?t.jsx(y,{width:16,icon:a?"eva:arrow-ios-back-fill":"eva:arrow-ios-forward-fill"}):t.jsx(y,{width:16,icon:"eva:arrow-ios-back-fill"})});return t.jsxs(H,{sx:{position:"relative"},children:[m,r?t.jsx(j,{sx:{height:1,flexShrink:0,width:Ve,borderLeft:`solid 1px ${s.palette.divider}`,transition:s.transitions.create(["width"],{duration:s.transitions.duration.shorter}),...a&&{width:0}},children:!a&&f}):t.jsx(zt,{anchor:"right",open:c,onClose:d,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:Ve}},children:f})]})}cn.propTypes={conversation:R.object,participants:R.array};function ln({message:e,participants:n,onOpenLightbox:s}){const{user:r}=Se(),{me:a,senderDetails:o,hasImage:i}=Mr({message:e,participants:n,currentUserId:r.id}),{firstName:c,avatarUrl:h}=o,{body:d,createdAt:g}=e,x=t.jsxs(G,{noWrap:!0,variant:"caption",sx:{mb:1,color:"text.disabled",...!a&&{mr:"auto"}},children:[!a&&`${c},`," Â ",us(new Date(g),{addSuffix:!0})]}),v=t.jsx(j,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral",...a&&{color:"grey.800",bgcolor:"primary.lighter"},...i&&{p:0,bgcolor:"transparent"}},children:i?t.jsx(H,{component:"img",alt:"attachment",src:d,onClick:()=>s(d),sx:{minHeight:220,borderRadius:1.5,cursor:"pointer","&:hover":{opacity:.9}}}):d}),f=t.jsxs(j,{direction:"row",className:"message-actions",sx:{pt:.5,opacity:0,top:"100%",left:0,position:"absolute",transition:m=>m.transitions.create(["opacity"],{duration:m.transitions.duration.shorter}),...a&&{left:"unset",right:0}},children:[t.jsx(I,{size:"small",children:t.jsx(y,{icon:"solar:reply-bold",width:16})}),t.jsx(I,{size:"small",children:t.jsx(y,{icon:"eva:smiling-face-fill",width:16})}),t.jsx(I,{size:"small",children:t.jsx(y,{icon:"solar:trash-bin-trash-bold",width:16})})]});return t.jsxs(j,{direction:"row",justifyContent:a?"flex-end":"unset",sx:{mb:5},children:[!a&&t.jsx(B,{alt:c,src:h,sx:{width:32,height:32,mr:2}}),t.jsxs(j,{alignItems:"flex-end",children:[x,t.jsxs(j,{direction:"row",alignItems:"center",sx:{position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[v,f]})]})]})}ln.propTypes={message:R.object,onOpenLightbox:R.func,participants:R.array};function dn({messages:e=[],participants:n}){const{messagesEndRef:s}=Fr(e),r=e.filter(o=>o.contentType==="image").map(o=>({src:o.body})),a=os(r);return t.jsxs(t.Fragment,{children:[t.jsx(Te,{ref:s,sx:{px:3,py:5,height:1},children:t.jsx(H,{children:e.map(o=>t.jsx(ln,{message:o,participants:n,onOpenLightbox:()=>a.onOpen(o.body)},o.id))})}),t.jsx(as,{index:a.selected,slides:r,open:a.open,close:a.onClose})]})}dn.propTypes={messages:R.array,participants:R.array};function At(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=Math.random()*16|0;return(e==="x"?n:n&3|8).toString(16)})}function un({recipients:e,onAddRecipients:n,disabled:s,selectedConversationId:r}){const a=He(),{user:o}=Se(),i=l.useRef(null),[c,h]=l.useState(""),d=l.useMemo(()=>({id:o.id,role:o.role,email:o.email,address:o.address,name:o.displayName,lastActivity:new Date,avatarUrl:o.photoURL,phoneNumber:o.phoneNumber,status:"online"}),[o]),g=l.useMemo(()=>({id:At(),attachments:[],body:c,contentType:"text",createdAt:Jn(new Date,{minutes:1}),senderId:d.id}),[c,d.id]),x=l.useMemo(()=>({id:At(),messages:[g],participants:[...e,d],type:e.length>1?"GROUP":"ONE_TO_ONE",unreadCount:0}),[g,d,e]),v=l.useCallback(()=>{i.current&&i.current.click()},[]),f=l.useCallback(p=>{h(p.target.value)},[]),m=l.useCallback(async p=>{try{if(p.key==="Enter"){if(c)if(r)await Lr(r,g);else{const w=await Nr(x);a.push(`${je.dashboard.chat}?id=${w.conversation.id}`),n([])}h("")}}catch(w){console.error(w)}},[x,c,g,n,a,r]);return t.jsxs(t.Fragment,{children:[t.jsx(Pt,{value:c,onKeyUp:m,onChange:f,placeholder:"Type a message",disabled:s,startAdornment:t.jsx(I,{children:t.jsx(y,{icon:"eva:smiling-face-fill"})}),endAdornment:t.jsxs(j,{direction:"row",sx:{flexShrink:0},children:[t.jsx(I,{onClick:v,children:t.jsx(y,{icon:"solar:gallery-add-bold"})}),t.jsx(I,{onClick:v,children:t.jsx(y,{icon:"eva:attach-2-fill"})}),t.jsx(I,{children:t.jsx(y,{icon:"solar:microphone-bold"})})]}),sx:{px:1,height:56,flexShrink:0,borderTop:p=>`solid 1px ${p.palette.divider}`}}),t.jsx("input",{type:"file",ref:i,style:{display:"none"}})]})}un.propTypes={disabled:R.bool,onAddRecipients:R.func,recipients:R.array,selectedConversationId:R.string};function hn({participants:e}){const n=e.length>1,s=e[0],r=t.jsx(ms,{max:3,sx:{[`& .${Dt.avatar}`]:{width:32,height:32}},children:e.map(o=>t.jsx(B,{alt:o.name,src:o.avatarUrl},o.id))}),a=t.jsxs(j,{flexGrow:1,direction:"row",alignItems:"center",spacing:2,children:[t.jsx(ye,{variant:s.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(B,{src:s.avatarUrl,alt:s.name})}),t.jsx(Ee,{primary:s.name,secondary:s.status==="offline"?Qn(s.lastActivity):s.status,secondaryTypographyProps:{component:"span",...s.status!=="offline"&&{textTransform:"capitalize"}}})]});return t.jsxs(t.Fragment,{children:[n?r:a,t.jsx(j,{flexGrow:1}),t.jsx(I,{children:t.jsx(y,{icon:"solar:phone-bold"})}),t.jsx(I,{children:t.jsx(y,{icon:"solar:videocamera-record-bold"})}),t.jsx(I,{children:t.jsx(y,{icon:"eva:more-vertical-fill"})})]})}hn.propTypes={participants:R.array};function fn({contacts:e,onAddRecipients:n}){const[s,r]=l.useState(""),a=l.useCallback(o=>{r(""),n(o)},[n]);return t.jsxs(t.Fragment,{children:[t.jsx(G,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),t.jsx(Zn,{sx:{minWidth:320},multiple:!0,limitTags:3,popupIcon:null,disableCloseOnSelect:!0,noOptionsText:t.jsx(Vt,{query:s}),onChange:(o,i)=>a(i),onInputChange:(o,i)=>r(i),options:e,getOptionLabel:o=>o.name,isOptionEqualToValue:(o,i)=>o.id===i.id,renderInput:o=>t.jsx(Wt,{...o,placeholder:"+ Recipients"}),renderOption:(o,i,{selected:c})=>l.createElement("li",{...o,key:i.id},t.jsxs(H,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[t.jsx(B,{alt:i.name,src:i.avatarUrl,sx:{width:1,height:1}}),t.jsx(j,{alignItems:"center",justifyContent:"center",sx:{top:0,left:0,width:1,height:1,opacity:0,position:"absolute",bgcolor:h=>X(h.palette.grey[900],.8),transition:h=>h.transitions.create(["opacity"],{easing:h.transitions.easing.easeInOut,duration:h.transitions.duration.shorter}),...c&&{opacity:1,color:"primary.main"}},children:t.jsx(y,{icon:"eva:checkmark-fill"})})]},i.id),i.name),renderTags:(o,i)=>o.map((c,h)=>l.createElement(es,{...i({index:h}),key:c.id,label:c.name,avatar:t.jsx(B,{alt:c.name,src:c.avatarUrl}),size:"small",variant:"soft"}))})]})}fn.propTypes={contacts:R.array,onAddRecipients:R.func};function Jr(){const e=He(),{user:n}=Se(),r=ns().get("id")||"",[a,o]=l.useState([]),{contacts:i}=Ir(),{conversations:c,conversationsLoading:h}=Dr(),{conversation:d,conversationError:g}=Or(`${r}`),x=d?d.participants.filter(u=>u.id!==n.id):[];l.useEffect(()=>{(g||!r)&&e.push(je.dashboard.chat)},[g,e,r]);const v=l.useCallback(u=>{o(u)},[]),f=!!d,m=t.jsx(j,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:r?t.jsx(t.Fragment,{children:f&&t.jsx(hn,{participants:x})}):t.jsx(fn,{contacts:i,onAddRecipients:v})}),p=t.jsx(tn,{contacts:i,conversations:c,loading:h,selectedConversationId:r}),w=t.jsxs(j,{sx:{width:1,height:1,overflow:"hidden"},children:[t.jsx(dn,{messages:d==null?void 0:d.messages,participants:x}),t.jsx(un,{recipients:a,onAddRecipients:v,selectedConversationId:r,disabled:!a.length&&!r})]});return t.jsxs(H,{px:5,children:[t.jsx(G,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Support"}),t.jsxs(j,{component:is,direction:"row",sx:{height:"72vh"},children:[p,t.jsxs(j,{sx:{width:1,height:1,overflow:"hidden"},children:[m,t.jsxs(j,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:u=>`solid 1px ${u.palette.divider}`},children:[w,f&&t.jsx(cn,{conversation:d,participants:x})]})]})]})]})}function ro(){return t.jsxs(t.Fragment,{children:[t.jsx(ts,{children:t.jsx("title",{children:" Dashboard: Chat"})}),t.jsx(Jr,{})]})}export{ro as default};
