import{ab as E,ad as T,aD as M,ap as H,F as y,j as e,af as S,aE as q,ao as D,B as k,av as Y,aw as G,ae as c,ag as J,ah as U,ai as K,aj as V,aq as _,ar as v,as as j,ax as P,S as b,T as p,ay as Q,az as W,aF as X,aC as C,aG as Z,al as $,aH as ee,aA as g,W as te}from"./index-377edcf8.js";import{C as ae,B as re}from"./chart-5eb90dc5.js";import{C as R}from"./CardHeader-8b087335.js";import{T as se}from"./TableContainer-ae58973c.js";function L(o){const t=E(),h={show:!0,label:"Total",color:t.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight,lineHeight:t.typography.subtitle2.lineHeight},l={offsetY:8,color:t.palette.text.primary,fontSize:t.typography.h3.fontSize,fontWeight:t.typography.h3.fontWeight,lineHeight:t.typography.h3.lineHeight},d={colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],chart:{toolbar:{show:!1},zoom:{enabled:!1},foreColor:t.palette.text.disabled,fontFamily:t.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:t.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,fontSize:13,position:"top",horizontalAlign:"right",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:t.palette.text.primary}},plotOptions:{bar:{borderRadius:4,columnWidth:"28%",borderRadiusApplication:"end",borderRadiusWhenStacked:"last"},pie:{donut:{labels:{show:!0,value:l,total:h}}},radialBar:{track:{strokeWidth:"100%",background:T(t.palette.grey[500],.16)},dataLabels:{value:l,total:h}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.palette.divider,connectorColors:t.palette.divider}},polarArea:{rings:{strokeColor:t.palette.divider},spokes:{connectorColors:t.palette.divider}}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return M(d,o)}function B({title:o,subheader:t,chart:h,...l}){const{colors:d,categories:m,series:i,options:s}=h,n=H(),[x,u]=y.useState("2024"),f=L({colors:d,legend:{position:"top",horizontalAlign:"right"},xaxis:{categories:m},...s}),w=y.useCallback(a=>{n.onClose(),u(a)},[n]);return e.jsxs(e.Fragment,{children:[e.jsxs(S,{...l,children:[e.jsx(R,{title:o,subheader:t,action:e.jsxs(q,{onClick:n.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[x,e.jsx(D,{width:16,icon:n.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),i.map(a=>e.jsx(k,{sx:{mt:3,mx:3},children:a.year===x&&e.jsx(ae,{dir:"ltr",type:"area",series:a.data,options:f,height:364})},a.year))]}),e.jsx(Y,{open:n.open,onClose:n.onClose,sx:{width:140},children:i.map(a=>e.jsx(G,{selected:a.year===x,onClick:()=>w(a.year),children:a.year},a.year))})]})}B.propTypes={chart:c.object,subheader:c.string,title:c.string};function O({title:o,subheader:t,tableData:h,tableLabels:l,...d}){return e.jsxs(S,{...d,children:[e.jsx(R,{title:o,subheader:t,sx:{mb:3}}),e.jsx(se,{sx:{overflow:"unset"},children:e.jsx(J,{children:e.jsxs(U,{sx:{minWidth:640},children:[e.jsx(K,{headLabel:l}),e.jsx(V,{children:h.map(m=>e.jsx(z,{row:m},m.id))})]})})})]})}O.propTypes={subheader:c.string,tableData:c.array,tableLabels:c.array,title:c.string};function z({row:o}){return e.jsxs(_,{children:[e.jsx(v,{children:o.name}),e.jsx(v,{children:o.category}),e.jsx(v,{children:o.storeName}),e.jsx(v,{children:o.SKU}),e.jsx(v,{children:j(o.salePrice)})]})}z.propTypes={row:c.object};function A({title:o,percent:t,total:h,chart:l,sx:d,...m}){const i=E(),{colors:s=[i.palette.primary.light,i.palette.primary.main],series:n,options:x}=l;return L({colors:[s[1]],fill:{type:"gradient",gradient:{colorStops:[{offset:0,color:s[0]},{offset:100,color:s[1]}]}},chart:{animations:{enabled:!0},sparkline:{enabled:!0}},tooltip:{x:{show:!1},y:{formatter:u=>P(u),title:{formatter:()=>""}},marker:{show:!1}},...x}),b,D,t<0,{bgcolor:T(i.palette.success.main,.16),...t<0&&{color:"error.main",bgcolor:T(i.palette.error.main,.16)}},p,t>0,Q(t),k,e.jsx(S,{sx:{display:"flex",alignItems:"center",p:3,...d},...m,children:e.jsxs(k,{sx:{flexGrow:1},children:[e.jsx(p,{variant:"subtitle2",paragraph:!0,children:o}),e.jsx(p,{variant:"h3",gutterBottom:!0,children:P(h)})]})})}A.propTypes={chart:c.object,percent:c.number,sx:c.object,title:c.string,total:c.number};function F({title:o,sentAmount:t,currentBalance:h,orders:l=[],sx:d,...m}){const{user:i}=W(),s=X(),[n,x]=y.useState(""),[u,f]=y.useState([]),w=y.useCallback(async()=>{const{data:a}=await C.get("/payout",{params:{fName:i.displayName}});f(a),console.log(a)},[]);return y.useEffect(()=>{w()},[]),e.jsxs(S,{sx:{p:3,...d},...m,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:o}),!!n&&e.jsx(Z,{severity:"error",children:n}),e.jsxs(b,{spacing:2,children:[e.jsxs(p,{variant:"h3",children:["AED"," ",(l.reduce((a,r)=>a+r.totalAmount,0)*.2-u.reduce((a,r)=>a+r.amount,0)+u.reduce((a,r)=>r.status==="pending"?a+r.amount:a,0)).toFixed(2)," "]}),e.jsxs(b,{direction:"row",justifyContent:"space-between",children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Total Sales"}),e.jsxs(p,{variant:"body2",children:[" ",j(l.reduce((a,r)=>a+r.totalAmount,0))]})]}),e.jsxs(b,{direction:"row",justifyContent:"space-between",children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Commission (20%)"}),e.jsx(p,{variant:"body2",children:j(l.reduce((a,r)=>a+r.totalAmount,0)*.2)})]}),e.jsxs(b,{direction:"row",justifyContent:"space-between",children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Avalable Balance for requesting"}),e.jsxs(p,{variant:"body2",children:[" ",j(l.reduce((a,r)=>a+r.totalAmount,0)*.2-u.reduce((a,r)=>a+r.amount,0))]})]}),e.jsxs(b,{direction:"row",justifyContent:"space-between",children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Pending Request"}),e.jsxs(p,{variant:"body2",children:[" ",j(u.reduce((a,r)=>r.status==="pending"?a+r.amount:a,0))]})]}),e.jsxs(b,{direction:"row",justifyContent:"space-between",children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Total Earned"}),e.jsxs(p,{variant:"body2",children:[" ",j(u.reduce((a,r)=>r.status==="completed"?a+r.amount:a,0))]})]}),e.jsx(b,{direction:"row",spacing:1.5,children:e.jsx($,{fullWidth:!0,variant:"contained",color:"warning",onClick:()=>{l.reduce((a,r)=>a+r.totalAmount,0)*.2-u.reduce((a,r)=>a+r.amount,0)>10?(sessionStorage.setItem("amount",l.reduce((a,r)=>a+r.totalAmount,0)*.2),s("/payment")):x("You must have a minimum balance of AED 10 to request a payout.")},children:"Request For Payout"})})]})]})}F.propTypes={currentBalance:c.number,sentAmount:c.number,sx:c.object,title:c.string};function oe(){const o=E(),{user:t}=W(),[h,l]=y.useState([]),[d,m]=y.useState([]);return y.useEffect(()=>{(async()=>{try{const[s,n,x]=await Promise.all([C.get("products",{params:{userId:t.id}}),C.get("/orders"),C.get("/invoice")]),{products:u}=s.data,f=n.data,w=x.data,a=f.filter(r=>r.items.some(I=>u.some(N=>N.id===I.id)));m(a),l(u)}catch(s){console.error("An error occurred:",s)}})()},[t.id]),e.jsxs(k,{px:5,children:[e.jsx(ee,{heading:"Analytics",links:[{}],sx:{mb:{xs:3,md:5}}}),e.jsxs(g,{container:!0,spacing:3,sx:{position:"relative"},children:[e.jsx(re,{products:h}),e.jsx(g,{xs:12,md:4,children:e.jsx(A,{title:"Product Sold",percent:0,total:d.length,chart:{series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(A,{title:"Total Balance",percent:0,total:d.reduce((i,s)=>i+s.totalAmount,0),chart:{colors:[o.palette.info.light,o.palette.info.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(A,{title:"Sales Profit",percent:0,total:d.reduce((i,s)=>i+s.totalAmount,0)*.8,chart:{colors:[o.palette.warning.light,o.palette.warning.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:12,lg:12,children:e.jsx(B,{title:"Sales By Month",chart:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],series:[{year:"2024",data:[{name:"Total Income",data:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].map(i=>d.reduce((s,n)=>new Date(n.createdAt).getMonth()===new Date().getMonth()&&new Date(n.createdAt).getDate()===i?s+n.totalAmount:s,0))}]}]}})}),e.jsx(g,{xs:12,md:12,lg:12,children:e.jsx(B,{title:"Yearly Sales",chart:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[{year:"2024",data:[{name:"Total Income",data:[0,1,2,3,4,5,6,7,8,9,10,11].map(i=>d.reduce((s,n)=>new Date(n.createdAt).getMonth()===i?s+n.totalAmount:s,0))}]}]}})}),e.jsx(g,{xs:12,md:6,lg:8,children:e.jsx(O,{title:"Top Selling Products",tableData:h,tableLabels:[{id:"Product name",label:"Product Name"},{id:"category",label:"Category"},{id:"storeName",label:"Store Name"},{id:"sku",label:"SKU"},{id:"salePrice",label:"Sale Price"}]})}),e.jsx(g,{xs:12,md:6,lg:4,children:e.jsx(F,{title:"Current Balance",currentBalance:0,sentAmount:0,orders:d})})]})]})}function de(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:" Dashboard: Analytics"})}),e.jsx(oe,{})]})}export{de as default};
