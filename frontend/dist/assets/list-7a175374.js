import{aa as q,a4 as z,t as M,u as _,r as l,d as m,p,j as e,c as $,S as R,q as C,s as G,ac as J,L as K,ak as g,a9 as x,w as b,B as Q,W as X}from"./index-bc388b4b.js";import{C as Y}from"./confirm-dialog-51832c94.js";import{C as Z}from"./custom-breadcrumbs-0742cdec.js";import{u as ee,e as te}from"./use-table-103e1fa1.js";import{b as oe,T as ae,d as se,a as le,c as ne}from"./table-pagination-custom-d5281114.js";import{I as i,a as re,b as ie}from"./invoice-details-d70585ad.js";import{C as T}from"./Card-6273d280.js";import{T as ce,a as de}from"./Tabs-9c4a1cd9.js";import{T as ue}from"./TableContainer-f19f82b4.js";import{T as he,a as me}from"./TableBody-782e6f5f.js";import"./DialogTitle-b09f6b86.js";import"./DialogContent-3d9c6eea.js";import"./TableRow-c8f22017.js";import"./Checkbox-09455ac3.js";import"./KeyboardArrowRight-6d5a049c.js";import"./LastPage-5b4e3e9d.js";import"./format-number-3932d3e4.js";import"./yup-772954a9.js";import"./form-provider-23831877.js";import"./file-thumbnail-57a9fae4.js";import"./fade-295cf198.js";import"./transition-bee6630b.js";import"./image-8ef73bea.js";import"./address-list-dialog-0d3d8a62.js";const pe=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"status",label:"Status"},{id:""}],y={name:"",service:[],status:"all",startDate:null,endDate:null};function ge(){const r=q(),c=z(),o=ee({defaultOrderBy:"createDate"}),d=M(),{user:{id:S}}=_(),[f,I]=l.useState([]),[w,F]=l.useState([]),[a,j]=l.useState([]),k=async()=>{try{const{data:{products:t}}=await m.get("products",{params:{userId:S,perPage:100}});F(t.map(s=>s.id))}catch{alert("Error occurred while fetching products.")}},A=async()=>{try{const{data:t}=await m.get("invoice");I(t)}catch{}};l.useEffect(()=>{A(),k()},[]),l.useEffect(()=>{j(f.filter(t=>t.items.some(s=>w.includes(s.id))).reverse())},[f,w]);const[n,P]=l.useState(y);n.startDate&&n.endDate&&n.startDate.getTime()>n.endDate.getTime();const B=o.dense?56:76,D=!!n.name||!!n.service.length||n.status!=="all"||!!n.startDate&&!!n.endDate,E=!a.length&&D||!a.length,u=t=>a.filter(s=>s.status===t).length,L=[{value:"all",label:"All",color:"default",count:a.length},{value:"paid",label:"Paid",color:"success",count:u("paid")},{value:"pending",label:"Pending",color:"warning",count:u("pending")},{value:"overdue",label:"Overdue",color:"error",count:u("overdue")},{value:"draft",label:"Draft",color:"default",count:u("draft")}],v=l.useCallback((t,s)=>{o.onResetPage(),P(h=>({...h,[t]:s}))},[o]),H=l.useCallback(t=>{m.delete("invoice",{data:{id:t}}).then(h=>{alert("Invoice in deleted")});const s=a.filter(h=>h.id!==t);j(s),o.onUpdatePageDeleteRow(a.length)},[a.length,o,a]),O=l.useCallback(()=>{m.delete("invoice",{data:{id:o.selected}}).then(s=>{alert("Invoice in deleted")});const t=a.filter(s=>!o.selected.includes(s.id));j(t),o.onUpdatePageDeleteRows({totalRows:a.length,totalRowsInPage:a.length,totalRowsFiltered:a.length})},[a.length,a.length,o,a]),V=l.useCallback(t=>{c.push(p.dashboard.invoice.edit(t))},[c]),N=l.useCallback(t=>{c.push(p.dashboard.invoice.details(t))},[c]),U=l.useCallback((t,s)=>{v("status",s)},[v]),W=l.useCallback(()=>{P(y)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs($,{px:5,children:[e.jsx(Z,{heading:"Invoice",links:[{name:"Dashboard",href:p.dashboard.root},{name:"Invoice",href:p.dashboard.invoice.root}],sx:{mb:{xs:3,md:5}}}),e.jsx(T,{sx:{mb:{xs:3,md:5}},children:e.jsx(R,{children:e.jsxs(C,{direction:"row",divider:e.jsx(G,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[e.jsx(i,{title:"Total",total:0,percent:0,price:0,icon:"solar:bill-list-bold-duotone",color:r.palette.info.main}),e.jsx(i,{title:"Paid",total:0,percent:0,price:0,icon:"solar:file-check-bold-duotone",color:r.palette.success.main}),e.jsx(i,{title:"Pending",total:0,percent:0,price:0,icon:"solar:sort-by-time-bold-duotone",color:r.palette.warning.main}),e.jsx(i,{title:"Overdue",total:0,percent:0,price:0,icon:"solar:bell-bing-bold-duotone",color:r.palette.error.main}),e.jsx(i,{title:"Draft",total:0,percent:0,price:0,icon:"solar:file-corrupted-bold-duotone",color:r.palette.text.secondary})]})})}),e.jsxs(T,{children:[e.jsx(ce,{value:n.status,onChange:U,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${J(r.palette.grey[500],.08)}`},children:L.map(t=>e.jsx(de,{value:t.value,label:t.label,iconPosition:"end",icon:e.jsx(K,{variant:(t.value==="all"||t.value===n.status)&&"filled"||"soft",color:t.color,children:"0"})},t.value))}),D&&e.jsx(re,{filters:n,onFilters:v,onResetFilters:W,results:a.length,sx:{p:2.5,pt:0}}),e.jsxs(ue,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(oe,{dense:o.dense,numSelected:o.selected.length,rowCount:a.length,onSelectAllRows:t=>o.onSelectAllRows(t,a.map(s=>s.id)),action:e.jsxs(C,{direction:"row",children:[e.jsx(g,{title:"Sent",children:e.jsx(x,{color:"primary",children:e.jsx(b,{icon:"iconamoon:send-fill"})})}),e.jsx(g,{title:"Download",children:e.jsx(x,{color:"primary",children:e.jsx(b,{icon:"eva:download-outline"})})}),e.jsx(g,{title:"Print",children:e.jsx(x,{color:"primary",children:e.jsx(b,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(g,{title:"Delete",children:e.jsx(x,{color:"primary",onClick:d.onTrue,children:e.jsx(b,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(R,{children:e.jsxs(he,{size:o.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(ae,{order:o.order,orderBy:o.orderBy,headLabel:pe,rowCount:a.length,numSelected:o.selected.length,onSort:o.onSort,onSelectAllRows:t=>o.onSelectAllRows(t,a.map(s=>s.id))}),e.jsxs(me,{children:[a.slice(o.page*o.rowsPerPage,o.page*o.rowsPerPage+o.rowsPerPage).map(t=>e.jsx(ie,{row:t,selected:o.selected.includes(t.id),onSelectRow:()=>o.onSelectRow(t.id),onViewRow:()=>N(t.id),onEditRow:()=>V(t.id),onDeleteRow:()=>H(t.id)},t.id)),e.jsx(se,{height:B,emptyRows:te(o.page,o.rowsPerPage,a.length)}),e.jsx(le,{notFound:E})]})]})})]}),e.jsx(ne,{count:a.length,page:o.page,rowsPerPage:o.rowsPerPage,onPageChange:o.onChangePage,onRowsPerPageChange:o.onChangeRowsPerPage,dense:o.dense,onChangeDense:o.onChangeDense})]})]}),e.jsx(Y,{open:d.value,onClose:d.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",o.selected.length," "]})," items?"]}),action:e.jsx(Q,{variant:"contained",color:"error",onClick:()=>{O(),d.onFalse()},children:"Delete"})})]})}function Ue(){return e.jsxs(e.Fragment,{children:[e.jsx(X,{children:e.jsx("title",{children:" Dashboard: Invoice List"})}),e.jsx(ge,{})]})}export{Ue as default};
