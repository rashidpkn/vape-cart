import{b3 as ce,aC as le,F as a,b2 as A,j as e,B as u,aq as D,S as i,aT as de,bR as ue,bS as pe,bT as me,at as xe,al as g,T as b,ak as E,az as he,af as je,aA as ge,am as be}from"./index-c7e94a78.js";import{u as fe,F as ye}from"./form-provider-d67f7eb8.js";import{p as we}from"./product-details-description-205cb67b.js";import{R as Pe}from"./Rating-e2ab1ebf.js";import{G as T}from"./Grid-3487b407.js";function Re({cart:p,product:m,onAddCart:d,onGotoStep:z,disabledActions:F,setProduct:L,similarProduct:V=[],...B}){var R;const N=ce(),O=le(),{id:f,name:n,regularPrice:G,quantity:Q,salePrice:x,totalRatings:W,totalReviews:$,subDescription:y,images:M,userId:h,type:j,productGroup:w,variables:P}=m,[S,H]=a.useState([]),J=async()=>{if(j==="Variable"&&w==="parent"){const{data:s}=await ge.get("/products",{params:{perPage:2e3}});H(s.products)}};a.useEffect(()=>{J()},[]);const K=(R=p==null?void 0:p.map(s=>s.id))==null?void 0:R.includes(f),v={id:f,name:n,quantity:1,price:x,images:M},C=fe({defaultValues:v}),{reset:U,watch:X,handleSubmit:Y}=C,o=X();a.useEffect(()=>{m&&U(v)},[m]);const Z=Y(async s=>{try{K||d({...s,colors:[o.colors],subTotal:s.price*s.quantity,userId:h}),z(0),N.push(A.product.checkout)}catch(r){console.error(r)}}),_=a.useCallback(()=>{try{d({...o,subTotal:o.price,userId:h}),console.log(o)}catch(s){console.error(s)}},[d,o]),ee=e.jsxs(u,{sx:{typography:"h5"},children:[x&&e.jsx(u,{component:"span",sx:{color:"text.disabled",textDecoration:"line-through",mr:.5},children:D(G)}),D(x)]}),se=e.jsxs(i,{direction:"row",children:[e.jsx(b,{variant:"subtitle2",sx:{flexGrow:1},children:"Quantity"}),e.jsx(i,{spacing:1,children:e.jsxs(b,{variant:"caption",component:"div",sx:{textAlign:"right"},children:["Available: ",Q]})})]}),te=e.jsxs(i,{direction:"row",spacing:2,children:[e.jsx(g,{fullWidth:!0,size:"large",color:"warning",variant:"contained",startIcon:e.jsx(be,{icon:"solar:cart-plus-bold",width:24}),onClick:_,sx:{whiteSpace:"nowrap"},children:"Add to Cart"}),e.jsx(g,{fullWidth:!0,size:"large",type:"submit",variant:"contained",disabled:F,children:"Buy Now"})]}),re=!!y&&we(y),ae=e.jsxs(i,{direction:"row",alignItems:"center",sx:{color:"text.disabled",typography:"body2"},children:[e.jsx(Pe,{size:"small",value:W,precision:.1,readOnly:!0,sx:{mr:1}}),`(${de($)} reviews)`]}),[c,ie]=a.useState({}),[k,I]=a.useState("");a.useEffect(()=>{I("");let s=n.split(" -")[0];Object.keys(c).map(t=>s=s+" - "+c[t]);const r=S.find(t=>t.name.toLowerCase().includes(s.toLowerCase()));r&&L(t=>({...t,name:r.name,images:r.images,quantity:r.quantity,salePrice:r.salePrice,regularPrice:r.regularPrice}))},[c]);const ne=j==="Variable"&&w==="parent"&&e.jsxs(u,{display:"flex",flexDirection:"column",gap:"10px",children:[Object.keys(P).map((s,r)=>e.jsxs(ue,{sx:{width:"50%"},size:"small",children:[e.jsx(pe,{id:"demo-simple-select-label",children:s}),e.jsx(me,{label:s,onChange:t=>{ie(l=>({...l,[s]:t.target.value}))},children:P[s].map((t,l)=>e.jsx(xe,{value:t,children:t},l))},r)]})),e.jsx(g,{sx:{width:"50%"},variant:"contained",color:"success",disabled:!n.split("-")[1],onClick:()=>{let s=n.split(" -")[0];Object.keys(c).map(t=>s=s+" - "+c[t]);const r=S.find(t=>t.name.toLowerCase().includes(s.toLowerCase()));if(r){const{id:t,name:l,salePrice:q,images:oe}=r;d({id:t,name:l,price:q,images:oe,subTotal:q,userId:h,quantity:1}),O(A.product.checkout)}else I("Out of stock")},children:"Buy"}),!!k&&e.jsx("p",{style:{color:"#F00A"},children:k})]});return e.jsx(ye,{methods:C,onSubmit:Z,children:e.jsxs(i,{spacing:3,sx:{pt:3},...B,children:[e.jsxs(i,{spacing:2,alignItems:"flex-start",children:[e.jsx(b,{variant:"h5",children:n}),ae,ee,re]}),ne,e.jsx(E,{sx:{borderStyle:"dashed"}}),se,e.jsxs(u,{children:[e.jsx("h4",{children:"Products related to this item"}),e.jsx(T,{container:!0,gap:1,justifyContent:"center",mt:2,children:V.map(s=>e.jsx(T,{item:!0,xs:5.5,component:he,to:`/product/${s.id}`,children:e.jsxs(je,{children:[e.jsx("img",{src:s.images[0],width:"100%"}),e.jsxs(i,{direction:"row",sx:{fontSize:"16px"},justifyContent:"space-between",alignItems:"center",px:.5,children:[e.jsx("p",{children:s.name}),e.jsxs("p",{children:["AED ",s.salePrice]})]})]})},s.id))})]}),e.jsx(E,{sx:{borderStyle:"dashed"}}),j==="Simple"&&te]})})}export{Re as P};
