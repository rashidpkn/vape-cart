import{aa as T,r as i,u as S,z as y,k as b,p,j as t,d as k,e as B,B as w,ah as D,G as x,C as F,aA as A,aB as E,ak as I,S as L,W as O}from"./index-eb686811.js";import{P as v,a as U}from"./product-table-toolbar-ba7192bc.js";import{u as _,g as q}from"./use-table-12f4ae3d.js";import{b as z,T as H,c as N}from"./table-pagination-custom-b462100f.js";import{C as W}from"./confirm-dialog-d2ad38cd.js";import{T as $}from"./TableContainer-99ecad68.js";import{T as G,d as K}from"./TableRow-a509ccfe.js";import"./LastPage-0c8e03f9.js";const Q=[{id:"name",label:"Product"},{id:"createdAt",label:"Create at",width:160},{id:"Product Type",label:"Product Type",width:160},{id:"inventoryType",label:"Stock",width:160},{id:"price",label:"Price",width:140},{id:"sales Price",label:"Sales Price",width:140},{id:"status",label:"Status",width:110},{id:"quickEdit",label:"Quick Edit",width:110},{id:"",width:88}],V=[{value:"published",label:"Published"},{value:"draft",label:"Draft"}],J={name:"",stock:""};function M(){const n=T(),e=_(),[a,c]=i.useState([]),[h,g]=i.useState(J),{user:{id:o}}=S(),l=async()=>{try{const{data:{products:s}}=await b.get("products",{params:{userId:o,perPage:5e3}});s!=null&&s.length&&c(s)}catch(s){console.log(`Error : ${s}`)}};i.useEffect(()=>{l()},[]);const d=y(),u=X({inputData:a,comparator:q(e.order,e.orderBy),filters:h}),m=u.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage),f=i.useCallback((s,r)=>{e.onResetPage(),g(P=>({...P,[s]:r}))},[e]),C=i.useCallback(async s=>{try{await b.delete(`products/${s}`);const r=a.filter(P=>P.id!==s);c(r),e.onUpdatePageDeleteRow(m.length)}catch(r){alert(r.response.data.message)}},[m.length,e,a]),j=i.useCallback(async()=>{try{await b.delete("products",{data:{ids:e.selected}});const s=a.filter(r=>!e.selected.includes(r.id));c(s),e.onUpdatePageDeleteRows({totalRows:a.length,totalRowsInPage:m.length,totalRowsFiltered:u.length})}catch(s){alert(s.response.data.message)}},[u.length,m.length,e,a]),R=i.useCallback(s=>{n.push(p.dashboard.product.edit(s))},[n]);return t.jsxs(t.Fragment,{children:[t.jsxs(k,{px:5,children:[t.jsx(B,{heading:"Products",links:[{name:"Dashboard",href:p.dashboard.root},{name:"Products",href:p.dashboard.product.root}],action:t.jsx(w,{component:D,href:p.dashboard.product.new,variant:"contained",startIcon:t.jsx(x,{icon:"mingcute:add-line"}),children:"New Product"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(F,{children:[t.jsx(v,{filters:h,onFilters:f,stockOptions:A,publishOptions:V}),t.jsxs($,{sx:{position:"relative",overflow:"unset"},children:[t.jsx(z,{dense:e.dense,numSelected:e.selected.length,rowCount:a.length,onSelectAllRows:s=>e.onSelectAllRows(s,a.map(r=>r.id)),action:t.jsx(E,{title:"Delete",children:t.jsx(I,{color:"primary",onClick:d.onTrue,children:t.jsx(x,{icon:"solar:trash-bin-trash-bold"})})})}),t.jsx(L,{children:t.jsxs(G,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(H,{order:e.order,orderBy:e.orderBy,headLabel:Q,rowCount:a.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:s=>e.onSelectAllRows(s,a.map(r=>r.id))}),t.jsx(K,{children:t.jsx(t.Fragment,{children:u.map(s=>t.jsx(U,{row:s,selected:e.selected.includes(s.id),onSelectRow:()=>e.onSelectRow(s.id),onDeleteRow:()=>C(s.id),onEditRow:()=>R(s.id),fetchProduct:l},s.id))})})]})})]}),t.jsx(N,{count:u.length,page:e.page,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onRowsPerPageChange:e.onChangeRowsPerPage,dense:e.dense,onChangeDense:e.onChangeDense})]})]}),t.jsx(W,{open:d.value,onClose:d.onFalse,title:"Delete",content:t.jsxs(t.Fragment,{children:["Are you sure want to delete ",t.jsxs("strong",{children:[" ",e.selected.length," "]})," items?"]}),action:t.jsx(w,{variant:"contained",color:"error",onClick:()=>{j(),d.onFalse()},children:"Delete"})})]})}function X({inputData:n,comparator:e,filters:a}){const{name:c,stock:h}=a,g=n.map((o,l)=>[o,l]);return g.sort((o,l)=>{const d=e(o[0],l[0]);return d!==0?d:o[1]-l[1]}),n=g.map(o=>o[0]),c&&(n=n.filter(o=>o.name.toLowerCase().indexOf(c.toLowerCase())!==-1)),h.length&&(n=n.filter(o=>h[0]==="in stock"?!!o.quantity:!o.quantity)),n}function ne(){return t.jsxs(t.Fragment,{children:[t.jsx(O,{children:t.jsx("title",{children:" Dashboard: Product List"})}),t.jsx(M,{})]})}export{ne as default};
