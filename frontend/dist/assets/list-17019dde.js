import{j as t,ap as I,aq as O,S as v,F as l,b6 as V,aV as U,ax as z,b7 as H,b8 as _,aB as f,b3 as m,B as N,aG as W,am as C,b0 as q,an as S,af as G,b9 as K,b1 as M,b2 as $,ah as J,ai as Q,aj as X,ak as Y,ba as Z,W as ee}from"./index-d7ea55b0.js";import{d as te,e as se,f as oe}from"./product-details-description-c1bc25e1.js";import{a as re}from"./_product-4b9af32b.js";import{S as g,u as ae,f as ne,e as le}from"./axios-5867f660.js";import{u as ie,g as de}from"./use-table-21925473.js";import{C as ce}from"./confirm-dialog-50bf187a.js";import{T as ue}from"./TableContainer-d4018a01.js";import"./form-provider-6d5025b8.js";import"./Switch-7551d16b.js";import"./transition-bee6630b.js";import"./image-de93d9ae.js";import"./yup-bd3f9a05.js";import"./CircularProgress-95ab692b.js";import"./color-picker-24604231.js";import"./Rating-ab68f8be.js";import"./DialogTitle-e4e2271e.js";import"./DialogContent-852935a2.js";import"./lightbox-f0df0b04.js";import"./carousel-arrow-index-26534453.js";function he({...o}){return t.jsx(I,{...o,children:t.jsx(O,{colSpan:12,children:t.jsxs(v,{spacing:3,direction:"row",alignItems:"center",children:[t.jsx(g,{sx:{borderRadius:1.5,width:48,height:48,flexShrink:0}}),t.jsx(g,{sx:{width:1,height:12}}),t.jsx(g,{sx:{width:180,height:12}}),t.jsx(g,{sx:{width:160,height:12}}),t.jsx(g,{sx:{width:140,height:12}}),t.jsx(g,{sx:{width:120,height:12}})]})})})}function pe(){const o=le.product.list,{data:e,isLoading:r,error:d,isValidating:i}=ae(o,ne);return l.useMemo(()=>({products:(e==null?void 0:e.products)||[],productsLoading:r,productsError:d,productsValidating:i,productsEmpty:!r&&!(e!=null&&e.products.length)}),[e==null?void 0:e.products,d,r,i])}const ge=[{id:"name",label:"Product"},{id:"createdAt",label:"Create at",width:160},{id:"inventoryType",label:"Stock",width:160},{id:"price",label:"Price",width:140},{id:"publish",label:"Publish",width:110},{id:"",width:88}],me=[{value:"published",label:"Published"},{value:"draft",label:"Draft"}],j={name:"",publish:[],stock:[]};function be(){const o=V(),e=ie();U();const[r,d]=l.useState([]),[i,u]=l.useState(j),{productsLoading:b,productsEmpty:n}=pe(),[c,x]=l.useState([]),{user:{id:T}}=z();l.useEffect(()=>{(async()=>{try{const{data:{products:a,count:p}}=await f.get("products",{params:{userId:T,perPage:5e3}});x(a)}catch{alert("error Occure")}})()},[]);const w=H();l.useEffect(()=>{c.length&&d(c)},[c]);const h=xe({inputData:r,comparator:de(e.order,e.orderBy),filters:i}),P=h.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage),y=e.dense?60:80,k=!_(j,i),R=l.useCallback((s,a)=>{e.onResetPage(),u(p=>({...p,[s]:a}))},[e]),F=l.useCallback(async s=>{try{const a=await f.delete(`products/${s}`),p=r.filter(D=>D.id!==s);d(p),e.onUpdatePageDeleteRow(P.length)}catch(a){alert(a.response.data.message)}},[P.length,e,r]),B=l.useCallback(async()=>{try{const s=await f.delete("products",{data:{ids:e.selected}}),a=r.filter(p=>!e.selected.includes(p.id));d(a),e.onUpdatePageDeleteRows({totalRows:r.length,totalRowsInPage:P.length,totalRowsFiltered:h.length})}catch(s){alert(s.response.data.message)}},[h.length,P.length,e,r]),L=l.useCallback(s=>{o.push(m.dashboard.product.edit(s))},[o]),E=l.useCallback(s=>{o.push(m.dashboard.product.details(s))},[o]),A=l.useCallback(()=>{u(j)},[]);return t.jsxs(t.Fragment,{children:[t.jsxs(N,{px:5,children:[t.jsx(W,{heading:"Products",links:[{name:"Dashboard",href:m.dashboard.root},{name:"Products",href:m.dashboard.product.root}],action:t.jsx(C,{component:q,href:m.dashboard.product.new,variant:"contained",startIcon:t.jsx(S,{icon:"mingcute:add-line"}),children:"New Product"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(G,{children:[t.jsx(te,{filters:i,onFilters:R,stockOptions:re,publishOptions:me}),k&&t.jsx(se,{filters:i,onFilters:R,onResetFilters:A,results:h.length,sx:{p:2.5,pt:0}}),t.jsxs(ue,{sx:{position:"relative",overflow:"unset"},children:[t.jsx(K,{dense:e.dense,numSelected:e.selected.length,rowCount:r.length,onSelectAllRows:s=>e.onSelectAllRows(s,r.map(a=>a.id)),action:t.jsx(M,{title:"Delete",children:t.jsx($,{color:"primary",onClick:w.onTrue,children:t.jsx(S,{icon:"solar:trash-bin-trash-bold"})})})}),t.jsx(J,{children:t.jsxs(Q,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(X,{order:e.order,orderBy:e.orderBy,headLabel:ge,rowCount:r.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:s=>e.onSelectAllRows(s,r.map(a=>a.id))}),t.jsx(Y,{children:b?[...Array(e.rowsPerPage)].map((s,a)=>t.jsx(he,{sx:{height:y}},a)):t.jsx(t.Fragment,{children:h.map(s=>t.jsx(oe,{row:s,selected:e.selected.includes(s.id),onSelectRow:()=>e.onSelectRow(s.id),onDeleteRow:()=>F(s.id),onEditRow:()=>L(s.id),onViewRow:()=>E(s.id)},s.id))})})]})})]}),t.jsx(Z,{count:h.length,page:e.page,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onRowsPerPageChange:e.onChangeRowsPerPage,dense:e.dense,onChangeDense:e.onChangeDense})]})]}),t.jsx(ce,{open:w.value,onClose:w.onFalse,title:"Delete",content:t.jsxs(t.Fragment,{children:["Are you sure want to delete ",t.jsxs("strong",{children:[" ",e.selected.length," "]})," items?"]}),action:t.jsx(C,{variant:"contained",color:"error",onClick:()=>{B(),w.onFalse()},children:"Delete"})})]})}function xe({inputData:o,comparator:e,filters:r}){const{name:d,stock:i,publish:u}=r,b=o.map((n,c)=>[n,c]);return b.sort((n,c)=>{const x=e(n[0],c[0]);return x!==0?x:n[1]-c[1]}),o=b.map(n=>n[0]),d&&(o=o.filter(n=>n.name.toLowerCase().indexOf(d.toLowerCase())!==-1)),i.length&&(o=o.filter(n=>i.includes(n.inventoryType))),u.length&&(o=o.filter(n=>u.includes(n.publish))),o}function Ve(){return t.jsxs(t.Fragment,{children:[t.jsx(ee,{children:t.jsx("title",{children:" Dashboard: Product List"})}),t.jsx(be,{})]})}export{Ve as default};
