import{E as gt,D as g,da as Gt,db as Yt}from"./index-fa50bb9d.js";import{a as Xt}from"./axios-d5068281.js";const M=()=>{},b=M(),ut=Object,a=t=>t===b,P=t=>typeof t=="function",U=(t,e)=>({...t,...e}),Qt=t=>P(t.then),ot=new WeakMap;let Zt=0;const Z=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let s,i;if(ut(t)===t&&!r&&n!=RegExp){if(s=ot.get(t),s)return s;if(s=++Zt+"~",ot.set(t,s),n==Array){for(s="@",i=0;i<t.length;i++)s+=Z(t[i])+",";ot.set(t,s)}if(n==ut){s="#";const c=ut.keys(t).sort();for(;!a(i=c.pop());)a(t[i])||(s+=i+":"+Z(t[i])+",");ot.set(t,s)}}else s=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},W=new WeakMap,lt={},rt={},wt="undefined",it=typeof window!=wt,ht=typeof document!=wt,te=()=>it&&typeof window.requestAnimationFrame!=wt,Wt=(t,e)=>{const n=W.get(t);return[()=>!a(e)&&t.get(e)||lt,r=>{if(!a(e)){const s=t.get(e);e in rt||(rt[e]=s),n[5](e,U(s,r),s||lt)}},n[6],()=>!a(e)&&e in rt?rt[e]:!a(e)&&t.get(e)||lt]};let pt=!0;const ee=()=>pt,[Rt,mt]=it&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],ne=()=>{const t=ht&&document.visibilityState;return a(t)||t!=="hidden"},se=t=>(ht&&document.addEventListener("visibilitychange",t),Rt("focus",t),()=>{ht&&document.removeEventListener("visibilitychange",t),mt("focus",t)}),oe=t=>{const e=()=>{pt=!0,t()},n=()=>{pt=!1};return Rt("online",e),Rt("offline",n),()=>{mt("online",e),mt("offline",n)}},re={isOnline:ee,isVisible:ne},ie={initFocus:se,initReconnect:oe},yt=!gt.useId,tt=!it||"Deno"in window,ae=t=>te()?window.requestAnimationFrame(t):setTimeout(t,1),ft=tt?g.useEffect:g.useLayoutEffect,dt=typeof navigator<"u"&&navigator.connection,Nt=!tt&&dt&&(["slow-2g","2g"].includes(dt.effectiveType)||dt.saveData),Tt=t=>{if(P(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Z(t):"",[t,e]};let ce=0;const _t=()=>++ce,Pt=0,Mt=1,Ut=2,ue=3;var Q={__proto__:null,ERROR_REVALIDATE_EVENT:ue,FOCUS_EVENT:Pt,MUTATE_EVENT:Ut,RECONNECT_EVENT:Mt};async function qt(...t){const[e,n,r,s]=t,i=U({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let c=i.populateCache;const E=i.rollbackOnError;let d=i.optimisticData;const I=i.revalidate!==!1,R=O=>typeof E=="function"?E(O):E!==!1,m=i.throwOnError;if(P(n)){const O=n,w=[],v=e.keys();for(const V of v)!/^\$(inf|sub)\$/.test(V)&&O(e.get(V)._k)&&w.push(V);return Promise.all(w.map(L))}return L(n);async function L(O){const[w]=Tt(O);if(!w)return;const[v,V]=Wt(e,w),[o,k,Y,q]=W.get(e),H=()=>{const S=o[w];return I&&(delete Y[w],delete q[w],S&&S[0])?S[0](Ut).then(()=>v().data):v().data};if(t.length<3)return H();let T=r,C;const h=_t();k[w]=[h,0];const j=!a(d),y=v(),z=y.data,et=y._c,$=a(et)?z:et;if(j&&(d=P(d)?d($,z):d,V({data:d,_c:$})),P(T))try{T=T($)}catch(S){C=S}if(T&&Qt(T))if(T=await T.catch(S=>{C=S}),h!==k[w][0]){if(C)throw C;return T}else C&&j&&R(C)&&(c=!0,V({data:$,_c:b}));if(c&&!C)if(P(c)){const S=c(T,$);V({data:S,error:b,_c:b})}else V({data:T,error:b,_c:b});if(k[w][1]=_t(),Promise.resolve(H()).then(()=>{V({_c:b})}),C){if(m)throw C;return}return T}}const Ft=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},le=(t,e)=>{if(!W.has(t)){const n=U(ie,e),r={},s=qt.bind(b,t);let i=M;const c={},E=(R,m)=>{const L=c[R]||[];return c[R]=L,L.push(m),()=>L.splice(L.indexOf(m),1)},d=(R,m,L)=>{t.set(R,m);const O=c[R];if(O)for(const w of O)w(m,L)},I=()=>{if(!W.has(t)&&(W.set(t,[r,{},{},{},s,d,E]),!tt)){const R=n.initFocus(setTimeout.bind(b,Ft.bind(b,r,Pt))),m=n.initReconnect(setTimeout.bind(b,Ft.bind(b,r,Mt)));i=()=>{R&&R(),m&&m(),W.delete(t)}}};return I(),[t,s,I,i]}return[t,W.get(t)[4]]},fe=(t,e,n,r,s)=>{const i=n.errorRetryCount,c=s.retryCount,E=~~((Math.random()+.5)*(1<<(c<8?c:8)))*n.errorRetryInterval;!a(i)&&c>i||setTimeout(r,E,s)},de=(t,e)=>Z(t)==Z(e),[Ht,Ee]=le(new Map),he=U({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:fe,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Nt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Nt?5e3:3e3,compare:de,isPaused:()=>!1,cache:Ht,mutate:Ee,fallback:{}},re),pe=(t,e)=>{const n=U(t,e);if(e){const{use:r,fallback:s}=t,{use:i,fallback:c}=e;r&&i&&(n.use=r.concat(i)),s&&c&&(n.fallback=U(s,c))}return n},Re=g.createContext({}),me="$inf$",$t=it&&window.__SWR_DEVTOOLS_USE__,_e=$t?window.__SWR_DEVTOOLS_USE__:[],ge=()=>{$t&&(window.__SWR_DEVTOOLS_REACT__=gt)},we=t=>P(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Te=()=>U(he,g.useContext(Re)),Se=t=>(e,n,r)=>t(e,n&&((...i)=>{const[c]=Tt(e),[,,,E]=W.get(Ht);if(c.startsWith(me))return n(...i);const d=E[c];return a(d)?n(...i):(delete E[c],d)}),r),De=_e.concat(Se),be=t=>function(...n){const r=Te(),[s,i,c]=we(n),E=pe(r,c);let d=t;const{use:I}=E,R=(I||[]).concat(De);for(let m=R.length;m--;)d=R[m](d);return d(s,i||E.fetcher||null,E)},Oe=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s>=0&&(r[s]=r[r.length-1],r.pop())}};ge();const xt=gt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),Et={dedupe:!0},ve=(t,e,n)=>{const{cache:r,compare:s,suspense:i,fallbackData:c,revalidateOnMount:E,revalidateIfStale:d,refreshInterval:I,refreshWhenHidden:R,refreshWhenOffline:m,keepPreviousData:L}=n,[O,w,v,V]=W.get(r),[o,k]=Tt(t),Y=g.useRef(!1),q=g.useRef(!1),H=g.useRef(o),T=g.useRef(e),C=g.useRef(n),h=()=>C.current,j=()=>h().isVisible()&&h().isOnline(),[y,z,et,$]=Wt(r,o),S=g.useRef({}).current,jt=a(c)?n.fallback[o]:c,St=(u,l)=>{for(const _ in S){const f=_;if(f==="data"){if(!s(u[f],l[f])&&(!a(u[f])||!s(st,l[f])))return!1}else if(l[f]!==u[f])return!1}return!0},Dt=g.useMemo(()=>{const u=(()=>!o||!e?!1:a(E)?h().isPaused()||i?!1:a(d)?!0:d:E)(),l=D=>{const F=U(D);return delete F._k,u?{isValidating:!0,isLoading:!0,...F}:F},_=y(),f=$(),N=l(_),G=_===f?N:l(f);let p=N;return[()=>{const D=l(y());return St(D,p)?(p.data=D.data,p.isLoading=D.isLoading,p.isValidating=D.isValidating,p.error=D.error,p):(p=D,D)},()=>G]},[r,o]),B=Gt.useSyncExternalStore(g.useCallback(u=>et(o,(l,_)=>{St(_,l)||u()}),[r,o]),Dt[0],Dt[1]),bt=!Y.current,zt=O[o]&&O[o].length>0,J=B.data,K=a(J)?jt:J,nt=B.error,Ot=g.useRef(K),st=L?a(J)?Ot.current:J:K,vt=(()=>zt&&!a(nt)?!1:bt&&!a(E)?E:h().isPaused()?!1:i?a(K)?!1:d:a(K)||d)(),Ct=!!(o&&e&&bt&&vt),Bt=a(B.isValidating)?Ct:B.isValidating,Jt=a(B.isLoading)?Ct:B.isLoading,X=g.useCallback(async u=>{const l=T.current;if(!o||!l||q.current||h().isPaused())return!1;let _,f,N=!0;const G=u||{},p=!v[o]||!G.dedupe,D=()=>yt?!q.current&&o===H.current&&Y.current:o===H.current,F={isValidating:!1,isLoading:!1},It=()=>{z(F)},Lt=()=>{const A=v[o];A&&A[1]===f&&delete v[o]},Vt={isValidating:!0};a(y().data)&&(Vt.isLoading=!0);try{if(p&&(z(Vt),n.loadingTimeout&&a(y().data)&&setTimeout(()=>{N&&D()&&h().onLoadingSlow(o,n)},n.loadingTimeout),v[o]=[l(k),_t()]),[_,f]=v[o],_=await _,p&&setTimeout(Lt,n.dedupingInterval),!v[o]||v[o][1]!==f)return p&&D()&&h().onDiscarded(o),!1;F.error=b;const A=w[o];if(!a(A)&&(f<=A[0]||f<=A[1]||A[1]===0))return It(),p&&D()&&h().onDiscarded(o),!1;const x=y().data;F.data=s(x,_)?x:_,p&&D()&&h().onSuccess(_,o,n)}catch(A){Lt();const x=h(),{shouldRetryOnError:at}=x;x.isPaused()||(F.error=A,p&&D()&&(x.onError(A,o,x),(at===!0||P(at)&&at(A))&&j()&&x.onErrorRetry(A,o,x,Kt=>{const ct=O[o];ct&&ct[0]&&ct[0](Q.ERROR_REVALIDATE_EVENT,Kt)},{retryCount:(G.retryCount||0)+1,dedupe:!0})))}return N=!1,It(),!0},[o,r]),At=g.useCallback((...u)=>qt(r,H.current,...u),[]);if(ft(()=>{T.current=e,C.current=n,a(J)||(Ot.current=J)}),ft(()=>{if(!o)return;const u=X.bind(b,Et);let l=0;const f=Oe(o,O,(N,G={})=>{if(N==Q.FOCUS_EVENT){const p=Date.now();h().revalidateOnFocus&&p>l&&j()&&(l=p+h().focusThrottleInterval,u())}else if(N==Q.RECONNECT_EVENT)h().revalidateOnReconnect&&j()&&u();else{if(N==Q.MUTATE_EVENT)return X();if(N==Q.ERROR_REVALIDATE_EVENT)return X(G)}});return q.current=!1,H.current=o,Y.current=!0,z({_k:k}),vt&&(a(K)||tt?u():ae(u)),()=>{q.current=!0,f()}},[o]),ft(()=>{let u;function l(){const f=P(I)?I(y().data):I;f&&u!==-1&&(u=setTimeout(_,f))}function _(){!y().error&&(R||h().isVisible())&&(m||h().isOnline())?X(Et).then(l):l()}return l(),()=>{u&&(clearTimeout(u),u=-1)}},[I,R,m,o]),g.useDebugValue(st),i&&a(K)&&o){if(!yt&&tt)throw new Error("Fallback data is required when using suspense in SSR.");T.current=e,C.current=n,q.current=!1;const u=V[o];if(!a(u)){const l=At(u);xt(l)}if(a(nt)){const l=X(Et);a(st)||(l.status="fulfilled",l.value=!0),xt(l)}else throw nt}return{mutate:At,get data(){return S.data=!0,st},get error(){return S.error=!0,nt},get isValidating(){return S.isValidating=!0,Bt},get isLoading(){return S.isLoading=!0,Jt}}},Ie=be(ve),kt=Xt.create({baseURL:Yt});kt.interceptors.response.use(t=>t,t=>Promise.reject(t.response&&t.response.data||"Something went wrong"));const Le=async t=>{const[e,n]=Array.isArray(t)?t:[t];return(await kt.get(e,{...n})).data},Ve={chat:"/api/chat",kanban:"/api/kanban",calendar:"/api/calendar",auth:{me:"/api/auth/me",login:"/api/auth/login",register:"/api/auth/register"},mail:{list:"/api/mail/list",details:"/api/mail/details",labels:"/api/mail/labels"},post:{list:"/api/post/list",details:"/api/post/details",latest:"/api/post/latest",search:"/api/post/search"},product:{list:"/api/product/list",details:"/api/product/details",search:"/api/product/search"}};export{kt as a,Ve as e,Le as f,Ee as m,Ie as u};
