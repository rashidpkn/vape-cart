import{b7 as L,ao as V,j as e,ap as M,aq as j,bc as se,B as i,aH as E,aI as F,bd as U,ar as C,as as H,b2 as I,an as D,be as re,S as h,bf as te,at as _,au as N,am as q,ae as t,ax as oe,F as b,b6 as ae,aB as O,b3 as B,aG as ne,af as W,b4 as le,ad as ie,b5 as ce,b9 as de,b1 as he,ah as z,ai as pe,aj as xe,ak as ue,bg as ge,bh as me,ba as je,bb as be,bi as A,ag as ye,b0 as we,T as $,aT as fe}from"./index-1852df7c.js";import{C as Q}from"./confirm-dialog-0eadc3a3.js";import{u as Ce,g as Te,e as ve}from"./use-table-b995fc3c.js";import"./custom-date-range-picker-f47203af.js";import{T as Pe}from"./TableContainer-2ae25995.js";function G({row:a,selected:p,onViewRow:x,onSelectRow:u,onDeleteRow:g}){const{id:o,items:c,status:l,createdAt:y,customer:s,totalQuantity:w,subTotal:m}=a,d=L(),S=L(),T=V(),f=e.jsxs(M,{hover:!0,selected:p,children:[e.jsx(j,{padding:"checkbox",children:e.jsx(se,{checked:p,onClick:u})}),e.jsx(j,{children:e.jsxs(i,{onClick:x,sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:["#",o]})}),e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(E,{alt:s.name,src:s.avatarUrl,sx:{mr:2}}),e.jsx(F,{primary:s.name,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}})]}),e.jsx(j,{children:e.jsx(F,{primary:U(new Date(y),"dd MMM yyyy"),secondary:U(new Date(y),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(j,{align:"center",children:[" ",w," "]}),e.jsxs(j,{children:[" ",C(m)," "]}),e.jsxs(j,{children:[" ",C(m*.2)," "]}),e.jsx(j,{children:e.jsx(H,{variant:"soft",color:l==="completed"&&"success"||l==="pending"&&"warning"||l==="cancelled"&&"error"||"default",children:l})}),e.jsxs(j,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(I,{color:S.value?"inherit":"default",onClick:S.onToggle,sx:{...S.value&&{bgcolor:"action.hover"}},children:e.jsx(D,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(I,{color:T.open?"inherit":"default",onClick:T.onOpen,children:e.jsx(D,{icon:"eva:more-vertical-fill"})})]})]}),P=e.jsx(M,{children:e.jsx(j,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(re,{in:S.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(h,{component:te,sx:{m:1.5},children:c.map(v=>e.jsxs(h,{direction:"row",alignItems:"center",sx:{p:k=>k.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:k=>`solid 2px ${k.palette.background.neutral}`}},children:[e.jsx(E,{src:v.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(F,{primary:v.name,secondary:v.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(i,{children:["x",v.quantity]}),e.jsx(i,{sx:{width:110,textAlign:"right"},children:C(v.salePrice)})]},v.id))})})})});return e.jsxs(e.Fragment,{children:[f,P,e.jsxs(_,{open:T.open,onClose:T.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(N,{onClick:()=>{x(),T.onClose()},children:[e.jsx(D,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(N,{onClick:()=>{d.onTrue(),T.onClose()},sx:{color:"error.main"},children:[e.jsx(D,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]}),e.jsx(Q,{open:d.value,onClose:d.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(q,{variant:"contained",color:"error",onClick:g,children:"Delete"})})]})}G.propTypes={onDeleteRow:t.func,onSelectRow:t.func,onViewRow:t.func,row:t.object,selected:t.bool};t.bool,t.object,t.func,t.func;t.object,t.func,t.func,t.number;t.node,t.string,t.object;const Re=[{value:"all",label:"All"},...be],De=[{id:"orderNumber",label:"Order",width:116},{id:"name",label:"Customer"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"commission",label:"Commission",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}],Se={name:"",status:"all",startDate:null,endDate:null};function Ne(){const{user:{id:a}}=oe(),[p,x]=b.useState([]),[u,g]=b.useState([]),[o,c]=b.useState([]),l=async()=>{try{const{data:{products:r}}=await O.get("products",{params:{userId:a,perPage:100}});g(r.map(n=>n.id))}catch{alert("Error occurred while fetching products.")}},y=async()=>{try{const{data:r}=await O.get("/orders");x(r)}catch(r){console.log(r.message)}};b.useEffect(()=>{l(),y()},[]),b.useEffect(()=>{c(p.filter(r=>r.items.some(n=>u.includes(n.id))).reverse())},[p,u]);const s=Ce({defaultOrderBy:"orderNumber"}),w=ae(),m=L(),[d,S]=b.useState(Se),T=d.startDate&&d.endDate?d.startDate.getTime()>d.endDate.getTime():!1,f=ke({inputData:o,comparator:Te(s.order,s.orderBy),filters:d,dateError:T}),P=f.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),v=s.dense?52:72,k=!!d.name||d.status!=="all"||!!d.startDate&&!!d.endDate,J=!f.length&&k||!f.length,K=b.useCallback(r=>{O.delete("orders",{data:{id:r}});const n=o.filter(ee=>ee.id!==r);c(n),s.onUpdatePageDeleteRow(P.length)},[P.length,s,o]),X=b.useCallback(()=>{O.delete("orders",{data:{id:s.selected}});const r=o.filter(n=>!s.selected.includes(n.id));c(r),s.onUpdatePageDeleteRows({totalRows:o.length,totalRowsInPage:P.length,totalRowsFiltered:f.length})},[f.length,P.length,s,o]),Y=b.useCallback(r=>{w.push(B.dashboard.order.details(r))},[w]),[R,Z]=b.useState("all");return e.jsxs(e.Fragment,{children:[e.jsxs(i,{px:5,children:[e.jsx(ne,{heading:"Orders",links:[{name:"Dashboard",href:B.dashboard.root},{name:"Orders",href:B.dashboard.order.root}],sx:{mb:{xs:3,md:5}}}),e.jsxs(W,{children:[e.jsx(le,{value:R,onChange:(r,n)=>Z(n),sx:{px:2.5,boxShadow:r=>`inset 0 -2px 0 0 ${ie(r.palette.grey[500],.08)}`},children:Re.map(r=>e.jsx(ce,{iconPosition:"end",value:r.value,label:r.label,icon:e.jsxs(H,{variant:(r.value==="all"||r.value===d.status)&&"filled"||"soft",color:r.value==="completed"&&"success"||r.value==="pending"&&"warning"||r.value==="cancelled"&&"error"||"default",children:[r.value==="all"&&o.length,r.value==="pending"&&o.filter(n=>n.status==="Order received"||n.status==="pending").length,r.value==="completed"&&o.filter(n=>n.status==="completed").length,r.value==="cancelled"&&o.filter(n=>n.status==="cancelled").length,r.value==="refunded"&&o.filter(n=>n.status==="refunded").length]})},r.value))}),e.jsxs(Pe,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(de,{dense:s.dense,numSelected:s.selected.length,rowCount:o.length,onSelectAllRows:r=>s.onSelectAllRows(r,o.map(n=>n.id)),action:e.jsx(he,{title:"Delete",children:e.jsx(I,{color:"primary",onClick:m.onTrue,children:e.jsx(D,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(z,{children:e.jsxs(pe,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(xe,{order:s.order,orderBy:s.orderBy,headLabel:De,rowCount:o.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:r=>s.onSelectAllRows(r,o.map(n=>n.id))}),e.jsxs(ue,{children:[f.filter(r=>R==="all"||R==="pending"&&(r.status==="pending"||r.status==="Order received")||R==="completed"&&r.status==="completed"||R==="cancelled"&&r.status==="cancelled"||R==="refunded"&&r.status==="refunded").map(r=>e.jsx(G,{row:r,selected:s.selected.includes(r.id),onSelectRow:()=>s.onSelectRow(r.id),onDeleteRow:()=>K(r.id),onViewRow:()=>Y(r.id)},r.id)),e.jsx(ge,{height:v,emptyRows:ve(s.page,s.rowsPerPage,o.length)}),e.jsx(me,{notFound:J})]})]})})]}),e.jsx(je,{count:f.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,onChangeDense:s.onChangeDense})]})]}),e.jsx(Q,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",s.selected.length," "]})," items?"]}),action:e.jsx(q,{variant:"contained",color:"error",onClick:()=>{X(),m.onFalse()},children:"Delete"})})]})}function ke({inputData:a,comparator:p,filters:x,dateError:u}){const{status:g,name:o,startDate:c,endDate:l}=x,y=a.map((s,w)=>[s,w]);return y.sort((s,w)=>{const m=p(s[0],w[0]);return m!==0?m:s[1]-w[1]}),a=y.map(s=>s[0]),o&&(a=a.filter(s=>s.orderNumber.toLowerCase().indexOf(o.toLowerCase())!==-1||s.customer.name.toLowerCase().indexOf(o.toLowerCase())!==-1||s.customer.email.toLowerCase().indexOf(o.toLowerCase())!==-1)),g!=="all"&&(a=a.filter(s=>s.status===g)),u||c&&l&&(a=a.filter(s=>A(s.createdAt)>=A(c)&&A(s.createdAt)<=A(l))),a}t.object,t.object,t.object,t.object;function Oe({items:a=[],shipping:p,discount:x,taxes:u,subTotal:g,totalAmount:o}){const c=e.jsxs(h,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(h,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(i,{sx:{width:160,typography:"subtitle2"},children:C(g)||"-"})]}),e.jsxs(h,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(i,{sx:{width:160,...p&&{color:"error.main"}},children:p?`- ${C(p)}`:"-"})]}),e.jsxs(h,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Discount"}),e.jsx(i,{sx:{width:160,...x&&{color:"error.main"}},children:x?`- ${C(x)}`:"-"})]}),e.jsxs(h,{direction:"row",children:[e.jsx(i,{sx:{color:"text.secondary"},children:"Taxes"}),e.jsx(i,{sx:{width:160},children:u?C(u):"-"})]}),e.jsxs(h,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(i,{children:"Total"}),e.jsx(i,{sx:{width:160},children:C(o)||"-"})]})]});return e.jsxs(W,{children:[e.jsx(ye,{title:"Details"}),e.jsxs(h,{sx:{px:3},children:[e.jsx(z,{children:a==null?void 0:a.map(l=>e.jsxs(h,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:y=>`dashed 2px ${y.palette.background.neutral}`},children:[e.jsx(E,{src:l.images[0],variant:"rounded",sx:{width:48,height:48,mr:2}}),e.jsx(F,{primary:l.name,secondary:l.id,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs(i,{sx:{typography:"body2"},children:["x",l.quantity]}),e.jsx(i,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:C(l.salePrice)})]},l.id))}),c]})]})}Oe.propTypes={discount:t.number,items:t.array,shipping:t.number,subTotal:t.number,taxes:t.number,totalAmount:t.number};function Ae({status:a,backLink:p,createdAt:x,orderNumber:u,statusOptions:g,onChangeStatus:o}){const c=V();return e.jsxs(e.Fragment,{children:[e.jsx(h,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:e.jsxs(h,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(I,{component:we,href:p,children:e.jsx(D,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(h,{spacing:.5,children:[e.jsxs(h,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs($,{variant:"h4",children:[" Order ",u," "]}),e.jsx(H,{variant:"soft",color:a==="completed"&&"success"||a==="pending"&&"warning"||a==="cancelled"&&"error"||"default",children:a})]}),e.jsx($,{variant:"body2",sx:{color:"text.disabled"},children:fe(x)})]})]})}),e.jsx(_,{open:c.open,onClose:c.onClose,arrow:"top-right",sx:{width:140},children:g.map(l=>e.jsx(N,{selected:l.value===a,onClick:()=>{c.onClose(),o(l.value)},children:l.label},l.value))})]})}Ae.propTypes={backLink:t.string,createdAt:t.instanceOf(Date),onChangeStatus:t.func,orderNumber:t.string,status:t.string,statusOptions:t.array};export{Ne as O,Ae as a,Oe as b};
