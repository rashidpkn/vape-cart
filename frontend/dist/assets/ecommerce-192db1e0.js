import{aa as E,ac as P,ag as F,ad as J,r as b,j as e,Y as H,w as W,c as T,ae as Y,o as G,x,S as U,q as C,l as y,u as O,a as K,d as A,B as V,G as w,W as _}from"./index-6b2a15ec.js";import{C as Q,B as X}from"./chart-f25d8467.js";import{C as Z}from"./custom-breadcrumbs-c17d7e8b.js";import{C as B}from"./Card-1154fd03.js";import{C as M}from"./CardHeader-e43f2a04.js";import{f as S,a as q,b as $}from"./format-number-00dffec8.js";import{T as ee}from"./table-pagination-custom-822c63ba.js";import{T as te}from"./TableContainer-a5f4dc5b.js";import{T as re,a as se}from"./TableBody-ea94779e.js";import{a as ae,b as k}from"./TableRow-150cbd53.js";import{A as ie}from"./Alert-79f17d28.js";import"./Checkbox-aed2f8e9.js";import"./KeyboardArrowRight-a3652fce.js";import"./LastPage-d4b5e2a0.js";function R(d){const t=E(),f={show:!0,label:"Total",color:t.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight,lineHeight:t.typography.subtitle2.lineHeight},m={offsetY:8,color:t.palette.text.primary,fontSize:t.typography.h3.fontSize,fontWeight:t.typography.h3.fontWeight,lineHeight:t.typography.h3.lineHeight},h={colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],chart:{toolbar:{show:!1},zoom:{enabled:!1},foreColor:t.palette.text.disabled,fontFamily:t.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:t.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,fontSize:13,position:"top",horizontalAlign:"right",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:t.palette.text.primary}},plotOptions:{bar:{borderRadius:4,columnWidth:"28%",borderRadiusApplication:"end",borderRadiusWhenStacked:"last"},pie:{donut:{labels:{show:!0,value:m,total:f}}},radialBar:{track:{strokeWidth:"100%",background:P(t.palette.grey[500],.16)},dataLabels:{value:m,total:f}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.palette.divider,connectorColors:t.palette.divider}},polarArea:{rings:{strokeColor:t.palette.divider},spokes:{connectorColors:t.palette.divider}}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return F(h,d)}function D({title:d,subheader:t,chart:f,...m}){const{colors:h,categories:j,series:a,options:c}=f,o=J(),[n,i]=b.useState(d==="Sales By Month"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][new Date().getMonth()]:"2024"),g=R({colors:h,legend:{position:"top",horizontalAlign:"right"},xaxis:{categories:j},...c}),v=b.useCallback(r=>{o.onClose(),i(r)},[o]);return e.jsxs(e.Fragment,{children:[e.jsxs(B,{...m,children:[e.jsx(M,{title:d,subheader:t,action:e.jsxs(H,{onClick:o.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[n,e.jsx(W,{width:16,icon:o.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),a.map(r=>e.jsx(T,{sx:{mt:3,mx:3},children:r.year===n&&e.jsx(Q,{dir:"ltr",type:"area",series:r.data,options:g,height:364})},r.year))]}),e.jsx(Y,{open:o.open,onClose:o.onClose,sx:{width:140},children:a.map(r=>e.jsx(G,{selected:r.year===n,onClick:()=>v(r.year),children:r.year},r.year))})]})}D.propTypes={chart:x.object,subheader:x.string,title:x.string};function L({title:d,subheader:t,tableData:f,tableLabels:m,...h}){return e.jsxs(B,{...h,children:[e.jsx(M,{title:d,subheader:t,sx:{mb:3}}),e.jsx(te,{sx:{overflow:"unset"},children:e.jsx(U,{children:e.jsxs(re,{sx:{minWidth:640},children:[e.jsx(ee,{headLabel:m}),e.jsx(se,{children:f.map(j=>e.jsx(N,{row:j},j.id))})]})})})]})}L.propTypes={subheader:x.string,tableData:x.array,tableLabels:x.array,title:x.string};function N({row:d}){return e.jsxs(ae,{children:[e.jsx(k,{children:d.name}),e.jsx(k,{children:d.category}),e.jsx(k,{children:d.storeName}),e.jsx(k,{children:d.SKU}),e.jsx(k,{children:S(d.salePrice)})]})}N.propTypes={row:x.object};function I({title:d,percent:t,total:f,chart:m,sx:h,...j}){const a=E(),{colors:c=[a.palette.primary.light,a.palette.primary.main],series:o,options:n}=m;return R({colors:[c[1]],fill:{type:"gradient",gradient:{colorStops:[{offset:0,color:c[0]},{offset:100,color:c[1]}]}},chart:{animations:{enabled:!0},sparkline:{enabled:!0}},tooltip:{x:{show:!1},y:{formatter:i=>q(i),title:{formatter:()=>""}},marker:{show:!1}},...n}),C,W,t<0,{bgcolor:P(a.palette.success.main,.16),...t<0&&{color:"error.main",bgcolor:P(a.palette.error.main,.16)}},y,t>0,$(t),T,e.jsx(B,{sx:{display:"flex",alignItems:"center",p:3,...h},...j,children:e.jsxs(T,{sx:{flexGrow:1},children:[e.jsx(y,{variant:"subtitle2",paragraph:!0,children:d}),e.jsx(y,{variant:"h3",gutterBottom:!0,children:q(f)})]})})}I.propTypes={chart:x.object,percent:x.number,sx:x.object,title:x.string,total:x.number};function z({title:d,sentAmount:t,currentBalance:f,orders:m=[],sx:h,...j}){const{user:a}=O(),c=K(),[o,n]=b.useState(""),[i,g]=b.useState([]),v=b.useCallback(async()=>{const{data:r}=await A.get("/payout",{params:{fName:a.displayName}});g(r)},[]);return b.useEffect(()=>{v()},[]),e.jsxs(B,{sx:{p:3,...h},...j,children:[e.jsx(y,{variant:"subtitle2",gutterBottom:!0,children:d}),!!o&&e.jsx(ie,{severity:"error",children:o}),e.jsxs(C,{spacing:2,children:[e.jsxs(y,{variant:"h3",children:["AED"," ",(m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0)*.2-i.reduce((r,s)=>r+s.amount,0)+i.reduce((r,s)=>s.status==="pending"?r+s.amount:r,0)).toFixed(2)," "]}),e.jsxs(C,{direction:"row",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:"Total Sales"}),e.jsxs(y,{variant:"body2",children:[" ",S(m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0))]})]}),e.jsxs(C,{direction:"row",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:"Commission (20%)"}),e.jsx(y,{variant:"body2",children:S(m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0)*.2)})]}),e.jsxs(C,{direction:"row",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:"Avalable Balance for requesting"}),e.jsxs(y,{variant:"body2",children:[" ",S(m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0)*.2-i.reduce((r,s)=>r+s.amount,0))]})]}),e.jsxs(C,{direction:"row",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:"Pending Request"}),e.jsxs(y,{variant:"body2",children:[" ",S(i.reduce((r,s)=>s.status==="pending"?r+s.amount:r,0))]})]}),e.jsxs(C,{direction:"row",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",sx:{color:"text.secondary"},children:"Total Earned"}),e.jsxs(y,{variant:"body2",children:[" ",S(i.reduce((r,s)=>s.status==="completed"?r+s.amount:r,0))]})]}),e.jsx(C,{direction:"row",spacing:1.5,children:e.jsx(V,{fullWidth:!0,variant:"contained",color:"warning",onClick:()=>{m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0)*.2-i.reduce((r,s)=>r+s.amount,0)>10?(sessionStorage.setItem("amount",m.reduce((r,s)=>{var u,p;return r+((u=s.items.find(l=>l.userId===a.id))==null?void 0:u.price)*((p=s.items.find(l=>l.userId===a.id))==null?void 0:p.quantity)},0)*.2),c("/payment")):n("You must have a minimum balance of AED 10 to request a payout.")},children:"Request For Payout"})})]})]})}z.propTypes={currentBalance:x.number,sentAmount:x.number,sx:x.object,title:x.string};function oe(){const d=E(),{user:t}=O(),[f,m]=b.useState([]),[h,j]=b.useState([]);return b.useEffect(()=>{(async()=>{try{const[c,o,n]=await Promise.all([A.get("products",{params:{userId:t.id}}),A.get("/orders"),A.get("/invoice")]),{products:i}=c.data,g=o.data,v=n.data,r=g.filter(s=>s.items.some(u=>i.some(p=>p.id===u.id)));j(r),m(i)}catch(c){console.error("An error occurred:",c)}})()},[t.id]),console.log(h),e.jsxs(T,{px:5,children:[e.jsx(Z,{heading:"Analytics",links:[{}],sx:{mb:{xs:3,md:5}}}),e.jsxs(w,{container:!0,spacing:3,sx:{position:"relative"},children:[e.jsx(X,{products:f}),e.jsx(w,{xs:12,md:4,children:e.jsx(I,{title:"Product Sold",percent:0,total:h.length,chart:{series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(w,{xs:12,md:4,children:e.jsx(I,{title:"Total Balance",percent:0,total:h.reduce((a,c)=>{var o,n;return a+((o=c.items.find(i=>i.userId===t.id))==null?void 0:o.price)*((n=c.items.find(i=>i.userId===t.id))==null?void 0:n.quantity)},0),chart:{colors:[d.palette.info.light,d.palette.info.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(w,{xs:12,md:4,children:e.jsx(I,{title:"Sales Profit",percent:0,total:h.reduce((a,c)=>{var o,n;return a+((o=c.items.find(i=>i.userId===t.id))==null?void 0:o.price)*((n=c.items.find(i=>i.userId===t.id))==null?void 0:n.quantity)},0)*.8,chart:{colors:[d.palette.warning.light,d.palette.warning.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(w,{xs:12,md:12,lg:12,children:e.jsx(D,{title:"Sales By Month",chart:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],series:[0,1,2,3,4,5,6,7,8,9,10,11].map(a=>({year:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a],data:[{name:"Total Income",data:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].map(c=>h.reduce((o,n)=>{var i,g;return new Date(n.createdAt).getMonth()===a&&new Date(n.createdAt).getDate()===c?o+((i=n.items.find(v=>v.userId===t.id))==null?void 0:i.price)*((g=n.items.find(v=>v.userId===t.id))==null?void 0:g.quantity):o},0))}]}))}})}),e.jsx(w,{xs:12,md:12,lg:12,children:e.jsx(D,{title:"Yearly Sales",chart:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[{year:"2024",data:[{name:"Total Income",data:[0,1,2,3,4,5,6,7,8,9,10,11].map(a=>h.reduce((c,o)=>{var n,i;return new Date(o.createdAt).getMonth()===a?c+((n=o.items.find(g=>g.userId===t.id))==null?void 0:n.price)*((i=o.items.find(g=>g.userId===t.id))==null?void 0:i.quantity):c},0))}]}]}})}),e.jsx(w,{xs:12,md:6,lg:8,children:e.jsx(L,{title:"Top Selling Products",tableData:f,tableLabels:[{id:"Product name",label:"Product Name"},{id:"category",label:"Category"},{id:"storeName",label:"Store Name"},{id:"sku",label:"SKU"},{id:"salePrice",label:"Sale Price"}]})}),e.jsx(w,{xs:12,md:6,lg:4,children:e.jsx(z,{title:"Current Balance",currentBalance:0,sentAmount:0,orders:h})})]})]})}function ve(){return e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsx("title",{children:" Dashboard: Analytics"})}),e.jsx(oe,{})]})}export{ve as default};
