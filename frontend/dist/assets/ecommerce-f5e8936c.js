import{ad as D,af as B,aD as F,aq as N,H as f,j as e,ah as I,aE as J,ap as P,B as A,ax as H,ay as Y,ag as m,ai as G,aj as U,ak as K,al as V,as as _,at as w,au as b,az as E,S as j,T as h,aA as Q,ar as q,aF as X,b as k,aG as Z,a as $,aH as ee,aB as g,W as te}from"./index-4474c340.js";import{C as ae,B as re}from"./chart-01cefd7d.js";import{C as W}from"./CardHeader-19ff33cf.js";import{T as se}from"./TableContainer-81aacafa.js";function O(l){const t=D(),x={show:!0,label:"Total",color:t.palette.text.secondary,fontSize:t.typography.subtitle2.fontSize,fontWeight:t.typography.subtitle2.fontWeight,lineHeight:t.typography.subtitle2.lineHeight},d={offsetY:8,color:t.palette.text.primary,fontSize:t.typography.h3.fontSize,fontWeight:t.typography.h3.fontWeight,lineHeight:t.typography.h3.lineHeight},u={colors:[t.palette.primary.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main,t.palette.success.main,t.palette.warning.dark,t.palette.success.darker,t.palette.info.dark,t.palette.info.darker],chart:{toolbar:{show:!1},zoom:{enabled:!1},foreColor:t.palette.text.disabled,fontFamily:t.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:t.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:t.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,fontSize:13,position:"top",horizontalAlign:"right",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:t.palette.text.primary}},plotOptions:{bar:{borderRadius:4,columnWidth:"28%",borderRadiusApplication:"end",borderRadiusWhenStacked:"last"},pie:{donut:{labels:{show:!0,value:d,total:x}}},radialBar:{track:{strokeWidth:"100%",background:B(t.palette.grey[500],.16)},dataLabels:{value:d,total:x}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:t.palette.divider,connectorColors:t.palette.divider}},polarArea:{rings:{strokeColor:t.palette.divider},spokes:{connectorColors:t.palette.divider}}},responsive:[{breakpoint:t.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:t.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return F(u,l)}function T({title:l,subheader:t,chart:x,...d}){const{colors:u,categories:y,series:s,options:n}=x,i=N(),[c,p]=f.useState(l==="Sales By Month"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][new Date().getMonth()]:"2024"),v=O({colors:u,legend:{position:"top",horizontalAlign:"right"},xaxis:{categories:y},...n}),C=f.useCallback(a=>{i.onClose(),p(a)},[i]);return e.jsxs(e.Fragment,{children:[e.jsxs(I,{...d,children:[e.jsx(W,{title:l,subheader:t,action:e.jsxs(J,{onClick:i.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[c,e.jsx(P,{width:16,icon:i.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),s.map(a=>e.jsx(A,{sx:{mt:3,mx:3},children:a.year===c&&e.jsx(ae,{dir:"ltr",type:"area",series:a.data,options:v,height:364})},a.year))]}),e.jsx(H,{open:i.open,onClose:i.onClose,sx:{width:140},children:s.map(a=>e.jsx(Y,{selected:a.year===c,onClick:()=>C(a.year),children:a.year},a.year))})]})}T.propTypes={chart:m.object,subheader:m.string,title:m.string};function M({title:l,subheader:t,tableData:x,tableLabels:d,...u}){return e.jsxs(I,{...u,children:[e.jsx(W,{title:l,subheader:t,sx:{mb:3}}),e.jsx(se,{sx:{overflow:"unset"},children:e.jsx(G,{children:e.jsxs(U,{sx:{minWidth:640},children:[e.jsx(K,{headLabel:d}),e.jsx(V,{children:x.map(y=>e.jsx(R,{row:y},y.id))})]})})})]})}M.propTypes={subheader:m.string,tableData:m.array,tableLabels:m.array,title:m.string};function R({row:l}){return e.jsxs(_,{children:[e.jsx(w,{children:l.name}),e.jsx(w,{children:l.category}),e.jsx(w,{children:l.storeName}),e.jsx(w,{children:l.SKU}),e.jsx(w,{children:b(l.salePrice)})]})}R.propTypes={row:m.object};function S({title:l,percent:t,total:x,chart:d,sx:u,...y}){const s=D(),{colors:n=[s.palette.primary.light,s.palette.primary.main],series:i,options:c}=d;return O({colors:[n[1]],fill:{type:"gradient",gradient:{colorStops:[{offset:0,color:n[0]},{offset:100,color:n[1]}]}},chart:{animations:{enabled:!0},sparkline:{enabled:!0}},tooltip:{x:{show:!1},y:{formatter:p=>E(p),title:{formatter:()=>""}},marker:{show:!1}},...c}),j,P,t<0,{bgcolor:B(s.palette.success.main,.16),...t<0&&{color:"error.main",bgcolor:B(s.palette.error.main,.16)}},h,t>0,Q(t),A,e.jsx(I,{sx:{display:"flex",alignItems:"center",p:3,...u},...y,children:e.jsxs(A,{sx:{flexGrow:1},children:[e.jsx(h,{variant:"subtitle2",paragraph:!0,children:l}),e.jsx(h,{variant:"h3",gutterBottom:!0,children:E(x)})]})})}S.propTypes={chart:m.object,percent:m.number,sx:m.object,title:m.string,total:m.number};function L({title:l,sentAmount:t,currentBalance:x,orders:d=[],sx:u,...y}){const{user:s}=q(),n=X(),[i,c]=f.useState(""),[p,v]=f.useState([]),C=f.useCallback(async()=>{const{data:a}=await k.get("/payout",{params:{fName:s.displayName}});v(a)},[]);return f.useEffect(()=>{C()},[]),e.jsxs(I,{sx:{p:3,...u},...y,children:[e.jsx(h,{variant:"subtitle2",gutterBottom:!0,children:l}),!!i&&e.jsx(Z,{severity:"error",children:i}),e.jsxs(j,{spacing:2,children:[e.jsxs(h,{variant:"h3",children:["AED"," ",(d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0)*.2-p.reduce((a,r)=>a+r.amount,0)+p.reduce((a,r)=>r.status==="pending"?a+r.amount:a,0)).toFixed(2)," "]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Total Sales"}),e.jsxs(h,{variant:"body2",children:[" ",b(d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0))]})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Commission (20%)"}),e.jsx(h,{variant:"body2",children:b(d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0)*.2)})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Avalable Balance for requesting"}),e.jsxs(h,{variant:"body2",children:[" ",b(d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0)*.2-p.reduce((a,r)=>a+r.amount,0))]})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Pending Request"}),e.jsxs(h,{variant:"body2",children:[" ",b(p.reduce((a,r)=>r.status==="pending"?a+r.amount:a,0))]})]}),e.jsxs(j,{direction:"row",justifyContent:"space-between",children:[e.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"Total Earned"}),e.jsxs(h,{variant:"body2",children:[" ",b(p.reduce((a,r)=>r.status==="completed"?a+r.amount:a,0))]})]}),e.jsx(j,{direction:"row",spacing:1.5,children:e.jsx($,{fullWidth:!0,variant:"contained",color:"warning",onClick:()=>{d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0)*.2-p.reduce((a,r)=>a+r.amount,0)>10?(sessionStorage.setItem("amount",d.reduce((a,r)=>a+r.items.find(o=>o.userId===s.id).price*r.items.find(o=>o.userId===s.id).quantity,0)*.2),n("/payment")):c("You must have a minimum balance of AED 10 to request a payout.")},children:"Request For Payout"})})]})]})}L.propTypes={currentBalance:m.number,sentAmount:m.number,sx:m.object,title:m.string};function ie(){const l=D(),{user:t}=q(),[x,d]=f.useState([]),[u,y]=f.useState([]);return f.useEffect(()=>{(async()=>{try{const[n,i,c]=await Promise.all([k.get("products",{params:{userId:t.id}}),k.get("/orders"),k.get("/invoice")]),{products:p}=n.data,v=i.data,C=c.data,a=v.filter(r=>r.items.some(o=>p.some(z=>z.id===o.id)));y(a),d(p)}catch(n){console.error("An error occurred:",n)}})()},[t.id]),console.log(u),e.jsxs(A,{px:5,children:[e.jsx(ee,{heading:"Analytics",links:[{}],sx:{mb:{xs:3,md:5}}}),e.jsxs(g,{container:!0,spacing:3,sx:{position:"relative"},children:[e.jsx(re,{products:x}),e.jsx(g,{xs:12,md:4,children:e.jsx(S,{title:"Product Sold",percent:0,total:u.length,chart:{series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(S,{title:"Total Balance",percent:0,total:u.reduce((s,n)=>s+n.items.find(i=>i.userId===t.id).price*n.items.find(i=>i.userId===t.id).quantity,0),chart:{colors:[l.palette.info.light,l.palette.info.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(S,{title:"Sales Profit",percent:0,total:u.reduce((s,n)=>s+n.items.find(i=>i.userId===t.id).price*n.items.find(i=>i.userId===t.id).quantity,0)*.8,chart:{colors:[l.palette.warning.light,l.palette.warning.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(g,{xs:12,md:12,lg:12,children:e.jsx(T,{title:"Sales By Month",chart:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],series:[0,1,2,3,4,5,6,7,8,9,10,11].map(s=>({year:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s],data:[{name:"Total Income",data:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].map(n=>u.reduce((i,c)=>new Date(c.createdAt).getMonth()===s&&new Date(c.createdAt).getDate()===n?i+c.items.find(p=>p.userId===t.id).price*c.items.find(p=>p.userId===t.id).quantity:i,0))}]}))}})}),e.jsx(g,{xs:12,md:12,lg:12,children:e.jsx(T,{title:"Yearly Sales",chart:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[{year:"2024",data:[{name:"Total Income",data:[0,1,2,3,4,5,6,7,8,9,10,11].map(s=>u.reduce((n,i)=>new Date(i.createdAt).getMonth()===s?n+i.items.find(c=>c.userId===t.id).price*i.items.find(c=>c.userId===t.id).quantity:n,0))}]}]}})}),e.jsx(g,{xs:12,md:6,lg:8,children:e.jsx(M,{title:"Top Selling Products",tableData:x,tableLabels:[{id:"Product name",label:"Product Name"},{id:"category",label:"Category"},{id:"storeName",label:"Store Name"},{id:"sku",label:"SKU"},{id:"salePrice",label:"Sale Price"}]})}),e.jsx(g,{xs:12,md:6,lg:4,children:e.jsx(L,{title:"Current Balance",currentBalance:0,sentAmount:0,orders:u})})]})]})}function de(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:" Dashboard: Analytics"})}),e.jsx(ie,{})]})}export{de as default};
