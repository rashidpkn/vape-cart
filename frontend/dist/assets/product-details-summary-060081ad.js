import{H as l,aF as U,j as t,B as m,au as I,S as o,bm as X,b9 as Y,dm as Z,bV as _,ay as ee,a as c,a$ as A,ao as T,T as h,am as q,b as te,ap as re}from"./index-d26ef6f4.js";import{F as se}from"./form-provider-5acf8a0f.js";import{p as ae}from"./product-details-description-e8199147.js";import{R as ie}from"./Rating-142e4c2b.js";function pe({cart:ne,product:D,onAddCart:y,onGotoStep:le,disabledActions:oe,setProduct:F,...R}){const[p,n]=l.useState(1),g=U(),{id:V,name:i,regularPrice:$,quantity:a,salePrice:x,totalRatings:E,totalReviews:L,images:M,userId:f,type:j,productGroup:b,variables:v,subDescription:P}=D,[w,O]=l.useState([]),Q=async()=>{if(j==="Variable"&&b==="parent"){const{data:e}=await te.get("/products",{params:{perPage:2e3,name:i}});O(e.products)}};l.useEffect(()=>{Q()},[]);const B=t.jsxs(m,{sx:{typography:"h5"},children:[t.jsx(m,{component:"span",sx:{color:"text.disabled",textDecoration:"line-through",mr:.5},children:I($)}),I(x)]}),N=t.jsxs(o,{direction:"row",children:[t.jsx(h,{variant:"subtitle2",sx:{flexGrow:1},children:"Quantity"}),t.jsx(o,{spacing:1,children:t.jsxs(h,{variant:"caption",component:"div",sx:{textAlign:"right"},children:["Available: ",a||100]})})]}),z=t.jsxs(o,{direction:"row",spacing:2,children:[t.jsxs(m,{sx:{width:{sm:"100%",md:"60%"}},display:"flex",justifyItems:"center",alignItems:"center",gap:1,children:[t.jsx(c,{variant:"outlined",color:"primary",onClick:()=>{n(e=>e<=1?1:e-1)},children:"-"}),t.jsx(A,{fullWidth:!0,label:"Quantity",type:"number",inputProps:{min:1,max:a??100},onChange:e=>{n(s=>{const{value:r}=e.target;return r<=0?1:a?Math.min(a,r):Math.min(r,100)})},value:p}),t.jsx(c,{variant:"outlined",color:"primary",onClick:()=>{n(e=>e<a?e+1:e)},children:"+"})]}),t.jsx(c,{fullWidth:!0,size:"large",color:"warning",variant:"contained",startIcon:t.jsx(re,{icon:"solar:cart-plus-bold",width:24}),onClick:()=>{y({id:V,name:i,price:x,images:M,subTotal:x,userId:f,quantity:p,available:a}),g(T.product.checkout)},sx:{width:{sm:"100%",md:"40%"}},children:"Add to Cart"})]}),G=!!P&&ae(P),W=t.jsxs(o,{direction:"row",alignItems:"center",sx:{color:"text.disabled",typography:"body2"},children:[t.jsx(ie,{size:"small",value:E,precision:.1,readOnly:!0,sx:{mr:1}}),`(${X(L)} reviews)`]}),[d,H]=l.useState({}),[C,S]=l.useState("");l.useEffect(()=>{S("");let e=i==null?void 0:i.split(" -")[0];Object.keys(d).map(r=>e=`${e} - ${d[r]}`);const s=w.find(r=>r.name.toLowerCase().includes(e.toLowerCase()));s&&F(r=>({...r,name:s.name,images:s.images,quantity:s.quantity,salePrice:s.salePrice,regularPrice:s.regularPrice}))},[d]);const J=t.jsxs(m,{display:"flex",flexDirection:"column",gap:"10px",children:[Object.keys(v).map((e,s)=>t.jsxs(Y,{sx:{width:{sm:"100%",md:"50%"}},size:"small",children:[t.jsx(Z,{id:"demo-simple-select-label",children:e}),t.jsx(_,{label:e,onChange:r=>{n(1),H(u=>({...u,[e]:r.target.value}))},children:v[e].map((r,u)=>t.jsx(ee,{value:r,children:r},u))},s)]},s)),t.jsxs(m,{sx:{width:{sm:"100%",md:"50%"}},display:"flex",justifyItems:"center",alignItems:"center",gap:1,children:[t.jsx(c,{variant:"outlined",color:"primary",onClick:()=>{n(e=>e<=1?1:e-1)},children:"-"}),t.jsx(A,{fullWidth:!0,label:"Quantity",type:"number",inputProps:{min:1,max:a??100},onChange:e=>{n(s=>{const{value:r}=e.target;return r<=0?1:a?Math.min(a,r):Math.min(r,100)})},value:p}),t.jsx(c,{variant:"outlined",color:"primary",onClick:()=>{n(e=>e<a?e+1:e)},children:"+"})]}),t.jsx(c,{sx:{width:{sm:"100%",md:"50%"}},variant:"contained",color:"success",disabled:!i.split("-")[1],onClick:()=>{let e=i==null?void 0:i.split(" -")[0];Object.keys(d).map(r=>e=`${e} - ${d[r]}`);const s=w.find(r=>r.name.toLowerCase().includes(e.toLowerCase()));if(s){const{id:r,name:u,salePrice:k,images:K}=s;y({id:r,name:u,price:k,images:K,subTotal:k,userId:f,quantity:p,available:a}),g(T.product.checkout)}else S("Out of stock")},children:"Buy"}),!!C&&t.jsx("p",{style:{color:"#F00A"},children:C})]});return t.jsx(se,{children:t.jsxs(o,{spacing:3,sx:{pt:3},...R,children:[t.jsxs(o,{spacing:2,alignItems:"flex-start",children:[t.jsx(h,{variant:"h5",children:i}),W,x!==null&&B,G]}),t.jsx(q,{sx:{borderStyle:"dashed"}}),N,t.jsx(q,{sx:{borderStyle:"dashed"}}),j==="Variable"&&b==="parent"?J:z]})})}export{pe as P};
