import{an as J,F as j,j as e,af as T,aB as Y,am as D,B as S,as as G,at as H,ae as i,ag as K,ah as U,ai as z,aj as V,ao as Q,ap as w,aq as v,ab as k,au as P,S as g,ad as E,T as c,av as X,aw as R,aC as Z,aA as C,aD as _,al as $,aE as ee,ax as y,W as te}from"./index-8bdcfc3f.js";import{B as ae}from"./blurlayer-583aaaa5.js";import{u as N}from"./use-chart-9a6dd700.js";import{C as I}from"./chart-99ea8a3e.js";import{C as O}from"./CardHeader-af74a583.js";import{T as se}from"./TableContainer-53120217.js";function B({title:n,subheader:m,chart:h,...l}){const{colors:d,categories:x,series:o,options:s}=h,r=J(),[p,u]=j.useState("2024"),b=N({colors:d,legend:{position:"top",horizontalAlign:"right"},xaxis:{categories:x},...s}),f=j.useCallback(t=>{r.onClose(),u(t)},[r]);return e.jsxs(e.Fragment,{children:[e.jsxs(T,{...l,children:[e.jsx(O,{title:n,subheader:m,action:e.jsxs(Y,{onClick:r.onOpen,sx:{pl:1,py:.5,pr:.5,borderRadius:1,typography:"subtitle2",bgcolor:"background.neutral"},children:[p,e.jsx(D,{width:16,icon:r.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",sx:{ml:.5}})]})}),o.map(t=>e.jsx(S,{sx:{mt:3,mx:3},children:t.year===p&&e.jsx(I,{dir:"ltr",type:"area",series:t.data,options:b,height:364})},t.year))]}),e.jsx(G,{open:r.open,onClose:r.onClose,sx:{width:140},children:o.map(t=>e.jsx(H,{selected:t.year===p,onClick:()=>f(t.year),children:t.year},t.year))})]})}B.propTypes={chart:i.object,subheader:i.string,title:i.string};function M({title:n,subheader:m,tableData:h,tableLabels:l,...d}){return e.jsxs(T,{...d,children:[e.jsx(O,{title:n,subheader:m,sx:{mb:3}}),e.jsx(se,{sx:{overflow:"unset"},children:e.jsx(K,{children:e.jsxs(U,{sx:{minWidth:640},children:[e.jsx(z,{headLabel:l}),e.jsx(V,{children:h.map(x=>e.jsx(F,{row:x},x.id))})]})})})]})}M.propTypes={subheader:i.string,tableData:i.array,tableLabels:i.array,title:i.string};function F({row:n}){return e.jsxs(Q,{children:[e.jsx(w,{children:n.name}),e.jsx(w,{children:n.category}),e.jsx(w,{children:n.storeName}),e.jsx(w,{children:n.SKU}),e.jsx(w,{children:v(n.salePrice)})]})}F.propTypes={row:i.object};function A({title:n,percent:m,total:h,chart:l,sx:d,...x}){const o=k(),{colors:s=[o.palette.primary.light,o.palette.primary.main],series:r,options:p}=l,u=N({colors:[s[1]],fill:{type:"gradient",gradient:{colorStops:[{offset:0,color:s[0]},{offset:100,color:s[1]}]}},chart:{animations:{enabled:!0},sparkline:{enabled:!0}},tooltip:{x:{show:!1},y:{formatter:f=>P(f),title:{formatter:()=>""}},marker:{show:!1}},...p}),b=e.jsxs(g,{direction:"row",alignItems:"center",sx:{mt:2,mb:1},children:[e.jsx(D,{icon:m<0?"eva:trending-down-fill":"eva:trending-up-fill",sx:{mr:1,p:.5,width:24,height:24,borderRadius:"50%",color:"success.main",bgcolor:E(o.palette.success.main,.16),...m<0&&{color:"error.main",bgcolor:E(o.palette.error.main,.16)}}}),e.jsxs(c,{variant:"subtitle2",component:"div",noWrap:!0,children:[m>0&&"+",X(m),e.jsx(S,{component:"span",sx:{color:"text.secondary",typography:"body2"},children:" than last week"})]})]});return e.jsxs(T,{sx:{display:"flex",alignItems:"center",p:3,...d},...x,children:[e.jsxs(S,{sx:{flexGrow:1},children:[e.jsx(c,{variant:"subtitle2",paragraph:!0,children:n}),e.jsx(c,{variant:"h3",gutterBottom:!0,children:P(h)}),b]}),e.jsx(I,{type:"line",series:[{data:r}],options:u,width:96,height:64})]})}A.propTypes={chart:i.object,percent:i.number,sx:i.object,title:i.string,total:i.number};function q({title:n,sentAmount:m,currentBalance:h,orders:l=[],sx:d,...x}){const{user:o}=R(),s=Z(),[r,p]=j.useState(""),[u,b]=j.useState([]),f=j.useCallback(async()=>{const{data:t}=await C.get("/payout",{params:{fName:o.displayName}});b(t),console.log(t)},[]);return j.useEffect(()=>{f()},[]),e.jsxs(T,{sx:{p:3,...d},...x,children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:n}),!!r&&e.jsx(_,{severity:"error",children:r}),e.jsxs(g,{spacing:2,children:[e.jsxs(c,{variant:"h3",children:["AED"," ",(l.reduce((t,a)=>t+a.totalAmount,0)*.2-u.reduce((t,a)=>t+a.amount,0)+u.reduce((t,a)=>a.status==="pending"?t+a.amount:t,0)).toFixed(2)," "]}),e.jsxs(g,{direction:"row",justifyContent:"space-between",children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:"Total Sales"}),e.jsxs(c,{variant:"body2",children:[" ",v(l.reduce((t,a)=>t+a.totalAmount,0))]})]}),e.jsxs(g,{direction:"row",justifyContent:"space-between",children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:"Commission (20%)"}),e.jsx(c,{variant:"body2",children:v(l.reduce((t,a)=>t+a.totalAmount,0)*.2)})]}),e.jsxs(g,{direction:"row",justifyContent:"space-between",children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:"Avalable Balance for requesting"}),e.jsxs(c,{variant:"body2",children:[" ",v(l.reduce((t,a)=>t+a.totalAmount,0)*.2-u.reduce((t,a)=>t+a.amount,0))]})]}),e.jsxs(g,{direction:"row",justifyContent:"space-between",children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:"Pending Request"}),e.jsxs(c,{variant:"body2",children:[" ",v(u.reduce((t,a)=>a.status==="pending"?t+a.amount:t,0))]})]}),e.jsxs(g,{direction:"row",justifyContent:"space-between",children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:"Total Earned"}),e.jsxs(c,{variant:"body2",children:[" ",v(u.reduce((t,a)=>a.status==="completed"?t+a.amount:t,0))]})]}),e.jsx(g,{direction:"row",spacing:1.5,children:e.jsx($,{fullWidth:!0,variant:"contained",color:"warning",onClick:()=>{l.reduce((t,a)=>t+a.totalAmount,0)*.2-u.reduce((t,a)=>t+a.amount,0)>10?(sessionStorage.setItem("amount",l.reduce((t,a)=>t+a.totalAmount,0)*.2),s("/payment")):p("You must have a minimum balance of AED 10 to request a payout.")},children:"Request For Payout"})})]})]})}q.propTypes={currentBalance:i.number,sentAmount:i.number,sx:i.object,title:i.string};function re(){const n=k(),{user:m}=R(),[h,l]=j.useState([]),[d,x]=j.useState([]);return j.useEffect(()=>{(async()=>{try{const[s,r,p]=await Promise.all([C.get("products",{params:{userId:m.id}}),C.get("/orders"),C.get("/invoice")]),{products:u}=s.data,b=r.data,f=p.data,t=b.filter(a=>a.items.some(W=>u.some(L=>L.id===W.id)));x(t),l(u)}catch(s){console.error("An error occurred:",s)}})()},[m.id]),e.jsxs(S,{px:5,children:[e.jsx(ee,{heading:"Analytics",links:[{}],sx:{mb:{xs:3,md:5}}}),e.jsxs(y,{container:!0,spacing:3,sx:{position:"relative"},children:[e.jsx(ae,{products:h}),e.jsx(y,{xs:12,md:4,children:e.jsx(A,{title:"Product Sold",percent:0,total:d.length,chart:{series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(y,{xs:12,md:4,children:e.jsx(A,{title:"Total Balance",percent:0,total:d.reduce((o,s)=>o+s.totalAmount,0),chart:{colors:[n.palette.info.light,n.palette.info.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(y,{xs:12,md:4,children:e.jsx(A,{title:"Sales Profit",percent:0,total:d.reduce((o,s)=>o+s.totalAmount,0)*.8,chart:{colors:[n.palette.warning.light,n.palette.warning.main],series:[0,0,0,0,0,0,0,0,0,0]}})}),e.jsx(y,{xs:12,md:6,lg:8,children:e.jsx(B,{title:"Sales By Month",chart:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],series:[{year:"2024",data:[{name:"Total Income",data:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].map(o=>d.reduce((s,r)=>new Date(r.createdAt).getMonth()===new Date().getMonth()&&new Date(r.createdAt).getDate()===o?s+r.totalAmount:s,0))}]}]}})}),e.jsx(y,{xs:12,md:6,lg:8,children:e.jsx(B,{title:"Yearly Sales",chart:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[{year:"2024",data:[{name:"Total Income",data:[0,1,2,3,4,5,6,7,8,9,10,11].map(o=>d.reduce((s,r)=>new Date(r.createdAt).getMonth()===o?s+r.totalAmount:s,0))}]}]}})}),e.jsx(y,{xs:12,md:6,lg:8,children:e.jsx(M,{title:"Top Selling Products",tableData:h,tableLabels:[{id:"Product name",label:"Product Name"},{id:"category",label:"Category"},{id:"storeName",label:"Store Name"},{id:"sku",label:"SKU"},{id:"salePrice",label:"Sale Price"}]})}),e.jsx(y,{xs:12,md:6,lg:4,children:e.jsx(q,{title:"Current Balance",currentBalance:0,sentAmount:0,orders:d})})]})]})}function ue(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:" Dashboard: E-Commerce"})}),e.jsx(re,{})]})}export{ue as default};
